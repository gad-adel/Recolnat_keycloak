import{jsxs as u,Fragment as m,jsx as e}from"react/jsx-runtime";import{u as P,e as O,f as H,Z as F,F as r,i as l,C as b,Q as I,S as D,c as h,B as w,b as x,V as y,j as q,A as E,cn as j,r as $,a as K,d as M,aE as B,dr as _}from"./index-sihFV1NS.js";import{F as G}from"./FixedButtonGroup-6gQXZmA0.js";import{u as W,F as Y}from"./useIsFeatureEnabled-qmmJPqO8.js";import{F as T}from"./FormAccess-EK-4wbwg.js";import{W as L,S as Q}from"./SettingsCache-yRExyUF5.js";import{useState as C}from"react";import{K as p}from"./KeycloakTextInput--S1SG2UN.js";import{P as Z}from"./PasswordInput-P6txGPqu.js";import{i as J}from"./isEqual-guRJoAyD.js";import{F as X}from"./Form-bfj-xQZn.js";const ee=["connectionUrl","bindDn","bindCredential","useTruststoreSpi","connectionTimeout","startTls","authType"],N=t=>{const n={};return ee.forEach(s=>{const a=j(t.getValues(),`config.${s}`);n[s]=Array.isArray(a)?a[0]:""}),n},te=({form:t,id:n,showSectionHeading:s=!1,showSectionDescription:a=!1})=>{const{t:i}=P(),{realm:c}=O(),{addAlert:d,addError:g}=H(),v=!!n,o=async S=>{try{const k=N(t);await q.realms.testLDAPConnection({realm:c},{...k,action:S,componentId:n}),d(i("testSuccess"),E.success)}catch(k){g("testError",k)}},[f,A]=C(!1),[V,U]=C(!1),z=F({control:t.control,name:"config.authType",defaultValue:["simple"]});return u(m,{children:[s&&e(L,{title:i("connectionAndAuthenticationSettings"),description:i("ldapConnectionAndAuthorizationSettingsDescription"),showDescription:a}),u(T,{role:"manage-realm",isHorizontal:!0,children:[e(r,{label:i("connectionURL"),labelIcon:e(l,{helpText:i("consoleDisplayConnectionUrlHelp"),fieldLabelId:"connectionURL"}),fieldId:"kc-ui-connection-url",isRequired:!0,validated:t.formState.errors.config?.connectionUrl?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.connectionUrl?.[0].message,children:e(p,{isRequired:!0,type:"url",id:"kc-ui-connection-url","data-testid":"ldap-connection-url",validated:t.formState.errors.config?.connectionUrl?.[0]?"error":"default",...t.register("config.connectionUrl.0",{required:{value:!0,message:i("validateConnectionUrl").toString()}})})}),e(r,{label:i("enableStartTls"),labelIcon:e(l,{helpText:i("enableStartTlsHelp"),fieldLabelId:"enableStartTls"}),fieldId:"kc-enable-start-tls",hasNoPaddingTop:!0,children:e(b,{name:"config.startTls",defaultValue:["false"],control:t.control,render:({field:S})=>e(I,{id:"kc-enable-start-tls","data-testid":"enable-start-tls",isDisabled:!1,onChange:k=>S.onChange([`${k}`]),isChecked:S.value[0]==="true",label:i("on"),labelOff:i("off"),"aria-label":i("enableStartTls")})})}),e(r,{label:i("useTruststoreSpi"),labelIcon:e(l,{helpText:i("useTruststoreSpiHelp"),fieldLabelId:"useTruststoreSpi"}),fieldId:"kc-use-truststore-spi",children:e(b,{name:"config.useTruststoreSpi[0]",control:t.control,defaultValue:"always",render:({field:S})=>u(D,{toggleId:"kc-use-truststore-spi",onToggle:()=>A(!f),isOpen:f,onSelect:(k,R)=>{S.onChange(R.toString()),A(!1)},selections:S.value,children:[e(h,{value:"always",children:i("always")}),e(h,{value:"never",children:i("never")})]})})}),e(r,{label:i("connectionPooling"),labelIcon:e(l,{helpText:i("connectionPoolingHelp"),fieldLabelId:"connectionPooling"}),fieldId:"kc-connection-pooling",hasNoPaddingTop:!0,children:e(b,{name:"config.connectionPooling",defaultValue:["false"],control:t.control,render:({field:S})=>e(I,{id:"kc-connection-pooling","data-testid":"connection-pooling",isDisabled:!1,onChange:k=>S.onChange([`${k}`]),isChecked:S.value[0]==="true",label:i("on"),labelOff:i("off"),"aria-label":i("connectionPooling")})})}),e(r,{label:i("connectionTimeout"),labelIcon:e(l,{helpText:i("connectionTimeoutHelp"),fieldLabelId:"consoleTimeout"}),fieldId:"kc-ui-connection-timeout",children:e(p,{type:"number",min:0,id:"kc-ui-connection-timeout","data-testid":"connection-timeout",...t.register("config.connectionTimeout.0")})}),e(r,{fieldId:"kc-test-connection-button",children:e(w,{variant:"secondary",id:"kc-test-connection-button","data-testid":"test-connection-button",onClick:()=>o("testConnection"),children:i("testConnection")})}),e(r,{label:i("bindType"),labelIcon:e(l,{helpText:i("bindTypeHelp"),fieldLabelId:"bindType"}),fieldId:"kc-bind-type",isRequired:!0,children:e(b,{name:"config.authType[0]",defaultValue:"simple",control:t.control,render:({field:S})=>u(D,{toggleId:"kc-bind-type",required:!0,onToggle:()=>U(!V),isOpen:V,onSelect:(k,R)=>{S.onChange(R),U(!1)},selections:S.value,variant:x.single,"data-testid":"ldap-bind-type",children:[e(h,{value:"simple"}),e(h,{value:"none"})]})})}),J(z,["simple"])&&u(m,{children:[e(r,{label:i("bindDn"),labelIcon:e(l,{helpText:i("bindDnHelp"),fieldLabelId:"bindDn"}),fieldId:"kc-ui-bind-dn",helperTextInvalid:i("validateBindDn"),validated:t.formState.errors.config?.bindDn?y.error:y.default,isRequired:!0,children:e(p,{type:"text",id:"kc-ui-bind-dn","data-testid":"ldap-bind-dn",validated:t.formState.errors.config?.bindDn?y.error:y.default,...t.register("config.bindDn.0",{required:!0})})}),e(r,{label:i("bindCredentials"),labelIcon:e(l,{helpText:i("bindCredentialsHelp"),fieldLabelId:"bindCredentials"}),fieldId:"kc-ui-bind-credentials",helperTextInvalid:i("validateBindCredentials"),validated:t.formState.errors.config?.bindCredential?y.error:y.default,isRequired:!0,children:e(Z,{hasReveal:!v,isRequired:!0,id:"kc-ui-bind-credentials","data-testid":"ldap-bind-credentials",validated:t.formState.errors.config?.bindCredential?y.error:y.default,...t.register("config.bindCredential.0",{required:!0})})})]}),e(r,{fieldId:"kc-test-auth-button",children:e(w,{variant:"secondary",id:"kc-test-auth-button","data-testid":"test-auth-button",onClick:()=>o("testAuthentication"),children:i("testAuthentication")})})]})]})},ae="1.3.6.1.4.1.4203.1.11.1",ie=({id:t,form:n,showSectionHeading:s=!1,showSectionDescription:a=!1})=>{const{t:i}=P(),{realm:c}=O(),{addAlert:d,addError:g}=H(),v=async()=>{if(await n.trigger())try{const o=N(n),f=await q.realms.ldapServerCapabilities({realm:c},{...o,componentId:t});d(i("testSuccess"));const A=f.filter(V=>V.oid===ae);n.setValue("config.usePasswordModifyExtendedOp",[(A.length>0).toString()])}catch(o){g("testError",o)}};return u(m,{children:[s&&e(L,{title:i("advancedSettings"),description:i("ldapAdvancedSettingsDescription"),showDescription:a}),u(T,{role:"manage-realm",isHorizontal:!0,children:[e(r,{label:i("enableLdapv3Password"),labelIcon:e(l,{helpText:i("enableLdapv3PasswordHelp"),fieldLabelId:"enableLdapv3Password"}),fieldId:"kc-enable-ldapv3-password",hasNoPaddingTop:!0,children:e(b,{name:"config.usePasswordModifyExtendedOp",defaultValue:["false"],control:n.control,render:({field:o})=>e(I,{id:"kc-enable-ldapv3-password","data-testid":"ldapv3-password",isDisabled:!1,onChange:f=>o.onChange([`${f}`]),isChecked:o.value[0]==="true",label:i("on"),labelOff:i("off"),"aria-label":i("enableLdapv3Password")})})}),e(r,{label:i("validatePasswordPolicy"),labelIcon:e(l,{helpText:i("validatePasswordPolicyHelp"),fieldLabelId:"validatePasswordPolicy"}),fieldId:"kc-validate-password-policy",hasNoPaddingTop:!0,children:e(b,{name:"config.validatePasswordPolicy",defaultValue:["false"],control:n.control,render:({field:o})=>e(I,{id:"kc-validate-password-policy","data-testid":"password-policy",isDisabled:!1,onChange:f=>o.onChange([`${f}`]),isChecked:o.value[0]==="true",label:i("on"),labelOff:i("off"),"aria-label":i("validatePasswordPolicy")})})}),e(r,{label:i("trustEmail"),labelIcon:e(l,{helpText:i("trustEmailHelp"),fieldLabelId:"trustEmail"}),fieldId:"kc-trust-email",hasNoPaddingTop:!0,children:e(b,{name:"config.trustEmail",defaultValue:["false"],control:n.control,render:({field:o})=>e(I,{id:"kc-trust-email","data-testid":"trust-email",isDisabled:!1,onChange:f=>o.onChange([`${f}`]),isChecked:o.value[0]==="true",label:i("on"),labelOff:i("off"),"aria-label":i("trustEmail")})})}),e(r,{fieldId:"query-extensions",children:e(w,{variant:"secondary",id:"query-extensions","data-testid":"query-extensions",onClick:v,children:i("queryExtensions")})})]})]})},re=({form:t,showSectionHeading:n=!1,showSectionDescription:s=!1,vendorEdit:a=!1})=>{const{t:i}=P(),{realm:c}=O();$(()=>q.realms.findOne({realm:c}),o=>t.setValue("parentId",o.id),[]);const[d,g]=C(!1),v=()=>{switch(t.getValues("config.vendor[0]")){case"ad":t.setValue("config.usernameLDAPAttribute[0]","cn"),t.setValue("config.rdnLDAPAttribute[0]","cn"),t.setValue("config.uuidLDAPAttribute[0]","objectGUID"),t.setValue("config.krbPrincipalAttribute[0]","userPrincipalName"),t.setValue("config.userObjectClasses[0]","person, organizationalPerson, user");break;case"rhds":t.setValue("config.usernameLDAPAttribute[0]","uid"),t.setValue("config.rdnLDAPAttribute[0]","uid"),t.setValue("config.uuidLDAPAttribute[0]","nsuniqueid"),t.setValue("config.krbPrincipalAttribute[0]","krbPrincipalName"),t.setValue("config.userObjectClasses[0]","inetOrgPerson, organizationalPerson");break;case"tivoli":t.setValue("config.usernameLDAPAttribute[0]","uid"),t.setValue("config.rdnLDAPAttribute[0]","uid"),t.setValue("config.uuidLDAPAttribute[0]","uniqueidentifier"),t.setValue("config.krbPrincipalAttribute[0]","krb5PrincipalName"),t.setValue("config.userObjectClasses[0]","inetOrgPerson, organizationalPerson");break;case"edirectory":t.setValue("config.usernameLDAPAttribute[0]","uid"),t.setValue("config.rdnLDAPAttribute[0]","uid"),t.setValue("config.uuidLDAPAttribute[0]","guid"),t.setValue("config.krbPrincipalAttribute[0]","krb5PrincipalName"),t.setValue("config.userObjectClasses[0]","inetOrgPerson, organizationalPerson");break;case"other":t.setValue("config.usernameLDAPAttribute[0]","uid"),t.setValue("config.rdnLDAPAttribute[0]","uid"),t.setValue("config.uuidLDAPAttribute[0]","entryUUID"),t.setValue("config.krbPrincipalAttribute[0]","krb5PrincipalName"),t.setValue("config.userObjectClasses[0]","inetOrgPerson, organizationalPerson");break;default:return""}};return u(m,{children:[n&&e(L,{title:i("generalOptions"),description:i("ldapGeneralOptionsSettingsDescription"),showDescription:s}),u(T,{role:"manage-realm",isHorizontal:!0,children:[u(r,{label:i("uiDisplayName"),labelIcon:e(l,{helpText:i("uiDisplayNameHelp"),fieldLabelId:"uiDisplayName"}),fieldId:"kc-ui-display-name",isRequired:!0,validated:t.formState.errors.name?"error":"default",helperTextInvalid:t.formState.errors.name?.message,children:[e(p,{hidden:!0,id:"kc-ui-provider-id",defaultValue:"ldap",...t.register("providerId")}),e(p,{hidden:!0,id:"kc-ui-provider-type",defaultValue:"org.keycloak.storage.UserStorageProvider",...t.register("providerType")}),e(p,{hidden:!0,id:"kc-ui-parentId",defaultValue:c,...t.register("parentId")}),e(p,{isRequired:!0,id:"kc-ui-display-name",defaultValue:"ldap","data-testid":"ldap-name",validated:t.formState.errors.name?"error":"default",...t.register("name",{required:{value:!0,message:`${i("validateName")}`}})})]}),e(r,{label:i("vendor"),labelIcon:e(l,{helpText:i("vendorHelp"),fieldLabelId:"vendor"}),fieldId:"kc-vendor",isRequired:!0,children:e(b,{name:"config.vendor[0]",defaultValue:"ad",control:t.control,render:({field:o})=>u(D,{isDisabled:!!a,toggleId:"kc-vendor",required:!0,onToggle:()=>g(!d),isOpen:d,onSelect:(f,A)=>{o.onChange(A),g(!1),v()},selections:o.value,variant:x.single,children:[e(h,{value:"ad",isPlaceholder:!0,children:"Active Directory"},0),e(h,{value:"rhds",children:"Red Hat Directory Server"},1),e(h,{value:"tivoli",children:"Tivoli"},2),e(h,{value:"edirectory",children:"Novell eDirectory"},3),e(h,{value:"other",children:"Other"},4)]})})})]})]})},le=({form:t,showSectionHeading:n=!1,showSectionDescription:s=!1})=>{const{t:a}=P(),i=F({control:t.control,name:"config.allowKerberosAuthentication",defaultValue:["false"]});return u(m,{children:[n&&e(L,{title:a("kerberosIntegration"),description:a("ldapKerberosSettingsDescription"),showDescription:s}),u(T,{role:"manage-realm",isHorizontal:!0,children:[e(r,{label:a("allowKerberosAuthentication"),labelIcon:e(l,{helpText:a("allowKerberosAuthenticationHelp"),fieldLabelId:"allowKerberosAuthentication"}),fieldId:"kc-allow-kerberos-authentication",hasNoPaddingTop:!0,children:e(b,{name:"config.allowKerberosAuthentication",defaultValue:["false"],control:t.control,render:({field:c})=>e(I,{id:"kc-allow-kerberos-authentication","data-testid":"allow-kerberos-auth",isDisabled:!1,onChange:d=>c.onChange([`${d}`]),isChecked:c.value[0]==="true",label:a("on"),labelOff:a("off"),"aria-label":a("allowKerberosAuthentication")})})}),i[0]==="true"&&u(m,{children:[e(r,{label:a("kerberosRealm"),labelIcon:e(l,{helpText:a("kerberosRealmHelp"),fieldLabelId:"kerberosRealm"}),fieldId:"kc-kerberos-realm",isRequired:!0,validated:t.formState.errors.config?.kerberosRealm?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.kerberosRealm?.[0].message,children:e(p,{isRequired:!0,id:"kc-kerberos-realm","data-testid":"kerberos-realm",validated:t.formState.errors.config?.kerberosRealm?.[0]?"error":"default",...t.register("config.kerberosRealm.0",{required:{value:!0,message:a("validateRealm").toString()}})})}),e(r,{label:a("serverPrincipal"),labelIcon:e(l,{helpText:a("serverPrincipalHelp"),fieldLabelId:"serverPrincipal"}),fieldId:"kc-server-principal",isRequired:!0,validated:t.formState.errors.config?.serverPrincipal?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.serverPrincipal?.[0].message,children:e(p,{isRequired:!0,id:"kc-server-principal","data-testid":"kerberos-principal",validated:t.formState.errors.config?.serverPrincipal?.[0]?"error":"default",...t.register("config.serverPrincipal.0",{required:{value:!0,message:`${a("validateServerPrincipal")}`}})})}),e(r,{label:a("keyTab"),labelIcon:e(l,{helpText:a("keyTabHelp"),fieldLabelId:"keyTab"}),fieldId:"kc-key-tab",isRequired:!0,validated:t.formState.errors.config?.keyTab?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.keyTab?.[0].message,children:e(p,{isRequired:!0,id:"kc-key-tab","data-testid":"kerberos-keytab",validated:t.formState.errors.config?.keyTab?.[0]?"error":"default",...t.register("config.keyTab.0",{required:{value:!0,message:`${a("validateKeyTab")}`}})})}),e(r,{label:a("krbPrincipalAttribute"),labelIcon:e(l,{helpText:a("krbPrincipalAttributeHelp"),fieldLabelId:"krbPrincipalAttribute"}),fieldId:"kc-krb-principal-attribute",validated:t.formState.errors.config?.krbPrincipalAttribute?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.krbPrincipalAttribute?.[0].message,children:e(p,{defaultValue:"userPrincipalName",id:"kc-krb-principal-attribute","data-testid":"krb-principal-attribute",validated:t.formState.errors.config?.krbPrincipalAttribute?.[0]?"error":"default",...t.register("config.krbPrincipalAttribute.0")})}),u(r,{label:a("debug"),labelIcon:e(l,{helpText:a("debugHelp"),fieldLabelId:"debug"}),fieldId:"kc-debug",hasNoPaddingTop:!0,children:[" ",e(b,{name:"config.debug",defaultValue:["false"],control:t.control,render:({field:c})=>e(I,{id:"kc-debug","data-testid":"debug",isDisabled:!1,onChange:d=>c.onChange([`${d}`]),isChecked:c.value[0]==="true",label:a("on"),labelOff:a("off"),"aria-label":a("debug")})})]})]}),e(r,{label:a("useKerberosForPasswordAuthentication"),labelIcon:e(l,{helpText:a("useKerberosForPasswordAuthenticationHelp"),fieldLabelId:"useKerberosForPasswordAuthentication"}),fieldId:"kc-use-kerberos-password-authentication",hasNoPaddingTop:!0,children:e(b,{name:"config.useKerberosForPasswordAuthentication",defaultValue:["false"],control:t.control,render:({field:c})=>e(I,{id:"kc-use-kerberos-password-authentication","data-testid":"use-kerberos-pw-auth",isDisabled:!1,onChange:d=>c.onChange([`${d}`]),isChecked:c.value[0]==="true",label:a("on"),labelOff:a("off"),"aria-label":a("useKerberosForPasswordAuthentication")})})})]})]})},ne=({form:t,showSectionHeading:n=!1,showSectionDescription:s=!1})=>{const{t:a}=P(),[i,c]=C(!1),[d,g]=C(!1);return u(m,{children:[n&&e(L,{title:a("ldapSearchingAndUpdatingSettings"),description:a("ldapSearchingAndUpdatingSettingsDescription"),showDescription:s}),u(T,{role:"manage-realm",isHorizontal:!0,children:[e(r,{label:a("editMode"),labelIcon:e(l,{helpText:a("editModeLdapHelp"),fieldLabelId:"editMode"}),fieldId:"kc-edit-mode",isRequired:!0,validated:t.formState.errors.config?.editMode?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.editMode?.[0].message,children:e(b,{name:"config.editMode[0]",defaultValue:"",control:t.control,rules:{required:{value:!0,message:a("validateEditMode")}},render:({field:v})=>u(D,{toggleId:"kc-edit-mode",required:!0,onToggle:()=>g(!d),isOpen:d,onSelect:(o,f)=>{v.onChange(f.toString()),g(!1)},selections:v.value,variant:x.single,validated:t.formState.errors.config?.editMode?.[0]?"error":"default",children:[e(h,{value:"",isPlaceholder:!0}),e(h,{value:"READ_ONLY"}),e(h,{value:"WRITABLE"}),e(h,{value:"UNSYNCED"})]})})}),e(r,{label:a("usersDN"),labelIcon:e(l,{helpText:a("usersDNHelp"),fieldLabelId:"usersDn"}),fieldId:"kc-ui-users-dn",isRequired:!0,validated:t.formState.errors.config?.usersDn?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.usersDn?.[0].message,children:e(p,{isRequired:!0,defaultValue:"",id:"kc-ui-users-dn","data-testid":"ldap-users-dn",validated:t.formState.errors.config?.usersDn?.[0]?"error":"default",...t.register("config.usersDn.0",{required:{value:!0,message:a("validateUsersDn").toString()}})})}),e(r,{label:a("usernameLdapAttribute"),labelIcon:e(l,{helpText:a("usernameLdapAttributeHelp"),fieldLabelId:"usernameLdapAttribute"}),fieldId:"kc-username-ldap-attribute",isRequired:!0,validated:t.formState.errors.config?.usernameLDAPAttribute?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.usernameLDAPAttribute?.[0].message,children:e(p,{isRequired:!0,defaultValue:"cn",id:"kc-username-ldap-attribute","data-testid":"ldap-username-attribute",validated:t.formState.errors.config?.usernameLDAPAttribute?.[0]?"error":"default",...t.register("config.usernameLDAPAttribute.0",{required:{value:!0,message:`${a("validateUsernameLDAPAttribute")}`}})})}),e(r,{label:a("rdnLdapAttribute"),labelIcon:e(l,{helpText:a("rdnLdapAttributeHelp"),fieldLabelId:"rdnLdapAttribute"}),fieldId:"kc-rdn-ldap-attribute",isRequired:!0,validated:t.formState.errors.config?.rdnLDAPAttribute?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.rdnLDAPAttribute?.[0].message,children:e(p,{isRequired:!0,defaultValue:"cn",id:"kc-rdn-ldap-attribute","data-testid":"ldap-rdn-attribute",validated:t.formState.errors.config?.rdnLDAPAttribute?.[0]?"error":"default",...t.register("config.rdnLDAPAttribute.0",{required:{value:!0,message:`${a("validateRdnLdapAttribute")}`}})})}),e(r,{label:a("uuidLdapAttribute"),labelIcon:e(l,{helpText:a("uuidLdapAttributeHelp"),fieldLabelId:"uuidLdapAttribute"}),fieldId:"kc-uuid-ldap-attribute",isRequired:!0,validated:t.formState.errors.config?.uuidLDAPAttribute?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.uuidLDAPAttribute?.[0].message,children:e(p,{isRequired:!0,defaultValue:"objectGUID",id:"kc-uuid-ldap-attribute","data-testid":"ldap-uuid-attribute",validated:t.formState.errors.config?.uuidLDAPAttribute?.[0]?"error":"default",...t.register("config.uuidLDAPAttribute.0",{required:{value:!0,message:`${a("validateUuidLDAPAttribute")}`}})})}),e(r,{label:a("userObjectClasses"),labelIcon:e(l,{helpText:a("userObjectClassesHelp"),fieldLabelId:"userObjectClasses"}),fieldId:"kc-user-object-classes",isRequired:!0,validated:t.formState.errors.config?.userObjectClasses?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.userObjectClasses?.[0].message,children:e(p,{isRequired:!0,defaultValue:"person, organizationalPerson, user",id:"kc-user-object-classes","data-testid":"ldap-user-object-classes",validated:t.formState.errors.config?.userObjectClasses?.[0]?"error":"default",...t.register("config.userObjectClasses.0",{required:{value:!0,message:a("validateUserObjectClasses").toString()}})})}),e(r,{label:a("userLdapFilter"),labelIcon:e(l,{helpText:a("userLdapFilterHelp"),fieldLabelId:"userLdapFilter"}),fieldId:"kc-user-ldap-filter",validated:t.formState.errors.config?.customUserSearchFilter?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.customUserSearchFilter?.[0].message,children:e(p,{id:"kc-user-ldap-filter","data-testid":"user-ldap-filter",validated:t.formState.errors.config?.customUserSearchFilter?.[0]?"error":"default",...t.register("config.customUserSearchFilter.0",{pattern:{value:/(\(.*\))$/,message:a("validateCustomUserSearchFilter").toString()}})})}),e(r,{label:a("searchScope"),labelIcon:e(l,{helpText:a("searchScopeHelp"),fieldLabelId:"searchScope"}),fieldId:"kc-search-scope",children:e(b,{name:"config.searchScope[0]",defaultValue:"",control:t.control,render:({field:v})=>u(D,{toggleId:"kc-search-scope",required:!0,onToggle:()=>c(!i),isOpen:i,onSelect:(o,f)=>{v.onChange(f),c(!1)},selections:v.value,variant:x.single,children:[e(h,{value:"1",isPlaceholder:!0,children:a("oneLevel")},0),e(h,{value:"2",children:a("subtree")},1)]})})}),e(r,{label:a("readTimeout"),labelIcon:e(l,{helpText:a("readTimeoutHelp"),fieldLabelId:"readTimeout"}),fieldId:"kc-read-timeout",children:e(p,{type:"number",min:0,id:"kc-read-timeout","data-testid":"ldap-read-timeout",...t.register("config.readTimeout.0")})}),e(r,{label:a("pagination"),labelIcon:e(l,{helpText:a("paginationHelp"),fieldLabelId:"pagination"}),fieldId:"kc-ui-pagination",hasNoPaddingTop:!0,children:e(b,{name:"config.pagination",defaultValue:["false"],control:t.control,render:({field:v})=>e(I,{id:"kc-ui-pagination","data-testid":"ui-pagination",isDisabled:!1,onChange:o=>v.onChange([`${o}`]),isChecked:v.value[0]==="true",label:a("on"),labelOff:a("off"),"aria-label":a("pagination")})})})]})]})},de=({form:t,showSectionHeading:n=!1,showSectionDescription:s=!1})=>{const{t:a}=P(),i=t.watch("config.periodicFullSync",!1),c=t.watch("config.periodicChangedUsersSync",!1);return u(m,{children:[n&&e(L,{title:a("synchronizationSettings"),description:a("ldapSynchronizationSettingsDescription"),showDescription:s}),u(T,{role:"manage-realm",isHorizontal:!0,children:[e(r,{hasNoPaddingTop:!0,label:a("importUsers"),labelIcon:e(l,{helpText:a("importUsersHelp"),fieldLabelId:"importUsers"}),fieldId:"kc-import-users",children:e(b,{name:"config.importEnabled",defaultValue:["true"],control:t.control,render:({field:d})=>e(I,{id:"kc-import-users","data-testid":"import-users",name:"importEnabled",label:a("on"),labelOff:a("off"),onChange:g=>d.onChange([`${g}`]),isChecked:d.value[0]==="true",isDisabled:!1,"aria-label":a("importUsers")})})}),e(r,{hasNoPaddingTop:!0,label:a("syncRegistrations"),labelIcon:e(l,{helpText:a("syncRegistrations"),fieldLabelId:"syncRegistrations"}),fieldId:"syncRegistrations",children:e(b,{name:"config.syncRegistrations",defaultValue:["true"],control:t.control,render:({field:d})=>e(I,{id:"syncRegistrations","data-testid":"syncRegistrations",label:a("on"),labelOff:a("off"),onChange:g=>d.onChange([`${g}`]),isChecked:d.value[0]==="true","aria-label":a("syncRegistrations")})})}),e(r,{label:a("batchSize"),labelIcon:e(l,{helpText:a("batchSizeHelp"),fieldLabelId:"batchSize"}),fieldId:"kc-batch-size",children:e(p,{type:"number",min:0,id:"kc-batch-size","data-testid":"batch-size",...t.register("config.batchSizeForSync.0")})}),e(r,{label:a("periodicFullSync"),labelIcon:e(l,{helpText:a("periodicFullSyncHelp"),fieldLabelId:"periodicFullSync"}),fieldId:"kc-periodic-full-sync",hasNoPaddingTop:!0,children:e(b,{name:"config.periodicFullSync",defaultValue:!1,control:t.control,render:({field:d})=>e(I,{id:"kc-periodic-full-sync","data-testid":"periodic-full-sync",isDisabled:!1,onChange:g=>d.onChange(g),isChecked:d.value===!0,label:a("on"),labelOff:a("off"),"aria-label":a("periodicFullSync")})})}),i&&e(r,{hasNoPaddingTop:!0,label:a("fullSyncPeriod"),labelIcon:e(l,{helpText:a("fullSyncPeriodHelp"),fieldLabelId:"fullSyncPeriod"}),fieldId:"kc-full-sync-period",children:e(p,{type:"number",min:-1,defaultValue:604800,id:"kc-full-sync-period","data-testid":"full-sync-period",...t.register("config.fullSyncPeriod.0")})}),e(r,{label:a("periodicChangedUsersSync"),labelIcon:e(l,{helpText:a("periodicChangedUsersSyncHelp"),fieldLabelId:"periodicChangedUsersSync"}),fieldId:"kc-periodic-changed-users-sync",hasNoPaddingTop:!0,children:e(b,{name:"config.periodicChangedUsersSync",defaultValue:!1,control:t.control,render:({field:d})=>e(I,{id:"kc-periodic-changed-users-sync","data-testid":"periodic-changed-users-sync",isDisabled:!1,onChange:g=>d.onChange(g),isChecked:d.value===!0,label:a("on"),labelOff:a("off"),"aria-label":a("periodicChangedUsersSync")})})}),c&&e(r,{label:a("changedUsersSyncPeriod"),labelIcon:e(l,{helpText:a("changedUsersSyncHelp"),fieldLabelId:"changedUsersSyncPeriod"}),fieldId:"kc-changed-users-sync-period",hasNoPaddingTop:!0,children:e(p,{type:"number",min:-1,defaultValue:86400,id:"kc-changed-users-sync-period","data-testid":"changed-users-sync-period",...t.register("config.changedSyncPeriod.0")})})]})]})},Ie=({id:t,onSubmit:n})=>{const{t:s}=P(),a=K(),i=M(),{realm:c}=O(),d=W();return u(m,{children:[e(B,{label:s("jumpToSection"),sections:[{title:s("generalOptions"),panel:e(re,{form:a,vendorEdit:!!t})},{title:s("connectionAndAuthenticationSettings"),panel:e(te,{form:a,id:t})},{title:s("ldapSearchingAndUpdatingSettings"),panel:e(ne,{form:a})},{title:s("synchronizationSettings"),panel:e(de,{form:a})},{title:s("kerberosIntegration"),panel:e(le,{form:a}),isHidden:!d(Y.Kerberos)},{title:s("cacheSettings"),panel:e(Q,{form:a})},{title:s("advancedSettings"),panel:e(ie,{form:a,id:t})}]}),e(X,{onSubmit:a.handleSubmit(n),children:e(G,{name:"ldap",isActive:a.formState.isDirty,isSubmit:!0,children:e(w,{variant:"link",onClick:()=>i(_({realm:c})),"data-testid":"ldap-cancel",children:s("cancel")})})})]})};function ke(t){const{config:n}=t;return n?.periodicChangedUsersSync!==void 0&&(n.periodicChangedUsersSync===!1&&(n.changedSyncPeriod=["-1"]),delete n.periodicChangedUsersSync),n?.periodicFullSync!==void 0&&(n.periodicFullSync===!1&&(n.fullSyncPeriod=["-1"]),delete n.periodicFullSync),t}export{Ie as U,ke as s};
//# sourceMappingURL=UserFederationLdapForm-0DfckwdJ.js.map
