import{jsxs as u,Fragment as j,jsx as o}from"react/jsx-runtime";import{useState as F}from"react";import{u as G,f as H,g as L,d as q,e as N,a4 as $,ak as U,r as z,m as J,j as p,A as S,K as Q,P as W,F as T,i as X,V as m,h as Y,B as I,L as Z,al as _,ag as ee,am as oe,H as te,G as re}from"./index-sihFV1NS.js";import{u as ae}from"./ConfirmDialog-WMVurgkl.js";import{D as ie}from"./DynamicComponents-f6aNOnzT.js";import{F as pe}from"./FormAccess-EK-4wbwg.js";import{K as b}from"./KeycloakTextInput--S1SG2UN.js";import{V as ne}from"./ViewHeader-xo54NRb6.js";import{u as se}from"./useParams-OD1jI_R2.js";import{A as le}from"./Form-bfj-xQZn.js";import"react-dom";import"./Modal-uOAPm2rX.js";import"./ClientSelect-sh5SEoBO.js";import"./FileUpload-LIezXv7x.js";import"./CodeEditor-7uqvO0EK.js";import"./copy-icon-WaWzxYgU.js";import"./EmptyStateBody-jnnI7hpP.js";import"./EmptyStateSecondaryActions-G5doWCZ5.js";import"./GroupPickerDialog-gC2-xBPw.js";import"./PaginatingTableToolbar--Dt3wwL6.js";import"./TableToolbar-vuixsfwd.js";import"./ToolbarContent-46I9Yg7h.js";import"./useToggle-mZS4AEtR.js";import"./DataListItemRow-te2VcAoi.js";import"./data-list-CDN1kyj9.js";import"./grip-vertical-icon-accuSWkz.js";import"./_baseRest-lI6NnEVt.js";import"./ActionListItem-1jrwMZdM.js";import"./Flex-W2FoLD7u.js";import"./FlexItem-Mxf6oLng.js";import"./MultiLineInput-MBnUzZD_.js";import"./PasswordInput-P6txGPqu.js";import"./AddRoleMappingModal-uxjjMt5W.js";import"./useLocaleSort-K-jL4v2R.js";import"./KeycloakDataTable-Q3kZYP9q.js";import"./Td-uwYquKT4.js";import"./resource-BRtaBrSc.js";import"./filter-icon-0B3gA_nj.js";import"./KeycloakTextArea-NBwG1p2x.js";function We(){const{t}=G(),{addAlert:f,addError:g}=H(),{id:r,mapperId:a}=se(),y=L(),{register:C,setValue:P,formState:{errors:h},handleSubmit:D}=y,[d,A]=F(),[V,x]=F(),E=q(),{realm:M}=N(),w=$(),K=/^[{]?[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$/,s=!!a.match(K),l=!!U(_.path),v=()=>l?ee({realm:M,id:r,tab:"mappers"}):oe({realm:M,clientId:r,tab:"mappers"});z(async()=>{let e;if(s){if(l?e=await p.clientScopes.findProtocolMapper({id:r,mapperId:a}):e=await p.clients.findProtocolMapperById({id:r,mapperId:a}),!e)throw new Error(t("notFound"));const i=w.protocolMapperTypes[e.protocol].find(c=>c.id===e.protocolMapper);return{config:{protocol:e.protocol,protocolMapper:e.protocolMapper},mapping:i,data:e}}else{const n=l?await p.clientScopes.findOne({id:r}):await p.clients.findOne({id:r});if(!n)throw new Error(t("notFound"));const c=w.protocolMapperTypes[n.protocol].find(R=>R.id===a);if(!c)throw new Error(t("notFound"));return{mapping:c,config:{protocol:n.protocol,protocolMapper:a}}}},({config:e,mapping:n,data:i})=>{x(e),A(n),i&&re(i,P)},[]);const[O,k]=ae({titleKey:"deleteMappingTitle",messageKey:"deleteMappingConfirm",continueButtonLabel:"delete",continueButtonVariant:J.danger,onConfirm:async()=>{try{l?await p.clientScopes.delProtocolMapper({id:r,mapperId:a}):await p.clients.delProtocolMapper({id:r,mapperId:a}),f(t("mappingDeletedSuccess"),S.success),E(v())}catch(e){g("mappingDeletedError",e)}}}),B=async e=>{const n=s?"Updated":"Created";try{const i={...V,...te(e)};s?l?await p.clientScopes.updateProtocolMapper({id:r,mapperId:a},{id:a,...i}):await p.clients.updateProtocolMapper({id:r,mapperId:a},{id:a,...i}):l?await p.clientScopes.addProtocolMapper({id:r},i):await p.clients.addProtocolMapper({id:r},i),f(t(`mapping${n}Success`),S.success)}catch(i){g(`mapping${n}Error`,i)}};return u(j,{children:[o(k,{}),o(ne,{titleKey:s?d?.name:t("addMapper"),subKey:s?a:"addMapperExplain",dropdownItems:s?[o(Q,{value:"delete",onClick:O,children:t("delete")},"delete")]:void 0}),o(W,{variant:"light",children:u(pe,{isHorizontal:!0,onSubmit:D(B),role:"manage-clients",children:[o(T,{label:t("mapperType"),fieldId:"mapperType",children:o(b,{type:"text",id:"mapperType",name:"mapperType",isReadOnly:!0,value:d?.name})}),o(T,{label:t("name"),labelIcon:o(X,{helpText:t("mapperNameHelp"),fieldLabelId:"name"}),fieldId:"name",isRequired:!0,validated:h.name?m.error:m.default,helperTextInvalid:t("required"),children:o(b,{id:"name",isReadOnly:s,validated:h.name?m.error:m.default,...C("name",{required:!0})})}),o(Y,{...y,children:o(ie,{properties:d?.properties||[],isNew:!s})}),u(le,{children:[o(I,{variant:"primary",type:"submit",children:t("save")}),o(I,{variant:"link",component:e=>o(Z,{...e,to:v()}),children:t("cancel")})]})]})})]})}export{We as default};
//# sourceMappingURL=MappingDetails-4JZmq9gl.js.map
