import{jsxs as c,Fragment as y,jsx as e}from"react/jsx-runtime";import{u as v,a as F,T as b,F as P,i as S,j as h,d as k,bh as D,g as E,f as C,e as O,P as A,h as x,B as f,L as T,bS as w,A as L,bT as U}from"./index-sihFV1NS.js";import{F as V}from"./FormAccess-EK-4wbwg.js";import{V as j}from"./ViewHeader-xo54NRb6.js";import{D as B,O as G,a as H}from"./OIDCGeneralSettings-x9esjFKG.js";import{J}from"./JsonFileUpload-vH-C_c0p.js";import{D as K}from"./DiscoveryEndpointField--MEYVRbO.js";import{A as N}from"./Form-bfj-xQZn.js";import"react";import"react-dom";import"./copy-icon-WaWzxYgU.js";import"./ToolbarContent-46I9Yg7h.js";import"./KeycloakTextArea-NBwG1p2x.js";import"./KeycloakTextInput--S1SG2UN.js";import"./discovery-settings-sDKXSACJ.js";import"./ExpandableSection-JW5wd_BH.js";import"./ClientIdSecret-xi11Xph8.js";import"./PasswordInput-P6txGPqu.js";import"./DisplayOrder-DqQik7ga.js";import"./FileUploadForm-NPdolxQM.js";import"./FileUpload-LIezXv7x.js";import"./CodeEditor-7uqvO0EK.js";import"./EmptyStateBody-jnnI7hpP.js";import"./EmptyStateSecondaryActions-G5doWCZ5.js";import"./Modal-uOAPm2rX.js";const z=()=>{const{t}=v(),l="oidc",{setValue:m,setError:d,clearErrors:s,formState:{errors:o}}=F(),p=r=>{Object.keys(r).map(i=>m(`config.${i}`,r[i]))},u=async r=>{if(s("discoveryError"),!r)return;const i=new FormData;i.append("providerId",l),i.append("file",new Blob([JSON.stringify(r)]));try{const a=await h.identityProviders.importFromUrl(i);p(a)}catch(a){d("discoveryError",{type:"manual",message:a.message})}};return c(y,{children:[e(b,{headingLevel:"h2",size:"xl",className:"kc-form-panel__title",children:t("oidcSettings")}),e(K,{id:"oidc",fileUpload:e(P,{label:t("importConfig"),fieldId:"kc-import-config",labelIcon:e(S,{helpText:t("importConfigHelp"),fieldLabelId:"importConfig"}),validated:o.discoveryError?"error":"default",helperTextInvalid:o.discoveryError?.message,children:e(J,{id:"kc-import-config",helpText:t("identity=providers-help:jsonFileUpload"),hideDefaultPreview:!0,unWrap:!0,validated:o.discoveryError?"error":"default",onChange:r=>u(r)})}),children:r=>e(B,{readOnly:r})})]})};function ye(){const{t}=v(),l=k(),{pathname:m}=D(),d=m.includes("keycloak-oidc"),s=`${d?"keycloak-":""}oidc`,o=E({defaultValues:{alias:s}}),{handleSubmit:p,formState:{isDirty:u}}=o,{addAlert:r,addError:i}=C(),{realm:a}=O(),g=async n=>{delete n.discoveryEndpoint;try{await h.identityProviders.create({...n,providerId:s}),r(t("createIdentityProviderSuccess"),L.success),l(U({realm:a,providerId:s,alias:n.alias,tab:"settings"}))}catch(I){i("createIdentityProviderError",I)}};return c(y,{children:[e(j,{titleKey:t(d?"addKeycloakOpenIdProvider":"addOpenIdProvider")}),e(A,{variant:"light",children:e(x,{...o,children:c(V,{role:"manage-identity-providers",isHorizontal:!0,onSubmit:p(g),children:[e(G,{}),e(z,{}),e(H,{}),c(N,{children:[e(f,{isDisabled:!u,variant:"primary",type:"submit","data-testid":"createProvider",children:t("add")}),e(f,{variant:"link","data-testid":"cancel",component:n=>e(T,{...n,to:w({realm:a})}),children:t("cancel")})]})]})})})]})}export{ye as default};
//# sourceMappingURL=AddOpenIdConnect-9Z9iTWbo.js.map
