import{jsx as e,jsxs as o,Fragment as U}from"react/jsx-runtime";import*as ze from"react";import{useState as p,useMemo as Tt,useEffect as Ke,useRef as Ze,Fragment as Dn,useId as ha}from"react";import{_ as Ct,l as qe,az as ma,e as ge,u as w,a7 as Nn,a4 as Ge,r as le,aA as st,F as v,i as k,S as Y,b as $,c as z,aa as ga,ab as fa,j as E,ac as ba,aB as et,a as ee,C as K,a1 as lt,a2 as Ae,ao as P,Q as ce,B as L,aC as ya,g as Le,f as de,m as Se,A as Z,ap as Oe,aD as Me,z as be,L as ye,am as Kn,Y as $t,E as Wt,P as fe,aE as Hn,aF as Ot,aG as De,aH as Ve,V as ke,aI as va,a3 as Sa,a6 as Fn,X as Be,D as Ta,aJ as It,aK as Jt,aL as Ca,aM as Ia,aN as ka,a5 as Ue,aO as Aa,Z as it,h as He,T as yt,aP as Ra,O as Pe,d as rt,aQ as vt,p as qt,I as Qt,J as Mn,K as tt,aR as xa,af as ot,aS as sn,aT as Vn,aU as ln,aV as zn,aW as rn,R as St,aX as Ea,x as wt,y as nt,aY as wa,aZ as Oa,a_ as Pa,ai as _a,a$ as La,b0 as Da,b1 as on,b2 as qn,b3 as Na,aw as Ka,b4 as Ha,b5 as Fa,b6 as cn,b7 as dn,b8 as Ma,G as Va,H as un,b9 as za}from"./index-sihFV1NS.js";import{C as Yt,u as Re}from"./ConfirmDialog-WMVurgkl.js";import{K as ct}from"./KeycloakTextArea-NBwG1p2x.js";import{a as kt,M as $e}from"./Modal-uOAPm2rX.js";import{F as Te,A as xe}from"./Form-bfj-xQZn.js";import{S as qa,a as pn,F as pe,C as Ba,b as Bn}from"./FormAccess-EK-4wbwg.js";import{P as Ua}from"./PermissionTab-5VqfGSUL.js";import{R as ja}from"./RolesList-Cfnu9UtK.js";import{R as Kt,u as Ht}from"./RoutableTabs-a7VqIL_I.js";import{V as Ga}from"./ViewHeader-xo54NRb6.js";import{u as Un,F as jn}from"./useIsFeatureEnabled-qmmJPqO8.js";import{u as Xt}from"./useParams-OD1jI_R2.js";import{u as Ce}from"./useToggle-mZS4AEtR.js";import{K as $a}from"./KeyValueInput-CbiNnu-2.js";import{M as Gn}from"./MultiLineInput-MBnUzZD_.js";import{T as Zt}from"./TimeSelector-UGEjvSE_.js";import{s as $n}from"./sortBy-zPScg0cx.js";import{L as _e,P as Pt}from"./PaginatingTableToolbar--Dt3wwL6.js";import{K as _t}from"./KeycloakDataTable-Q3kZYP9q.js";import{u as en,F as Wn}from"./useFormatDate-kyFeutIw.js";import{K as me}from"./KeycloakTextInput--S1SG2UN.js";import{E as Jn}from"./ExpandableSection-JW5wd_BH.js";import{b as ve,T as Wa,c as Ja}from"./ToolbarContent-46I9Yg7h.js";import{T as Qn}from"./Trans-1cjg0ImV.js";import{S as Qa}from"./SessionsTable-fP9nbE0z.js";import{C as Ya,a as Xa}from"./ClientDescription-nfMy2LGM.js";import{F as Lt}from"./FixedButtonGroup-6gQXZmA0.js";import{L as Za}from"./LoginSettings-OF4uI7Gm.js";import{C as ei}from"./ClientSelect-sh5SEoBO.js";import{U as Yn,N as hn,D as ti,A as ni}from"./NewPolicyDialog-th1Dwl3Y.js";import{d as Xn,i as xt,g as ai}from"./utils-9X4NJJvK.js";import{c as ii}from"./camelCase-1QzwORZ_.js";import{T as We,O as Je,P as re,Q as j,R as Qe,S as F,U as dt}from"./Td-uwYquKT4.js";import{D as mn}from"./policyRepresentation-ct1daQhu.js";import{D as ut,a as si,b as li,c as ri}from"./DescriptionListTerm-sSQQqmBE.js";import{s as oi,P as gn,a as fn}from"./TableToolbar-vuixsfwd.js";import{E as Zn,a as ea}from"./EmptyStateBody-jnnI7hpP.js";import{E as ci}from"./EmptyStateSecondaryActions-G5doWCZ5.js";import{D as di}from"./DeleteScopeDialog-7uqkIpOA.js";import{J as ui}from"./JsonFileUpload-vH-C_c0p.js";import{P as Bt}from"./PasswordInput-P6txGPqu.js";import{F as ta}from"./FileUpload-LIezXv7x.js";import{F as pi}from"./Flex-W2FoLD7u.js";import{F as bn}from"./FlexItem-Mxf6oLng.js";import{S as hi,a as mi,C as gi,n as fi,t as bi}from"./SearchFilter-geHnFeJ7.js";import{A as yn,e as vn,f as yi,a as vi,g as Si,C as Sn}from"./ClientScopeTypes-Hwl8E8GJ.js";import{u as Ti,m as Ci}from"./useLocaleSort-K-jL4v2R.js";import{c as ft,T as Ii,a as ie,b as se}from"./Tabs-wiayO8Tk.js";import{Q as ki}from"./question-circle-icon-0KWACECW.js";import{R as Ai}from"./AddRoleMappingModal-uxjjMt5W.js";import"react-dom";import"./copy-icon-WaWzxYgU.js";import"./minus-icon-3MARcJXf.js";import"./ActionListItem-1jrwMZdM.js";import"./_baseRest-lI6NnEVt.js";import"./utils-ATQIxiIC.js";import"./ListItem-zTOCxRJG.js";import"./SwitchControl-KreblmOr.js";import"./filter-icon-0B3gA_nj.js";import"./GroupPickerDialog-gC2-xBPw.js";import"./DataListItemRow-te2VcAoi.js";import"./data-list-CDN1kyj9.js";import"./grip-vertical-icon-accuSWkz.js";import"./CodeEditor-7uqvO0EK.js";import"./DatePicker-zM1UwT7F.js";import"./MenuList-82IaVNxu.js";import"./NumberInput-QtFengwl.js";import"./plus-icon-zbmNbCLY.js";import"./capitalize-msOXuIMv.js";import"./FileUploadForm-NPdolxQM.js";import"./resource-BRtaBrSc.js";const Rt={codeBlock:"pf-c-code-block",codeBlockActions:"pf-c-code-block__actions",codeBlockCode:"pf-c-code-block__code",codeBlockContent:"pf-c-code-block__content",codeBlockHeader:"pf-c-code-block__header",codeBlockPre:"pf-c-code-block__pre"},na=n=>{var{children:a=null,className:s,actions:t=null}=n,i=Ct(n,["children","className","actions"]);return ze.createElement("div",Object.assign({className:qe(Rt.codeBlock,s)},i),ze.createElement("div",{className:qe(Rt.codeBlockHeader)},ze.createElement("div",{className:qe(Rt.codeBlockActions)},t&&t)),ze.createElement("div",{className:qe(Rt.codeBlockContent)},a))};na.displayName="CodeBlock";const aa=n=>{var{children:a=null,className:s}=n,t=Ct(n,["children","className"]);return ze.createElement("div",Object.assign({className:qe("pf-c-code-block__actions-item",s)},t),a)};aa.displayName="CodeBlockAction";const Ut=n=>{var{className:a,children:s}=n,t=Ct(n,["className","children"]);return ze.createElement("div",Object.assign({className:qe(oi.panelHeader,a)},t),s)};Ut.displayName="PanelHeader";var jt;(function(n){n.ul="ul",n.ol="ol",n.dl="dl"})(jt||(jt={}));const ia=n=>{var{children:a=null,className:s="",component:t=jt.ul,isPlain:i=!1}=n,l=Ct(n,["children","className","component","isPlain"]);const r=t;return ze.createElement(r,Object.assign({},l,{className:qe(i&&ma.modifiers.plain,s)}),a)};ia.displayName="TextList";var Gt;(function(n){n.li="li",n.dt="dt",n.dd="dd"})(Gt||(Gt={}));const sa=n=>{var{children:a=null,className:s="",component:t=Gt.li}=n,i=Ct(n,["children","className","component"]);const l=t;return ze.createElement(l,Object.assign({},i,{className:qe(s)}),a)};sa.displayName="TextListItem";const Ri=({id:n,open:a,toggleDialog:s,protocol:t="openid-connect"})=>{const{realm:i}=ge(),{t:l}=w(),{enabled:r}=Nn(),c=Ge().clientInstallations[t],[h,f]=p(c[c.length-1].id),[g,d]=p(),[m,y]=p(!1),T=Tt(()=>c.find(b=>b.id===h)??null,[h]),C=b=>b.replace(/<PrivateKeyPem>.*<\/PrivateKeyPem>/gs,`<PrivateKeyPem>${l("privateKeyMask")}</PrivateKeyPem>`);return le(async()=>{if(T?.mediaType==="application/zip")return(await ga(`${ba(E.baseUrl)}admin/realms/${i}/clients/${n}/installation/providers/${h}`,{method:"GET",headers:fa(await E.getAccessToken())})).arrayBuffer();{const b=await E.clients.getInstallationProviders({id:n,providerId:h});return typeof b=="string"?C(b):et(b)}},b=>d(b),[n,h]),Ke(()=>d(""),[n,h]),e(Yt,{titleKey:l("downloadAdaptorTitle"),continueButtonLabel:l("download"),onConfirm:()=>{st.saveAs(new Blob([g],{type:T?.mediaType}),T?.filename)},open:a,toggleDialog:s,variant:kt.medium,children:e(Te,{children:o(qa,{hasGutter:!0,children:[e(pn,{children:e(v,{fieldId:"type",label:l("formatOption"),labelIcon:e(k,{helpText:l("downloadType"),fieldLabelId:"formatOption"}),children:e(Y,{toggleId:"type",isOpen:m,onToggle:b=>y(b),variant:$.single,value:h,selections:h,onSelect:(b,V)=>{f(V.toString()),y(!1)},"aria-label":"Select Input",menuAppendTo:()=>document.body,children:c.map(b=>e(z,{value:b.id,isSelected:h===b.id,description:r?b.helpText:void 0,children:b.displayType},b.id))})})}),!T?.downloadOnly&&e(pn,{isFilled:!0,children:e(v,{fieldId:"details",label:l("details"),labelIcon:e(k,{helpText:l("detailsHelp"),fieldLabelId:"details"}),children:e(ct,{id:"details",readOnly:!0,rows:12,resizeOrientation:"vertical",value:g&&typeof g=="string"?g:"","aria-label":"text area example"})})})]})})})},Tn="tokenLifespan.inherited",Cn="tokenLifespan.expires",bt=({id:n,name:a,defaultValue:s,units:t})=>{const{t:i}=w(),[l,r]=p(!1),[u,c]=p(!1),h=()=>c(!0),f=()=>c(!1),{control:g}=ee(),d=m=>typeof m=="number"||typeof m=="string"&&m!==""||u;return e(v,{label:i(n),fieldId:n,labelIcon:e(k,{helpText:i(`${n}Help`),fieldLabelId:n}),children:e(K,{name:a,defaultValue:"",control:g,render:({field:m})=>o(lt,{hasGutter:!0,children:[e(Ae,{children:o(Y,{variant:$.single,onToggle:r,isOpen:l,onSelect:(y,T)=>{m.onChange(T),r(!1)},selections:[d(m.value)?i(Cn):i(Tn)],children:[e(z,{value:"",children:i(Tn)}),e(z,{value:60,children:i(Cn)})]})}),e(Ae,{children:e(Zt,{validated:d(m.value)&&m.value<1?"warning":"default",units:t,value:m.value===""?s:m.value,onChange:m.onChange,onFocus:h,onBlur:f,min:1,isDisabled:!d(m.value)})})]})})})},xi=({save:n,reset:a,protocol:s,hasConfigureAccess:t})=>{const{t:i}=w(),[l,r]=p(!1),[u,c]=p(),{realm:h}=ge(),g=Un()(jn.DPoP);le(()=>E.realms.findOne({realm:h}),c,[]);const{control:d}=ee();return o(pe,{role:"manage-realm",fineGrainedAccess:t,isHorizontal:!0,children:[s!=="openid-connect"&&e(v,{label:i("assertionLifespan"),fieldId:"assertionLifespan",labelIcon:e(k,{helpText:i("assertionLifespanHelp"),fieldLabelId:"assertionLifespan"}),children:e(K,{name:P("attributes.saml.assertion.lifespan"),defaultValue:"",control:d,render:({field:m})=>e(Zt,{units:["minute","day","hour"],value:m.value,onChange:m.onChange})})}),s==="openid-connect"&&o(U,{children:[e(bt,{id:"accessTokenLifespan",name:P("attributes.access.token.lifespan"),defaultValue:u?.accessTokenLifespan,units:["minute","day","hour"]}),e(bt,{id:"clientSessionIdle",name:P("attributes.client.session.idle.timeout"),defaultValue:u?.clientSessionIdleTimeout,units:["minute","day","hour"]}),e(bt,{id:"clientSessionMax",name:P("attributes.client.session.max.lifespan"),defaultValue:u?.clientSessionMaxLifespan,units:["minute","day","hour"]}),e(bt,{id:"clientOfflineSessionIdle",name:P("attributes.client.offline.session.idle.timeout"),defaultValue:u?.offlineSessionIdleTimeout,units:["minute","day","hour"]}),e(bt,{id:"clientOfflineSessionMax",name:P("attributes.client.offline.session.max.lifespan"),defaultValue:u?.offlineSessionMaxLifespanEnabled?u.offlineSessionMaxLifespan:void 0,units:["minute","day","hour"]}),e(v,{label:i("oAuthMutual"),fieldId:"oAuthMutual",hasNoPaddingTop:!0,labelIcon:e(k,{helpText:i("oAuthMutualHelp"),fieldLabelId:"oAuthMutual"}),children:e(K,{name:P("attributes.tls.client.certificate.bound.access.tokens"),defaultValue:!1,control:d,render:({field:m})=>e(ce,{id:"oAuthMutual-switch",label:i("on"),labelOff:i("off"),isChecked:m.value==="true",onChange:y=>m.onChange(""+y),"aria-label":i("oAuthMutual")})})}),g&&e(v,{label:i("oAuthDPoP"),fieldId:"oAuthDPoP",hasNoPaddingTop:!0,labelIcon:e(k,{helpText:i("oAuthDPoPHelp"),fieldLabelId:"oAuthDPoP"}),children:e(K,{name:P("attributes.dpop.bound.access.tokens"),defaultValue:!1,control:d,render:({field:m})=>e(ce,{id:"oAuthDPoP-switch",label:i("on"),labelOff:i("off"),isChecked:m.value==="true",onChange:y=>m.onChange(""+y),"aria-label":i("oAuthDPoP")})})}),e(v,{label:i("keyForCodeExchange"),fieldId:"keyForCodeExchange",hasNoPaddingTop:!0,labelIcon:e(k,{helpText:i("keyForCodeExchangeHelp"),fieldLabelId:"keyForCodeExchange"}),children:e(K,{name:P("attributes.pkce.code.challenge.method"),defaultValue:"",control:d,render:({field:m})=>e(Y,{toggleId:"keyForCodeExchange",variant:$.single,onToggle:r,isOpen:l,onSelect:(y,T)=>{m.onChange(T),r(!1)},selections:[m.value||i("choose")],children:["","S256","plain"].map(y=>e(z,{value:y,children:y||i("choose")},y))})})}),e(v,{label:i("pushedAuthorizationRequestRequired"),fieldId:"pushedAuthorizationRequestRequired",labelIcon:e(k,{helpText:i("pushedAuthorizationRequestRequiredHelp"),fieldLabelId:"pushedAuthorizationRequestRequired"}),children:e(K,{name:P("attributes.require.pushed.authorization.requests"),defaultValue:"false",control:d,render:({field:m})=>e(ce,{id:"pushedAuthorizationRequestRequired",label:i("on"),labelOff:i("off"),isChecked:m.value==="true",onChange:y=>m.onChange(y.toString()),"aria-label":i("pushedAuthorizationRequestRequired")})})}),e(v,{label:i("acrToLoAMapping"),fieldId:"acrToLoAMapping",labelIcon:e(k,{helpText:i("acrToLoAMappingHelp"),fieldLabelId:"acrToLoAMapping"}),children:e($a,{name:P("attributes.acr.loa.map")})}),e(v,{label:i("defaultACRValues"),fieldId:"defaultACRValues",labelIcon:e(k,{helpText:i("defaultACRValuesHelp"),fieldLabelId:"defaultACRValues"}),children:e(Gn,{id:"defaultACRValues","aria-label":"defaultACRValues",name:P("attributes.default.acr.values"),stringify:!0})})]}),o(xe,{children:[e(L,{variant:"secondary",onClick:n,"data-testid":"OIDCAdvancedSave",children:i("save")}),e(L,{variant:"link",onClick:a,"data-testid":"OIDCAdvancedRevert",children:i("revert")})]})]})},Ei=({protocol:n,save:a,reset:s,hasConfigureAccess:t})=>{const{t:i}=w(),[l,r]=p([]),[u,c]=p(!1),[h,f]=p(!1),{control:g}=ee();return le(()=>E.authenticationManagement.getFlows(),d=>{let m=[...d.filter(y=>y.providerId!=="client-flow")];m=$n(m,[y=>y.alias]),r([e(z,{value:"",children:i("choose")},"empty"),...m.map(y=>e(z,{value:y.id,children:y.alias},y.id))])},[]),o(pe,{role:"manage-clients",fineGrainedAccess:t,isHorizontal:!0,children:[e(v,{label:i("browserFlow"),fieldId:"browserFlow",labelIcon:e(k,{helpText:i("browserFlowHelp"),fieldLabelId:"browserFlow"}),children:e(K,{name:"authenticationFlowBindingOverrides.browser",defaultValue:"",control:g,render:({field:d})=>e(Y,{toggleId:"browserFlow",variant:$.single,onToggle:c,isOpen:u,onSelect:(m,y)=>{d.onChange(y),c(!1)},selections:[d.value],children:l})})}),n==="openid-connect"&&e(v,{label:i("directGrant"),fieldId:"directGrant",labelIcon:e(k,{helpText:i("directGrantHelp"),fieldLabelId:"directGrant"}),children:e(K,{name:"authenticationFlowBindingOverrides.direct_grant",defaultValue:"",control:g,render:({field:d})=>e(Y,{toggleId:"directGrant",variant:$.single,onToggle:f,isOpen:h,onSelect:(m,y)=>{d.onChange(y),f(!1)},selections:[d.value],children:l})})}),o(xe,{children:[e(L,{variant:"secondary",onClick:a,"data-testid":"OIDCAuthFlowOverrideSave",children:i("save")}),e(L,{variant:"link",onClick:s,"data-testid":"OIDCAuthFlowOverrideRevert",children:i("revert")})]})]})},wi=n=>{const{field:a}=ya(n);return e(Zt,{...n,...a})},Oi=({clientId:n,isOpen:a,onAdded:s,onClose:t})=>{const{t:i}=w(),{register:l,handleSubmit:r,formState:{isDirty:u,isValid:c}}=Le(),{addAlert:h,addError:f}=de();async function g({node:d}){try{await E.clients.addClusterNode({id:n,node:d}),s(d),h(i("addedNodeSuccess"),Z.success)}catch(m){f("addedNodeFail",m)}t()}return e($e,{title:i("addNode"),isOpen:a,onClose:t,variant:"small",actions:[e(L,{id:"add-node-confirm",type:"submit",form:"add-host-form",isDisabled:!u||!c,children:i("save")},"confirm"),e(L,{id:"add-node-cancel",variant:Se.link,onClick:t,children:i("cancel")},"cancel")],children:e(Te,{id:"add-host-form",onSubmit:r(g),isHorizontal:!0,children:e(v,{label:i("nodeHost"),fieldId:"nodeHost",isRequired:!0,children:e(me,{id:"nodeHost",...l("node",{required:!0}),isRequired:!0})})})})},Pi=({save:n,client:{id:a,registeredNodes:s,access:t}})=>{const{t:i}=w(),{addAlert:l,addError:r}=de(),u=en(),[c,h]=p(s||{}),[f,g]=p(!1),[d,m]=p(""),[y,T]=p(!1),[C,b]=p(0),V=()=>b(new Date().getTime()),G=async()=>{const O=await E.clients.testNodesAvailable({id:a});ra(O,"testCluster",l,i)},[X,x]=Re({titleKey:"deleteNode",messageKey:i("deleteNodeBody",{node:d}),continueButtonLabel:"delete",continueButtonVariant:Se.danger,onConfirm:async()=>{try{await E.clients.deleteClusterNode({id:a,node:d}),h({...Object.keys(c).reduce((O,W)=>(W!==d&&(O[W]=c[W]),O),{})}),V(),l(i("deleteNodeSuccess"),Z.success)}catch(O){r("deleteNodeFail",O)}}});return o(U,{children:[e(pe,{role:"manage-clients",fineGrainedAccess:t?.configure,isHorizontal:!0,children:e(v,{label:i("nodeReRegistrationTimeout"),fieldId:"kc-node-reregistration-timeout",labelIcon:e(k,{helpText:i("nodeReRegistrationTimeoutHelp"),fieldLabelId:"nodeReRegistrationTimeout"}),children:o(lt,{hasGutter:!0,children:[e(Ae,{children:e(wi,{name:"nodeReRegistrationTimeout"})}),e(Ae,{children:e(L,{variant:Se.secondary,onClick:()=>n(),children:i("save")})})]})})}),o(U,{children:[e(x,{}),e(Oi,{clientId:a,isOpen:y,onAdded:O=>{c[O]=Date.now()/1e3,V()},onClose:()=>T(!1)}),e(Jn,{toggleText:i("registeredClusterNodes"),onToggle:g,isExpanded:f,children:e(_t,{ariaLabelKey:"registeredClusterNodes",loader:()=>Promise.resolve(Object.entries(c||{}).map(O=>({host:O[0],registration:O[1]}))),toolbarItem:o(U,{children:[e(ve,{children:e(L,{id:"testClusterAvailability",onClick:G,variant:Se.secondary,isDisabled:Object.keys(c).length===0,children:i("testClusterAvailability")})}),e(ve,{children:e(L,{id:"registerNodeManually",onClick:()=>T(!0),variant:Se.tertiary,children:i("registerNodeManually")})})]}),actions:[{title:i("delete"),onRowClick:O=>{m(O.host),X()}}],columns:[{name:"host",displayKey:"nodeHost"},{name:"registration",displayKey:"lastRegistration",cellFormatters:[O=>O?u(new Date(parseInt(O.toString())*1e3),Wn):""]}],emptyState:e(_e,{message:i("noNodes"),instructions:i("noNodesInstructions"),primaryActionText:i("registerNodeManually"),onPrimaryAction:()=>T(!0)})},C)})]})]})},la=n=>{const{t:a}=w();return o(U,{children:[e(Oe,{name:"attributes.logoUri",label:a("logoUrl"),labelIcon:a("logoUrlHelp"),type:"url",...n}),e(Oe,{name:"attributes.policyUri",label:a("policyUrl"),labelIcon:a("policyUrlHelp"),type:"url",...n}),e(Oe,{name:"attributes.tosUri",label:a("termsOfServiceUrl"),labelIcon:a("termsOfServiceUrlHelp"),type:"url",...n})]})},_i=({save:n,reset:a,hasConfigureAccess:s})=>{const{t}=w(),i=Ge().providers,l=i?.clientSignature.providers,r=i?.contentencryption.providers,u=i?.cekmanagement.providers,c=i?.signature.providers,[h,f]=p(!1),[g,d]=p(!1),[m,y]=p(!1),[T,C]=p(!1),[b,V]=p(!1),[G,X]=p(!1),[x,O]=p(!1),[W,_]=p(!1),[R,S]=p(!1),[I,B]=p(!1),[D,N]=p(!1),[q,H]=p(!1),[M,oe]=p(!1),[Ie,ne]=p(!1),{control:J}=ee(),ae=[e(z,{value:"",children:t("choose")},"empty"),...Me(l).map(A=>e(z,{value:A},A))],Ee=[e(z,{value:"",children:t("choose")},"empty"),...Me(u).map(A=>e(z,{value:A},A))],pt=[e(z,{value:"",children:t("unsigned")},"unsigned"),...Me(c).map(A=>e(z,{value:A},A))],Fe=[e(z,{value:"",children:t("choose")},"empty"),...Me(r).map(A=>e(z,{value:A},A))],ht=[e(z,{value:"any",children:t("any")},"any"),e(z,{value:"none",children:t("none")},"none"),...Me(l).map(A=>e(z,{value:A},A))],mt=[e(z,{value:"any",children:t("any")},"any"),...Me(u).map(A=>e(z,{value:A},A))],Ye=[e(z,{value:"any",children:t("any")},"any"),...Me(r).map(A=>e(z,{value:A},A))],Xe=[e(z,{value:"",children:t("choose")},"empty"),...Me(c).map(A=>e(z,{value:A},A))],he=["not required","request or request_uri","request only","request_uri only"].map(A=>e(z,{value:A,children:t(`requestObject.${A}`)},A));return o(pe,{role:"manage-clients",fineGrainedAccess:s,isHorizontal:!0,children:[e(la,{}),e(v,{label:t("accessTokenSignatureAlgorithm"),fieldId:"accessTokenSignatureAlgorithm",labelIcon:e(k,{helpText:t("accessTokenSignatureAlgorithmHelp"),fieldLabelId:"accessTokenSignatureAlgorithm"}),children:e(K,{name:P("attributes.access.token.signed.response.alg"),defaultValue:"",control:J,render:({field:A})=>e(Y,{toggleId:"accessTokenSignatureAlgorithm",variant:$.single,onToggle:f,isOpen:h,onSelect:(ue,Q)=>{A.onChange(Q),f(!1)},selections:A.value,children:ae})})}),e(v,{label:t("idTokenSignatureAlgorithm"),fieldId:"kc-id-token-signature",labelIcon:e(k,{helpText:t("idTokenSignatureAlgorithmHelp"),fieldLabelId:"idTokenSignatureAlgorithm"}),children:e(K,{name:P("attributes.id.token.signed.response.alg"),defaultValue:"",control:J,render:({field:A})=>e(Y,{toggleId:"idTokenSignatureAlgorithm",variant:$.single,onToggle:d,isOpen:g,onSelect:(ue,Q)=>{A.onChange(Q),d(!1)},selections:A.value,children:ae})})}),e(v,{label:t("idTokenEncryptionKeyManagementAlgorithm"),fieldId:"idTokenEncryptionKeyManagementAlgorithm",labelIcon:e(k,{helpText:t("idTokenEncryptionKeyManagementAlgorithmHelp"),fieldLabelId:"idTokenEncryptionKeyManagementAlgorithm"}),children:e(K,{name:P("attributes.id.token.encrypted.response.alg"),defaultValue:"",control:J,render:({field:A})=>e(Y,{toggleId:"idTokenEncryptionKeyManagementAlgorithm",variant:$.single,onToggle:y,isOpen:m,onSelect:(ue,Q)=>{A.onChange(Q),y(!1)},selections:A.value,children:Ee})})}),e(v,{label:t("idTokenEncryptionContentEncryptionAlgorithm"),fieldId:"idTokenEncryptionContentEncryptionAlgorithm",labelIcon:e(k,{helpText:t("idTokenEncryptionContentEncryptionAlgorithmHelp"),fieldLabelId:"idTokenEncryptionContentEncryptionAlgorithm"}),children:e(K,{name:P("attributes.id.token.encrypted.response.enc"),defaultValue:"",control:J,render:({field:A})=>e(Y,{toggleId:"idTokenEncryptionContentEncryptionAlgorithm",variant:$.single,onToggle:C,isOpen:T,onSelect:(ue,Q)=>{A.onChange(Q),C(!1)},selections:A.value,children:Fe})})}),e(v,{label:t("userInfoSignedResponseAlgorithm"),fieldId:"userInfoSignedResponseAlgorithm",labelIcon:e(k,{helpText:t("userInfoSignedResponseAlgorithmHelp"),fieldLabelId:"userInfoSignedResponseAlgorithm"}),children:e(K,{name:P("attributes.user.info.response.signature.alg"),defaultValue:"",control:J,render:({field:A})=>e(Y,{toggleId:"userInfoSignedResponseAlgorithm",variant:$.single,onToggle:V,isOpen:b,onSelect:(ue,Q)=>{A.onChange(Q),V(!1)},selections:A.value,children:pt})})}),e(v,{label:t("userInfoResponseEncryptionKeyManagementAlgorithm"),fieldId:"userInfoResponseEncryptionKeyManagementAlgorithm",labelIcon:e(k,{helpText:t("userInfoResponseEncryptionKeyManagementAlgorithmHelp"),fieldLabelId:"userInfoResponseEncryptionKeyManagementAlgorithm"}),children:e(K,{name:P("attributes.user.info.encrypted.response.alg"),defaultValue:"",control:J,render:({field:A})=>e(Y,{toggleId:"userInfoResponseEncryptionKeyManagementAlgorithm",variant:$.single,onToggle:oe,isOpen:M,onSelect:(ue,Q)=>{A.onChange(Q),oe(!1)},selections:A.value,children:Ee})})}),e(v,{label:t("userInfoResponseEncryptionContentEncryptionAlgorithm"),fieldId:"userInfoResponseEncryptionContentEncryptionAlgorithm",labelIcon:e(k,{helpText:t("userInfoResponseEncryptionContentEncryptionAlgorithmHelp"),fieldLabelId:"userInfoResponseEncryptionContentEncryptionAlgorithm"}),children:e(K,{name:P("attributes.user.info.encrypted.response.enc"),defaultValue:"",control:J,render:({field:A})=>e(Y,{toggleId:"userInfoResponseEncryptionContentEncryptionAlgorithm",variant:$.single,onToggle:ne,isOpen:Ie,onSelect:(ue,Q)=>{A.onChange(Q),ne(!1)},selections:A.value,children:Fe})})}),e(v,{label:t("requestObjectSignatureAlgorithm"),fieldId:"requestObjectSignatureAlgorithm",labelIcon:e(k,{helpText:t("requestObjectSignatureAlgorithmHelp"),fieldLabelId:"requestObjectSignatureAlgorithm"}),children:e(K,{name:P("attributes.request.object.signature.alg"),defaultValue:"",control:J,render:({field:A})=>e(Y,{toggleId:"requestObjectSignatureAlgorithm",variant:$.single,onToggle:X,isOpen:G,onSelect:(ue,Q)=>{A.onChange(Q),X(!1)},selections:A.value,children:ht})})}),e(v,{label:t("requestObjectEncryption"),fieldId:"requestObjectEncryption",labelIcon:e(k,{helpText:t("requestObjectEncryptionHelp"),fieldLabelId:"requestObjectEncryption"}),children:e(K,{name:P("attributes.request.object.encryption.alg"),defaultValue:"",control:J,render:({field:A})=>e(Y,{toggleId:"requestObjectEncryption",variant:$.single,onToggle:_,isOpen:W,onSelect:(ue,Q)=>{A.onChange(Q),_(!1)},selections:A.value,children:mt})})}),e(v,{label:t("requestObjectEncoding"),fieldId:"requestObjectEncoding",labelIcon:e(k,{helpText:t("requestObjectEncodingHelp"),fieldLabelId:"requestObjectEncoding"}),children:e(K,{name:P("attributes.request.object.encryption.enc"),defaultValue:"",control:J,render:({field:A})=>e(Y,{toggleId:"requestObjectEncoding",variant:$.single,onToggle:S,isOpen:R,onSelect:(ue,Q)=>{A.onChange(Q),S(!1)},selections:A.value,children:Ye})})}),e(v,{label:t("requestObjectRequired"),fieldId:"requestObjectRequired",labelIcon:e(k,{helpText:t("requestObjectRequiredHelp"),fieldLabelId:"requestObjectRequired"}),children:e(K,{name:P("attributes.request.object.required"),defaultValue:"",control:J,render:({field:A})=>e(Y,{toggleId:"requestObjectRequired",variant:$.single,onToggle:O,isOpen:x,onSelect:(ue,Q)=>{A.onChange(Q),O(!1)},selections:A.value,children:he})})}),e(v,{label:t("validRequestURIs"),fieldId:"validRequestURIs",labelIcon:e(k,{helpText:t("validRequestURIsHelp"),fieldLabelId:"validRequestURIs"}),children:e(Gn,{name:P("attributes.request.uris"),"aria-label":t("validRequestURIs"),addButtonLabel:"addRequestUri",stringify:!0})}),e(v,{label:t("authorizationSignedResponseAlg"),fieldId:"authorizationSignedResponseAlg",labelIcon:e(k,{helpText:t("authorizationSignedResponseAlgHelp"),fieldLabelId:"authorizationSignedResponseAlg"}),children:e(K,{name:P("attributes.authorization.signed.response.alg"),defaultValue:"",control:J,render:({field:A})=>e(Y,{toggleId:"authorizationSignedResponseAlg",variant:$.single,onToggle:B,isOpen:I,onSelect:(ue,Q)=>{A.onChange(Q),B(!1)},selections:A.value,children:Xe})})}),e(v,{label:t("authorizationEncryptedResponseAlg"),fieldId:"authorizationEncryptedResponseAlg",labelIcon:e(k,{helpText:t("authorizationEncryptedResponseAlgHelp"),fieldLabelId:"authorizationEncryptedResponseAlg"}),children:e(K,{name:P("attributes.authorization.encrypted.response.alg"),defaultValue:"",control:J,render:({field:A})=>e(Y,{toggleId:"authorizationEncryptedResponseAlg",variant:$.single,onToggle:N,isOpen:D,onSelect:(ue,Q)=>{A.onChange(Q),N(!1)},selections:A.value,children:Ee})})}),e(v,{label:t("authorizationEncryptedResponseEnc"),fieldId:"authorizationEncryptedResponseEnc",labelIcon:e(k,{helpText:t("authorizationEncryptedResponseEncHelp"),fieldLabelId:"authorizationEncryptedResponseEnc"}),children:e(K,{name:P("attributes.authorization.encrypted.response.enc"),defaultValue:"",control:J,render:({field:A})=>e(Y,{toggleId:"authorizationEncryptedResponseEnc",variant:$.single,onToggle:H,isOpen:q,onSelect:(ue,Q)=>{A.onChange(Q),H(!1)},selections:A.value,children:Fe})})}),o(xe,{children:[e(L,{variant:"secondary",id:"fineGrainSave",onClick:n,children:t("save")}),e(L,{id:"fineGrainRevert",variant:"link",onClick:a,children:t("revert")})]})]})},Li=({save:n,reset:a})=>{const{t:s}=w();return o(pe,{role:"manage-realm",isHorizontal:!0,children:[e(la,{}),e(Oe,{name:"attributes.saml_assertion_consumer_url_post",label:s("assertionConsumerServicePostBindingURL"),labelIcon:s("assertionConsumerServicePostBindingURLHelp"),type:"url"}),e(Oe,{name:"attributes.saml_assertion_consumer_url_redirect",label:s("assertionConsumerServiceRedirectBindingURL"),labelIcon:s("assertionConsumerServiceRedirectBindingURLHelp"),type:"url"}),e(Oe,{name:"attributes.saml_single_logout_service_url_post",label:s("logoutServicePostBindingURL"),labelIcon:s("logoutServicePostBindingURLHelp"),type:"url"}),e(Oe,{name:"attributes.saml_single_logout_service_url_redirect",label:s("logoutServiceRedirectBindingURL"),labelIcon:s("logoutServiceRedirectBindingURLHelp"),type:"url"}),e(Oe,{name:"attributes.saml_single_logout_service_url_soap",label:s("logoutServiceSoapBindingUrl"),labelIcon:s("logoutServiceSoapBindingUrlHelp"),type:"url"}),e(Oe,{name:"attributes.saml_single_logout_service_url_artifact",label:s("logoutServiceArtifactBindingUrl"),labelIcon:s("logoutServiceArtifactBindingUrlHelp"),type:"url"}),e(Oe,{name:"attributes.saml_artifact_binding_url",label:s("artifactBindingUrl"),labelIcon:s("artifactBindingUrlHelp"),type:"url"}),e(Oe,{name:"attributes.saml_artifact_resolution_service_url",label:s("artifactResolutionService"),labelIcon:s("artifactResolutionServiceHelp"),type:"url"}),o(xe,{children:[e(L,{variant:"tertiary",onClick:n,"data-testid":"fineGrainSave",children:s("save")}),e(L,{variant:"link",onClick:a,"data-testid":"fineGrainRevert",children:s("revert")})]})]})},Di=({save:n,reset:a,hasConfigureAccess:s})=>{const{t}=w(),{control:i}=ee();return o(pe,{role:"manage-clients",fineGrainedAccess:s,isHorizontal:!0,children:[e(v,{label:t("excludeSessionStateFromAuthenticationResponse"),fieldId:"excludeSessionStateFromAuthenticationResponse",hasNoPaddingTop:!0,labelIcon:e(k,{helpText:t("excludeSessionStateFromAuthenticationResponseHelp"),fieldLabelId:"excludeSessionStateFromAuthenticationResponse"}),children:e(K,{name:P("attributes.exclude.session.state.from.auth.response"),defaultValue:"",control:i,render:({field:l})=>e(ce,{id:"excludeSessionStateFromAuthenticationResponse-switch",label:t("on"),labelOff:t("off"),isChecked:l.value==="true",onChange:r=>l.onChange(r.toString()),"aria-label":t("excludeSessionStateFromAuthenticationResponse")})})}),e(v,{label:t("excludeIssuerFromAuthenticationResponse"),fieldId:"excludeIssuerFromAuthenticationResponse",hasNoPaddingTop:!0,labelIcon:e(k,{helpText:t("excludeIssuerFromAuthenticationResponseHelp"),fieldLabelId:"excludeIssuerFromAuthenticationResponse"}),children:e(K,{name:P("attributes.exclude.issuer.from.auth.response"),defaultValue:"",control:i,render:({field:l})=>e(ce,{id:"excludeIssuerFromAuthenticationResponse-switch",label:t("on"),labelOff:t("off"),isChecked:l.value==="true",onChange:r=>l.onChange(r.toString()),"aria-label":t("excludeIssuerFromAuthenticationResponse")})})}),e(v,{label:t("useRefreshTokens"),fieldId:"useRefreshTokens",hasNoPaddingTop:!0,labelIcon:e(k,{helpText:t("useRefreshTokensHelp"),fieldLabelId:"useRefreshTokens"}),children:e(K,{name:P("attributes.use.refresh.tokens"),defaultValue:"true",control:i,render:({field:l})=>e(ce,{id:"useRefreshTokens",label:t("on"),labelOff:t("off"),isChecked:l.value==="true",onChange:r=>l.onChange(r.toString()),"aria-label":t("useRefreshTokens")})})}),e(v,{label:t("useRefreshTokenForClientCredentialsGrant"),fieldId:"useRefreshTokenForClientCredentialsGrant",hasNoPaddingTop:!0,labelIcon:e(k,{helpText:t("useRefreshTokenForClientCredentialsGrantHelp"),fieldLabelId:"useRefreshTokenForClientCredentialsGrant"}),children:e(K,{name:P("attributes.client_credentials.use_refresh_token"),defaultValue:"false",control:i,render:({field:l})=>e(ce,{id:"useRefreshTokenForClientCredentialsGrant",label:t("on"),labelOff:t("off"),isChecked:l.value==="true",onChange:r=>l.onChange(r.toString()),"aria-label":t("useRefreshTokenForClientCredentialsGrant")})})}),e(v,{label:t("useLowerCaseBearerType"),fieldId:"useLowerCaseBearerType",hasNoPaddingTop:!0,labelIcon:e(k,{helpText:t("useLowerCaseBearerTypeHelp"),fieldLabelId:"useLowerCaseBearerType"}),children:e(K,{name:P("attributes.token.response.type.bearer.lower-case"),defaultValue:"false",control:i,render:({field:l})=>e(ce,{id:"useLowerCaseBearerType",label:t("on"),labelOff:t("off"),isChecked:l.value==="true",onChange:r=>l.onChange(r.toString()),"aria-label":t("useLowerCaseBearerType")})})}),o(xe,{children:[e(L,{variant:"secondary",onClick:n,"data-testid":"OIDCCompatabilitySave",children:t("save")}),e(L,{variant:"link",onClick:a,"data-testid":"OIDCCompatabilityRevert",children:t("revert")})]})]})},Ni=({save:n,client:{id:a,adminUrl:s,access:t}})=>{const i="notBefore",l=Ze(),{t:r}=w(),{realm:u}=ge(),{addAlert:c}=de(),h=en(),{getValues:f,setValue:g,register:d}=ee(),m=(C,b)=>{g(i,C),n({messageKey:b})};Ke(()=>{d(i)},[d]);const y=()=>{const C=f(i);return C>0?h(new Date(C*1e3),Wn):r("none")},T=async()=>{const C=await E.clients.pushRevocation({id:a});ra(C,"notBeforePush",c,r)};return o(U,{children:[e(be,{className:"pf-u-pb-lg",children:o(Qn,{i18nKey:"notBeforeIntro",children:["In order to successfully push setup url on",e(ye,{to:Kn({realm:u,clientId:a,tab:"settings"}),children:r("settings")}),"tab"]})}),o(pe,{role:"manage-clients",fineGrainedAccess:t?.configure,isHorizontal:!0,children:[e(v,{label:r("notBefore"),fieldId:"kc-not-before",labelIcon:e(k,{helpText:r("notBeforeHelp"),fieldLabelId:"notBefore"}),children:o($t,{children:[e(me,{type:"text",id:"kc-not-before",name:"notBefore",isReadOnly:!0,value:y()}),e(L,{id:"setToNow",variant:"control",onClick:()=>{m(Date.now()/1e3,"notBeforeSetToNow")},children:r("setToNow")}),e(L,{id:"clear",variant:"control",onClick:()=>{m(0,"notBeforeNowClear")},children:r("clear")})]})}),o(xe,{children:[!s&&e(Wt,{reference:l,content:r("notBeforeTooltip")}),e(L,{id:"push",variant:"secondary",onClick:T,isAriaDisabled:!s,ref:l,children:r("push")})]})]})]})},ra=(n,a,s,t)=>{const i=n.successRequests?.length||0,l=n.failedRequests?.length||0;i===0&&l===0?s(t("noAdminUrlSet"),Z.warning):l>0?(s(t(a+"Success",{successNodes:n.successRequests}),Z.success),s(t(a+"Fail",{failedNodes:n.failedRequests}),Z.danger)):s(t(a+"Success",{successNodes:n.successRequests}),Z.success)},Ki=({save:n,client:a})=>{const{t:s}=w(),t="openid-connect",{setValue:i}=ee(),{publicClient:l,attributes:r,protocol:u,authenticationFlowBindingOverrides:c}=a,h=f=>{for(const g of f)i(P(`attributes.${g}`),r?.[g]||"")};return e(fe,{variant:"light",className:"pf-u-py-0",children:e(Hn,{label:s("jumpToSection"),sections:[{title:s("revocation"),isHidden:u!==t,panel:e(Ni,{client:a,save:n})},{title:s("clustering"),isHidden:!l,panel:e(Pi,{client:a,save:n})},{title:s("fineGrainOpenIdConnectConfiguration"),isHidden:u!==t,panel:o(U,{children:[e(be,{className:"pf-u-pb-lg",children:s("fineGrainOpenIdConnectConfigurationHelp")}),e(_i,{save:n,reset:()=>{h(["logoUri","policyUri","tosUri","access.token.signed.response.alg","id.token.signed.response.alg","id.token.encrypted.response.alg","id.token.encrypted.response.enc","user.info.response.signature.alg","user.info.encrypted.response.alg","user.info.encrypted.response.enc","request.object.signature.alg","request.object.encryption.alg","request.object.encryption.enc","request.object.required","request.uris","authorization.signed.response.alg","authorization.encrypted.response.alg","authorization.encrypted.response.enc"])}})]})},{title:s("openIdConnectCompatibilityModes"),isHidden:u!==t,panel:o(U,{children:[e(be,{className:"pf-u-pb-lg",children:s("openIdConnectCompatibilityModesHelp")}),e(Di,{save:()=>n(),reset:()=>h(["exclude.session.state.from.auth.response","use.refresh.tokens","client_credentials.use_refresh_token","token.response.type.bearer.lower-case"])})]})},{title:s("fineGrainSamlEndpointConfig"),isHidden:u===t,panel:o(U,{children:[e(be,{className:"pf-u-pb-lg",children:s("fineGrainSamlEndpointConfigHelp")}),e(Li,{save:()=>n(),reset:()=>h(["logoUri","policyUri","tosUri","saml_assertion_consumer_url_post","saml_assertion_consumer_url_redirect","saml_single_logout_service_url_post","saml_single_logout_service_url_redirect","saml_single_logout_service_url_artifact","saml_artifact_binding_url","saml_artifact_resolution_service_url"])})]})},{title:s("advancedSettings"),panel:o(U,{children:[e(be,{className:"pf-u-pb-lg",children:s("advancedSettings"+Ot(u||""))}),e(xi,{protocol:u,save:()=>n(),reset:()=>{h(["saml.assertion.lifespan","access.token.lifespan","tls.client.certificate.bound.access.tokens","pkce.code.challenge.method"])}})]})},{title:s("authenticationOverrides"),panel:o(U,{children:[e(be,{className:"pf-u-pb-lg",children:s("authenticationOverridesHelp")}),e(Ei,{protocol:u,save:()=>n(),reset:()=>{i("authenticationFlowBindingOverrides.browser",c?.browser),i("authenticationFlowBindingOverrides.direct_grant",c?.direct_grant)}})]})}],borders:!0})})},Hi=({client:n})=>{const{t:a}=w();return e(fe,{variant:"light",className:"pf-u-p-0",children:e(Qa,{loader:async(t,i)=>{const l=u=>c=>c.map(h=>({type:u,...h}));return(await Promise.all([E.clients.listSessions({id:n.id,first:t,max:i}).then(l(a("sessionsType.regularSSO"))),E.clients.listOfflineSessions({id:n.id,first:t,max:i}).then(l(a("sessionsType.offline")))])).flat()},hiddenColumns:["clients"],emptyInstructions:a("noSessionsForClient")})})},Fi=({client:n,save:a,reset:s})=>{const{t}=w(),{register:i,watch:l}=ee(),{hasAccess:r}=De(),u=r("manage-clients")||n.access?.configure,c=l("protocol");return o(pe,{isHorizontal:!0,fineGrainedAccess:n.access?.configure,role:"manage-clients",children:[!n.bearerOnly&&e(Za,{protocol:c}),c!=="saml"&&e(v,{label:t("adminURL"),fieldId:"kc-admin-url",labelIcon:e(k,{helpText:t("adminURLHelp"),fieldLabelId:"adminURL"}),children:e(me,{id:"kc-admin-url",type:"url",...i("adminUrl")})}),n.bearerOnly&&e(Lt,{name:"settings",save:a,reset:s,isActive:!u})]})},Mi=({access:n})=>{const{t:a}=w(),{register:s,control:t,watch:i}=ee(),[l,r]=p(!1),u=Ge().themes.login,c=i("consentRequired"),h=i(P("attributes.display.on.consent.screen"));return o(pe,{isHorizontal:!0,fineGrainedAccess:n,role:"manage-clients",children:[e(v,{label:a("loginTheme"),labelIcon:e(k,{helpText:a("loginThemeHelp"),fieldLabelId:"loginTheme"}),fieldId:"loginTheme",children:e(K,{name:"attributes.login_theme",defaultValue:"",control:t,render:({field:f})=>e(Y,{toggleId:"loginTheme",onToggle:r,onSelect:(g,d)=>{f.onChange(d.toString()),r(!1)},selections:f.value||a("choose"),variant:$.single,"aria-label":a("loginTheme"),isOpen:l,children:[e(z,{value:"",children:a("choose")},"empty"),...u.map(g=>e(z,{selected:g.name===f.value,value:g.name},g.name))]})})}),e(v,{label:a("consentRequired"),labelIcon:e(k,{helpText:a("consentRequiredHelp"),fieldLabelId:"consentRequired"}),fieldId:"kc-consent",hasNoPaddingTop:!0,children:e(K,{name:"consentRequired",defaultValue:!1,control:t,render:({field:f})=>e(ce,{id:"kc-consent-switch",label:a("on"),labelOff:a("off"),isChecked:f.value,onChange:f.onChange,"aria-label":a("consentRequired")})})}),e(v,{label:a("displayOnClient"),labelIcon:e(k,{helpText:a("displayOnClientHelp"),fieldLabelId:"displayOnClient"}),fieldId:"kc-display-on-client",hasNoPaddingTop:!0,children:e(K,{name:P("attributes.display.on.consent.screen"),defaultValue:!1,control:t,render:({field:f})=>e(ce,{id:"kc-display-on-client-switch",label:a("on"),labelOff:a("off"),isChecked:f.value==="true",onChange:g=>f.onChange(""+g),isDisabled:!c,"aria-label":a("displayOnClient")})})}),e(v,{label:a("consentScreenText"),labelIcon:e(k,{helpText:a("consentScreenTextHelp"),fieldLabelId:"consentScreenText"}),fieldId:"kc-consent-screen-text",children:e(ct,{id:"kc-consent-screen-text",...s(P("attributes.consent.screen.text")),isDisabled:!(c&&h==="true")})})]})},In=(n,a)=>(n?.startsWith("https://")||n?.startsWith("http://"))&&!n.includes("*")||n===""||a,Vi=({save:n,reset:a,client:{access:s}})=>{const{t}=w(),{register:i,control:l,watch:r,formState:{errors:u}}=ee(),{hasAccess:c}=De(),h=c("manage-clients")||s?.configure,f=r("protocol"),g=r("frontchannelLogout");return o(pe,{isHorizontal:!0,fineGrainedAccess:s?.configure,role:"manage-clients",children:[e(v,{label:t("frontchannelLogout"),labelIcon:e(k,{helpText:t("frontchannelLogoutHelp"),fieldLabelId:"frontchannelLogout"}),fieldId:"kc-frontchannelLogout",hasNoPaddingTop:!0,children:e(K,{name:"frontchannelLogout",defaultValue:!0,control:l,render:({field:d})=>e(ce,{id:"kc-frontchannelLogout-switch",label:t("on"),labelOff:t("off"),isChecked:d.value,onChange:d.onChange,"aria-label":t("frontchannelLogout")})})}),f==="openid-connect"&&g&&e(v,{label:t("frontchannelLogoutUrl"),fieldId:"frontchannelLogoutUrl",labelIcon:e(k,{helpText:t("frontchannelLogoutUrlHelp"),fieldLabelId:"frontchannelLogoutUrl"}),helperTextInvalid:u.attributes?.[Ve("frontchannel.logout.url")]?.message,validated:u.attributes?.[Ve("frontchannel.logout.url")]?.message?ke.error:ke.default,children:e(me,{id:"frontchannelLogoutUrl",type:"url",...i(P("attributes.frontchannel.logout.url"),{validate:d=>In(d,t("frontchannelUrlInvalid").toString())}),validated:u.attributes?.[Ve("frontchannel.logout.url")]?.message?ke.error:ke.default})}),f==="openid-connect"&&o(U,{children:[e(v,{label:t("backchannelLogoutUrl"),fieldId:"backchannelLogoutUrl",labelIcon:e(k,{helpText:t("backchannelLogoutUrlHelp"),fieldLabelId:"backchannelLogoutUrl"}),helperTextInvalid:u.attributes?.[Ve("backchannel.logout.url")]?.message,validated:u.attributes?.[Ve("backchannel.logout.url")]?.message?ke.error:ke.default,children:e(me,{id:"backchannelLogoutUrl",type:"url",...i(P("attributes.backchannel.logout.url"),{validate:d=>In(d,t("backchannelUrlInvalid").toString())}),validated:u.attributes?.[Ve("backchannel.logout.url")]?.message?ke.error:ke.default})}),e(v,{label:t("backchannelLogoutSessionRequired"),labelIcon:e(k,{helpText:t("backchannelLogoutSessionRequiredHelp"),fieldLabelId:"backchannelLogoutSessionRequired"}),fieldId:"backchannelLogoutSessionRequired",hasNoPaddingTop:!0,children:e(K,{name:P("attributes.backchannel.logout.session.required"),defaultValue:"true",control:l,render:({field:d})=>e(ce,{id:"backchannelLogoutSessionRequired",label:t("on"),labelOff:t("off"),isChecked:d.value==="true",onChange:m=>d.onChange(m.toString()),"aria-label":t("backchannelLogoutSessionRequired")})})}),e(v,{label:t("backchannelLogoutRevokeOfflineSessions"),labelIcon:e(k,{helpText:t("backchannelLogoutRevokeOfflineSessionsHelp"),fieldLabelId:"backchannelLogoutRevokeOfflineSessions"}),fieldId:"backchannelLogoutRevokeOfflineSessions",hasNoPaddingTop:!0,children:e(K,{name:P("attributes.backchannel.logout.revoke.offline.tokens"),defaultValue:"false",control:l,render:({field:d})=>e(ce,{id:"backchannelLogoutRevokeOfflineSessions",label:t("on"),labelOff:t("off"),isChecked:d.value==="true",onChange:m=>d.onChange(m.toString()),"aria-label":t("backchannelLogoutRevokeOfflineSessions")})})})]}),e(Lt,{name:"settings",save:n,reset:a,isActive:h})]})},Ne=({name:n,label:a})=>{const{t:s}=w(),{control:t}=ee();return e(v,{hasNoPaddingTop:!0,label:s(a),fieldId:a,labelIcon:e(k,{helpText:s(`${a}Help`),fieldLabelId:a}),children:e(K,{name:n,defaultValue:"false",control:t,render:({field:i})=>e(ce,{id:n,"data-testid":a,label:s("on"),labelOff:s("off"),isChecked:i.value==="true",onChange:l=>i.onChange(l.toString()),"aria-label":s(a)})})})},zi=()=>{const{t:n}=w(),{control:a}=ee(),[s,t]=p(!1);return o(pe,{isHorizontal:!0,role:"manage-clients",className:"keycloak__capability-config__form",children:[e(v,{label:n("nameIdFormat"),fieldId:"nameIdFormat",labelIcon:e(k,{helpText:n("nameIdFormatHelp"),fieldLabelId:"nameIdFormat"}),children:e(K,{name:"attributes.saml_name_id_format",defaultValue:"username",control:a,render:({field:i})=>e(Y,{toggleId:"samlNameIdFormat",onToggle:t,onSelect:(l,r)=>{i.onChange(r.toString()),t(!1)},selections:i.value,variant:$.single,"aria-label":n("nameIdFormat"),isOpen:s,children:["username","email","transient","persistent"].map(l=>e(z,{selected:l===i.value,value:l},l))})})}),e(Ne,{name:"attributes.saml_force_name_id_format",label:"forceNameIdFormat"}),e(Ne,{name:P("attributes.saml.force.post.binding"),label:"forcePostBinding"}),e(Ne,{name:P("attributes.saml.artifact.binding"),label:"forceArtifactBinding"}),e(Ne,{name:P("attributes.saml.authnstatement"),label:"includeAuthnStatement"}),e(Ne,{name:P("attributes.saml.onetimeuse.condition"),label:"includeOneTimeUseCondition"}),e(Ne,{name:P("attributes.saml.server.signature.keyinfo.ext"),label:"optimizeLookup"}),e(Ne,{name:P("attributes.saml.allow.ecp.flow"),label:"allowEcpFlow"})]})},kn=["RSA_SHA1","RSA_SHA256","RSA_SHA256_MGF1","RSA_SHA512","RSA_SHA512_MGF1","DSA_SHA1"],An=["NONE","KEY_ID","CERT_SUBJECT"],Ft=[{name:"EXCLUSIVE",value:"http://www.w3.org/2001/10/xml-exc-c14n#"},{name:"EXCLUSIVE_WITH_COMMENTS",value:"http://www.w3.org/2001/10/xml-exc-c14n#WithComments"},{name:"INCLUSIVE",value:"http://www.w3.org/TR/2001/REC-xml-c14n-20010315"},{name:"INCLUSIVE_WITH_COMMENTS",value:"http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments"}],qi=()=>{const{t:n}=w(),[a,s]=p(!1),[t,i]=p(!1),[l,r]=p(!1),{control:u,watch:c}=ee(),h=c(P("attributes.saml.server.signature")),f=c(P("attributes.saml.assertion.signature"));return o(pe,{isHorizontal:!0,role:"manage-clients",className:"keycloak__capability-config__form",children:[e(Ne,{name:P("attributes.saml.server.signature"),label:"signDocuments"}),e(Ne,{name:P("attributes.saml.assertion.signature"),label:"signAssertions"}),(h==="true"||f==="true")&&o(U,{children:[e(v,{label:n("signatureAlgorithm"),fieldId:"signatureAlgorithm",labelIcon:e(k,{helpText:n("signatureAlgorithmHelp"),fieldLabelId:"signatureAlgorithm"}),children:e(K,{name:P("attributes.saml.signature.algorithm"),defaultValue:kn[0],control:u,render:({field:g})=>e(Y,{toggleId:"signatureAlgorithm",onToggle:s,onSelect:(d,m)=>{g.onChange(m.toString()),s(!1)},selections:g.value,variant:$.single,"aria-label":n("signatureAlgorithm"),isOpen:a,children:kn.map(d=>e(z,{selected:d===g.value,value:d},d))})})}),e(v,{label:n("signatureKeyName"),fieldId:"signatureKeyName",labelIcon:e(k,{helpText:n("signatureKeyNameHelp"),fieldLabelId:"signatureKeyName"}),children:e(K,{name:P("attributes.saml.server.signature.keyinfo.xmlSigKeyInfoKeyNameTransformer"),defaultValue:An[0],control:u,render:({field:g})=>e(Y,{toggleId:"signatureKeyName",onToggle:i,onSelect:(d,m)=>{g.onChange(m.toString()),i(!1)},selections:g.value,variant:$.single,"aria-label":n("signatureKeyName"),isOpen:t,children:An.map(d=>e(z,{selected:d===g.value,value:d},d))})})}),e(v,{label:n("canonicalization"),fieldId:"canonicalization",labelIcon:e(k,{helpText:n("canonicalizationHelp"),fieldLabelId:"canonicalization"}),children:e(K,{name:"attributes.saml_signature_canonicalization_method",defaultValue:Ft[0].value,control:u,render:({field:g})=>e(Y,{toggleId:"canonicalization",onToggle:r,onSelect:(d,m)=>{g.onChange(m.toString()),r(!1)},selections:Ft.find(d=>d.value===g.value)?.name,variant:$.single,"aria-label":n("canonicalization"),isOpen:l,children:Ft.map(d=>e(z,{selected:d.value===g.value,value:d.value,children:d.name},d.name))})})})]})]})},Bi=n=>{const{t:a}=w(),{watch:s}=ee(),t=s("protocol"),{client:i}=n;return e(Hn,{label:a("jumpToSection"),className:"pf-u-px-lg pf-u-pb-lg",sections:[{title:a("generalSettings"),panel:e(Te,{isHorizontal:!0,children:e(Ya,{protocol:i.protocol,hasConfigureAccess:i.access?.configure})})},{title:a("accessSettings"),panel:e(Fi,{...n})},{title:a("samlCapabilityConfig"),isHidden:t!=="saml"||i.bearerOnly,panel:e(zi,{})},{title:a("signatureAndEncryption"),isHidden:t!=="saml"||i.bearerOnly,panel:e(qi,{})},{title:a("capabilityConfig"),isHidden:t!=="openid-connect"||i.bearerOnly,panel:e(Xa,{})},{title:a("loginSettings"),isHidden:i.bearerOnly,panel:e(Mi,{access:i.access?.configure})},{title:a("logoutSettings"),isHidden:i.bearerOnly,panel:e(Vi,{...n})}]})},Ui=({name:n,rowIndex:a,attribute:s,selectableValues:t,resources:i})=>{const{t:l}=w(),{control:r,register:u,getValues:c}=ee(),[h,f]=p([!1]),g=(T,C)=>{const b=[...h];b[T]=C,f(b)},d=Tt(()=>{let T=[];return t&&(T=Xn.find(C=>C.key===c().context?.[a]?.key)?.values),T},[c]),m=()=>{const T=i?.find(C=>C.name===c().resources?.[a]?.key)?.scopes;if(d?.length&&!i)return d.map(C=>e(z,{value:C.key,children:C.name},C.key));if(T?.length)return T.map(C=>e(z,{value:C.name,children:C.name},C.name))},y=T=>ii(T).replace(/\W/g,"");return e(F,{children:i||d?.length?e(K,{name:`${n}.${a}.value`,defaultValue:[],control:r,render:({field:T})=>e(Y,{toggleId:`${s.id}-value`,className:"kc-attribute-value-selectable",name:`${n}.${a}.value`,chipGroupProps:{numChips:1,expandedText:l("hide"),collapsedText:l("showRemaining")},onToggle:C=>g(a,C),isOpen:h[a],variant:$.typeahead,typeAheadAriaLabel:l("selectOrTypeAKey"),placeholderText:l("selectOrTypeAKey"),selections:T.value,onSelect:(C,b)=>{T.onChange(b),g(a,!1)},children:m()})}):e(me,{id:`${y(s.key)}-value`,className:"value-input",defaultValue:s.value,"data-testid":"attribute-value-input","aria-label":l("value"),...u(`${n}.${a}.value`)})})},Rn=({name:n,selectableValues:a,resources:s})=>{const{t}=w(),{control:i,watch:l}=ee(),{fields:r,append:u,remove:c}=va({control:i,name:n}),[h,f]=p([!1]),g=(m,y)=>{const T=[...h];T[m]=y,f(T)};Ke(()=>{r.length||u({key:"",value:""},{shouldFocus:!1})},[r]);const d=l(`${n}.${r.length-1}.value`,"");return o(We,{className:"kc-attributes__table","aria-label":"Role attribute keys and values",variant:"compact",children:[e(Je,{children:o(re,{children:[e(j,{width:40,children:t("key")}),e(j,{width:40,children:t("value")})]})}),o(Qe,{children:[r.map((m,y)=>o(re,{"data-testid":"attribute-row",children:[e(F,{children:e(K,{name:`${n}.${y}.key`,defaultValue:"",control:i,render:({field:T})=>e(Y,{toggleId:`${n}.${y}.key`,className:"kc-attribute-key-selectable",name:`${n}.${y}.key`,onToggle:C=>g(y,C),isOpen:h[y],variant:$.typeahead,typeAheadAriaLabel:t("selectOrTypeAKey"),placeholderText:t("selectOrTypeAKey"),selections:T.value,onSelect:(C,b)=>{T.onChange(b.toString()),g(y,!1)},children:a?.map(C=>e(z,{selected:C.name===T.value,value:s?C.name:C.key,children:C.name},C.key))})})}),e(Ui,{name:n,attribute:m,rowIndex:y,selectableValues:a,resources:s}),e(F,{children:e(L,{id:`${n}-minus-button-${y}`,variant:"link",className:"kc-attributes__minus-icon",onClick:()=>c(y),"aria-label":t("remove"),children:e(Sa,{})})})]},m.id)),e(re,{children:e(F,{children:e(L,{"aria-label":t("addAttribute"),id:`${n}-plus-icon`,variant:"link",className:"kc-attributes__plus-icon",onClick:()=>{u({key:"",value:""}),f([...h,!1])},icon:e(Fn,{}),isDisabled:!d,"data-testid":"attribute-add-row",children:t("addAttribute")})})})]})]})},ji=({data:n})=>{const{t:a}=w(),[s,t]=Ce();return o(U,{children:[e(L,{"data-testid":"authorization-revert",onClick:t,variant:"secondary",children:a("showAuthData")}),e($e,{variant:kt.medium,isOpen:s,"aria-label":a("authData"),header:o(Be,{children:[e(be,{component:Ta.h1,children:a("authData")}),e(be,{children:a("authDataDescription")})]}),onClose:t,actions:[e(L,{"data-testid":"cancel",id:"modal-cancel",onClick:t,children:a("cancel")},"cancel")],children:e(ct,{readOnly:!0,rows:20,value:et(n)})})]})},Gi=({idx:n,rowIndex:a,outerPolicy:s,resource:t})=>{const[i,l]=p(!1),{t:r}=w(),{realm:u}=ge(),{clientId:c}=Xt();return o(Qe,{isExpanded:i,children:[o(re,{children:[e(F,{expand:{rowIndex:a,isExpanded:i,onToggle:()=>l(h=>!h)}}),e(F,{"data-testid":`name-column-${t.resource}`,children:e(ye,{to:It({realm:u,id:c,permissionType:s.policy?.type,permissionId:s.policy?.id}),children:s.policy?.name})}),e(F,{id:s.status?.toLowerCase(),children:r(s.status?.toLowerCase())}),e(F,{children:r(`${s.policy?.decisionStrategy?.toLowerCase()}`)}),e(F,{children:s.status===mn.Permit?t.policies?.[a]?.scopes?.join(", "):"-"}),e(F,{children:s.status===mn.Deny&&t.policies?.[a]?.scopes?.length?t.policies[a].scopes?.join(", "):"-"})]}),o(re,{isExpanded:i,children:[e(F,{}),e(F,{colSpan:5,children:i&&e(dt,{children:e(ut,{isHorizontal:!0,className:"keycloak_resource_details",children:e(Be,{children:e(ia,{children:s.associatedPolicies?.map(h=>o(sa,{children:[e(ye,{to:Jt({realm:u,id:c,policyType:h.policy?.type,policyId:h.policy?.id}),children:h.policy?.name}),r("votedToStatus",{status:Ca(h.status)})]},"policyDetails"))})})})})})]},`child-${t.resource}`)]},n)},$i=({rowIndex:n,resource:a,evaluateResults:s})=>{const[t,i]=p(!1),{t:l}=w();return o(Qe,{isExpanded:t,children:[o(re,{children:[e(F,{expand:{rowIndex:n,isExpanded:t,onToggle:()=>i(r=>!r)}}),e(F,{"data-testid":`name-column-${a.resource}`,children:a.resource?.name}),e(F,{id:a.status?.toLowerCase(),children:l(`${a.status?.toLowerCase()}`)}),e(F,{children:a.allowedScopes?.length?a.allowedScopes.map(r=>r.name):"-"})]}),o(re,{isExpanded:t,children:[e(F,{}),e(F,{colSpan:5,children:e(dt,{children:t&&e(ut,{isHorizontal:!0,className:"keycloak_resource_details",children:o(We,{"aria-label":l("evaluationResults"),children:[e(Je,{children:o(re,{children:[e(j,{"aria-hidden":"true"}),e(j,{children:l("permission")}),e(j,{children:l("results")}),e(j,{children:l("decisionStrategy")}),e(j,{children:l("grantedScopes")}),e(j,{children:l("deniedScopes")}),e(j,{"aria-hidden":"true"})]})}),Object.values(s[n].policies).map((r,u)=>e(Gi,{idx:u,rowIndex:n,outerPolicy:r,resource:a},u))]})})})})]},`child-${a.resource}`)]})};function Wi(n,a){switch(a){case"STATUS_PERMITTED":return n.filter(({status:s})=>s==="PERMIT");case"STATUS_DENIED":return n.filter(({status:s})=>s==="DENY");default:return n}}const Ji=({evaluateResult:n,refresh:a,back:s})=>{const{t}=w(),[i,l]=Ce(),[r,u]=p("ALL"),[c,h]=p(""),[f,g]=p(""),d=()=>{h(f)},m=b=>{b.key==="Enter"&&d()},y=Tt(()=>Wi(n.results,r).filter(({resource:b})=>b?.name?.includes(c)??!1),[n.results,r,c]),T=n.results.length===0,C=y.length===0;return o(fe,{children:[e(Wa,{children:o(Ja,{className:"providers-toolbar",children:[e(ve,{children:o($t,{children:[e(Ia,{name:"inputGroupName",id:"inputGroupName",type:"search","aria-label":t("search"),placeholder:t("search"),onChange:g,onKeyDown:m}),e(L,{variant:Se.control,"aria-label":t("search"),onClick:()=>d(),children:e(ka,{})})]})}),e(ve,{children:o(Y,{width:300,"data-testid":"filter-type-select",isOpen:i,className:"kc-filter-type-select",variant:$.single,onToggle:l,onSelect:(b,V)=>{u(V),l(),a()},selections:r,children:[e(z,{"data-testid":"all-results-option",value:"ALL",isPlaceholder:!0,children:t("allResults")}),e(z,{"data-testid":"result-permit-option",value:"STATUS_PERMITTED",children:t("resultPermit")}),e(z,{"data-testid":"result-deny-option",value:"STATUS_DENIED",children:t("resultDeny")})]})})]})}),!C&&o(We,{"aria-label":t("evaluationResults"),children:[e(Je,{children:o(re,{children:[e(j,{"aria-hidden":"true"}),e(j,{children:t("resource")}),e(j,{children:t("overallResults")}),e(j,{children:t("scopes")}),e(j,{"aria-hidden":"true"})]})}),y.map((b,V)=>e($i,{rowIndex:V,resource:b,evaluateResults:n.results},V))]}),(C||T)&&o(U,{children:[e(Ue,{}),e(_e,{isSearchVariant:!0,message:t("noSearchResults"),instructions:t("noSearchResultsInstructions")})]}),e(Te,{children:o(Lt,{name:"authorization",children:[e(L,{"data-testid":"authorization-eval",id:"back-btn",onClick:s,children:t("back")})," ",e(L,{"data-testid":"authorization-reevaluate",id:"reevaluate-btn",variant:"secondary",onClick:a,children:t("reevaluate")})," ",e(ji,{data:n.rpt})]})})]})},Qi=n=>{const{hasAccess:a}=De();return a("view-users")?e(Yi,{...n}):e(Aa,{permissionNeeded:"view-users"})},Yi=({client:n})=>{const a=Le({mode:"onChange"}),{control:s,register:t,reset:i,trigger:l,formState:{isValid:r,errors:u}}=a,{t:c}=w(),{addError:h}=de(),f=ge(),[g,d]=p(!1),[m,y]=p(!1),[T,C]=p(!1),[b,V]=p(!1),[G,X]=p([]),[x,O]=p([]),[W,_]=p(),[R,S]=p([]);le(()=>E.roles.find(),N=>{S(N)},[]),le(()=>Promise.all([E.clients.listResources({id:n.id}),E.clients.listAllScopes({id:n.id})]),([N,q])=>{X(N),O(q)},[]);const I=async()=>{if(!await l())return;const N=a.getValues(),q=Ra(N.resources),H={roleIds:N.roleIds??[],clientId:N.client.id,userId:N.user[0],resources:G.filter(M=>Object.keys(q).includes(M.name)).map(M=>({...M,scopes:M.scopes?.filter(oe=>Object.values(q).flatMap(Ie=>Ie).includes(oe.name))})),entitlements:!1,context:{attributes:Object.fromEntries(N.context.attributes.filter(M=>M.key||M.value!=="").map(({key:M,value:oe})=>[M,oe]))}};try{const M=await E.clients.evaluateResource({id:n.id,realm:f.realm},H);_(M)}catch(M){h("evaluateError",M)}},B=it({control:s,name:"user",defaultValue:[]}),D=it({control:s,name:"roleIds",defaultValue:[]});return W?e(Ji,{evaluateResult:W,refresh:I,back:()=>_(void 0)}):e(fe,{children:o(He,{...a,children:[o(gn,{children:[e(Ut,{children:e(yt,{headingLevel:"h2",children:c("identityInformation")})}),e(fn,{children:o(pe,{isHorizontal:!0,role:"view-clients",children:[e(ei,{name:"client",label:"client",helpText:"clientHelp",defaultValue:n.clientId}),e(Yn,{name:"user",label:"users",helpText:c("selectUser"),defaultValue:[],variant:$.typeahead,isRequired:D?.length===0}),e(v,{label:c("roles"),labelIcon:e(k,{helpText:c("rolesHelp"),fieldLabelId:"roles"}),fieldId:"realmRole",validated:u.roleIds?"error":"default",helperTextInvalid:c("required"),isRequired:B.length===0,children:e(K,{name:"roleIds",control:s,defaultValue:[],rules:{validate:N=>(N||"").length>0||B.length>0},render:({field:N})=>e(Y,{placeholderText:c("selectARole"),variant:$.typeaheadMulti,toggleId:"role",onToggle:y,selections:N.value,onSelect:(q,H)=>{const M=H.toString();N.value?.includes(M)?N.onChange(N.value.filter(oe=>oe!==M)):N.onChange([...N.value||[],M]),y(!1)},onClear:q=>{q.stopPropagation(),N.onChange([])},"aria-label":c("realmRole"),isOpen:m,children:R.map(q=>e(z,{selected:q.name===N.value,value:q.name},q.name))})})})]})})]}),o(gn,{children:[e(Ut,{children:e(yt,{headingLevel:"h2",children:c("identityInformation")})}),e(fn,{children:o(pe,{isHorizontal:!0,role:"view-clients",children:[e(v,{label:c("applyToResourceType"),fieldId:"applyToResourceType",labelIcon:e(k,{helpText:c("applyToResourceTypeHelp"),fieldLabelId:"applyToResourceType"}),children:e(ce,{id:"applyToResource-switch",label:c("on"),labelOff:c("off"),isChecked:b,onChange:V,"aria-label":c("applyToResourceType")})}),b?o(U,{children:[e(v,{label:c("resourceType"),isRequired:!0,labelIcon:e(k,{helpText:c("resourceTypeHelp"),fieldLabelId:"resourceType"}),fieldId:"client",validated:u.alias?"error":"default",helperTextInvalid:c("required"),children:e(me,{id:"alias","aria-label":"resource-type","data-testid":"alias",...t("alias",{required:!0})})}),e(v,{label:c("authScopes"),labelIcon:e(k,{helpText:c("scopesSelect"),fieldLabelId:"client"}),fieldId:"authScopes",children:e(K,{name:"authScopes",defaultValue:[],control:s,render:({field:N})=>e(Y,{toggleId:"authScopes",onToggle:d,onSelect:(q,H)=>{const M=H.toString();N.value.includes(M)?N.onChange(N.value.filter(oe=>oe!==M)):N.onChange([...N.value,M]),d(!1)},selections:N.value,variant:$.typeaheadMulti,typeAheadAriaLabel:c("authScopes"),isOpen:g,children:x.map(q=>e(z,{selected:N.value.includes(q.name),value:q.name},q.id))})})})]}):e(v,{label:c("resourcesAndScopes"),id:"resourcesAndScopes",labelIcon:e(k,{helpText:c("contextualAttributesHelp"),fieldLabelId:"resourcesAndScopes"}),fieldId:"resourcesAndScopes",children:e(Rn,{selectableValues:G.map(N=>({name:N.name,key:N._id})),resources:G,name:"resources"})}),e(Jn,{toggleText:c("contextualInfo"),onToggle:()=>C(!T),isExpanded:T,children:e(v,{label:c("contextualAttributes"),id:"contextualAttributes",labelIcon:e(k,{helpText:c("contextualAttributesHelp"),fieldLabelId:"contextualAttributes"}),helperTextInvalid:c("required"),fieldId:"contextualAttributes",children:e(Rn,{selectableValues:Xn,name:"context.attributes"})})})]})})]}),o(xe,{children:[e(L,{"data-testid":"authorization-eval",id:"authorization-eval",className:"pf-u-mr-md",isDisabled:!r,onClick:()=>I(),children:c("evaluate")}),e(L,{"data-testid":"authorization-revert",id:"authorization-revert",className:"pf-u-mr-md",variant:"link",onClick:()=>i(),children:c("revert")})]})]})})},Xi=()=>{const{t:n}=w(),{clientId:a}=Xt(),{addAlert:s,addError:t}=de(),[i,l]=p(),[r,u]=p();le(()=>E.clients.exportResource({id:a}),h=>{l(JSON.stringify(h,null,2)),u(h)},[]);const c=()=>{try{st.saveAs(new Blob([et(r)],{type:"application/json"}),"test-authz-config.json"),s(n("exportAuthDetailsSuccess"),Z.success)}catch(h){t("exportAuthDetailsError",h)}};return i?e(fe,{children:o(pe,{isHorizontal:!0,role:"manage-authorization",className:"pf-u-mt-lg",children:[e(v,{label:n("authDetails"),labelIcon:e(k,{helpText:n("authDetailsHelp"),fieldLabelId:"authDetails"}),fieldId:"client",children:e(ct,{id:"authorizationDetails",readOnly:!0,resizeOrientation:"vertical",value:i,"aria-label":n("authDetails"),rows:10})}),o(xe,{children:[e(L,{"data-testid":"authorization-export-download",onClick:()=>c(),children:n("download")}),e(L,{"data-testid":"authorization-export-copy",variant:"secondary",onClick:async()=>{try{await navigator.clipboard.writeText(i),s(n("copied"),Z.success)}catch(h){t(n("copyError"),h)}},children:n("copy")})]})]})}):e(Pe,{})};function Zi(n){return e(je,{...n})}function je({name:n,array:a,convert:s,link:t}){const{t:i}=w();return o(si,{children:[e(li,{children:i(n)}),o(ri,{children:[a?.map(l=>{const r=typeof l=="string"?l:s(l);return t?e(ye,{to:t(l),className:"pf-u-pr-sm",children:r},r):e("span",{className:"pf-u-pr-sm",children:r},r)}),a?.length===0&&e("i",{children:i("none")})]})]})}const xn=({permissionType:n,disabled:a=!1,clientId:s})=>{const{t}=w(),{realm:i}=ge(),l=rt();return e(L,{"data-testid":`create-${n}`,className:a?"keycloak__permissions__empty_state ":"pf-u-m-sm",variant:"secondary",onClick:()=>!a&&l(vt({realm:i,id:s,permissionType:n})),children:t(`create${Ot(n)}BasedPermission`)})},En=({permissionType:n,disabled:a,...s})=>{const{t}=w();return a?e(Wt,{content:t(`no${Ot(n)}CreateHint`),children:e(xn,{...s,disabled:a,permissionType:n})}):e(xn,{...s,disabled:a,permissionType:n})},es=({clientId:n,isResourceEnabled:a,isScopeEnabled:s})=>{const{t}=w();return o(Zn,{"data-testid":"empty-state",variant:"large",children:[e(ci,{icon:Fn}),e(yt,{headingLevel:"h1",size:"lg",children:t("emptyPermissions")}),e(ea,{children:t("emptyPermissionInstructions")}),e(En,{permissionType:"resource",disabled:a,clientId:n}),e("br",{}),e(En,{permissionType:"scope",disabled:s,clientId:n})]})},tn=({array:n})=>{const{t:a}=w();return!n||n.length<=1?null:e(qt,{color:"blue",children:a("more",{count:n.length-1})})},nn=({types:n,search:a,onSearch:s,isResource:t=!1})=>{const{t:i}=w(),{register:l,control:r,reset:u,formState:{isDirty:c},handleSubmit:h}=Le({mode:"onChange"}),[f,g]=Ce(),[d,m]=Ce(),y=C=>{g(),s(C)};Ke(()=>u(a),[a]);const T=C=>[e(z,{value:"",children:i("allTypes")},"empty"),...(n||[]).map(b=>e(z,{selected:b.type===C,value:b.type,children:b.name},b.type))];return e(Qt,{"data-testid":"searchdropdown_dorpdown",className:"pf-u-ml-md",toggle:e(Mn,{onToggle:g,className:"keycloak__client_authentication__searchdropdown",children:i("searchForPermission")}),isOpen:f,children:o(Te,{isHorizontal:!0,className:"keycloak__client_authentication__searchdropdown_form",onSubmit:h(y),children:[e(v,{label:i("name"),fieldId:"name",children:e(me,{id:"name","data-testid":"searchdropdown_name",...l("name")})}),t&&o(U,{children:[e(v,{label:i("type"),fieldId:"type",children:e(me,{id:"type","data-testid":"searchdropdown_type",...l("type")})}),e(v,{label:i("uris"),fieldId:"uri",children:e(me,{id:"uri","data-testid":"searchdropdown_uri",...l("uri")})}),e(v,{label:i("owner"),fieldId:"owner",children:e(me,{id:"owner","data-testid":"searchdropdown_owner",...l("owner")})})]}),!t&&e(v,{label:i("resource"),fieldId:"resource",children:e(me,{id:"resource","data-testid":"searchdropdown_resource",...l("resource")})}),e(v,{label:i("scope"),fieldId:"scope",children:e(me,{id:"scope","data-testid":"searchdropdown_scope",...l("scope")})}),!t&&e(v,{label:i("type"),fieldId:"type",children:e(K,{name:"type",defaultValue:"",control:r,render:({field:C})=>e(Y,{toggleId:"type",onToggle:m,onSelect:(b,V)=>{b.stopPropagation(),C.onChange(V),m()},selections:C.value||i("allTypes"),variant:$.single,"aria-label":i("type"),isOpen:d,children:T(C.value)})})}),o(xe,{children:[e(L,{variant:"primary",type:"submit","data-testid":"search-btn",isDisabled:!c,children:i("search")}),e(L,{variant:"link","data-testid":"revert-btn",onClick:()=>s({}),children:i("clear")})]})]})})},ts=({row:n})=>o(U,{children:[n.associatedPolicies?.[0]?.name," ",e(tn,{array:n.associatedPolicies})]}),ns=({clientId:n})=>{const{t:a}=w(),s=rt(),{addAlert:t,addError:i}=de(),{realm:l}=ge(),[r,u]=p(),[c,h]=p(),[f,g]=p(),[d,m]=p(),[y,T]=Ce(),[C,b]=p({}),[V,G]=p(0),X=()=>G(V+1),[x,O]=p(10),[W,_]=p(0);le(async()=>{const D=await E.clients.findPermissions({first:W,max:x+1,id:n,...C});return await Promise.all(D.map(async N=>{const q=await E.clients.getAssociatedPolicies({id:n,permissionId:N.id});return{...N,associatedPolicies:q,isExpanded:!1}}))},u,[V,C,W,x]),le(async()=>{const D={first:0,max:1},[N,q,H]=await Promise.all([E.clients.listPolicyProviders({id:n}),E.clients.listResources({...D,id:n}),E.clients.listAllScopes({...D,id:n})]);return{policies:N.filter(M=>M.type==="resource"||M.type==="scope"),resources:q.length!==1,scopes:H.length!==1}},({policies:D,resources:N,scopes:q})=>{g(D),m({resources:N,scopes:q})},[]);const[R,S]=Re({titleKey:"deletePermission",messageKey:a("deletePermissionConfirm",{permission:c?.name}),continueButtonVariant:Se.danger,continueButtonLabel:"confirm",onConfirm:async()=>{try{await E.clients.delPermission({id:n,type:c?.type,permissionId:c?.id}),t(a("permissionDeletedSuccess"),Z.success),X()}catch(D){i("permissionDeletedError",D)}}});if(!r)return e(Pe,{});const I=r.length===0,B=Object.keys(C).length!==0;return o(fe,{variant:"light",className:"pf-u-p-0",children:[e(S,{}),(!I||B)&&e(Pt,{count:r.length,first:W,max:x,onNextClick:_,onPreviousClick:_,onPerPageSelect:(D,N)=>{_(D),O(N)},toolbarItem:o(U,{children:[e(ve,{children:e(nn,{types:f,search:C,onSearch:b})}),e(ve,{children:e(Qt,{toggle:e(Mn,{onToggle:T,isPrimary:!0,"data-testid":"permissionCreateDropdown",children:a("createPermission")}),isOpen:y,dropdownItems:[e(tt,{"data-testid":"create-resource",isDisabled:d?.resources,component:"button",onClick:()=>s(vt({realm:l,id:n,permissionType:"resource"})),children:a("createResourceBasedPermission")},"createResourceBasedPermission"),e(xa,{},"separator"),o(tt,{"data-testid":"create-scope",isDisabled:d?.scopes,component:"button",onClick:()=>s(vt({realm:l,id:n,permissionType:"scope"})),children:[a("createScopeBasedPermission"),d?.scopes&&e(ot,{className:"pf-u-mt-sm",variant:"warning",isInline:!0,isPlain:!0,title:a("noScopeCreateHint")})]},"createScopeBasedPermission")]})})]}),children:!I&&o(We,{"aria-label":a("resources"),variant:"compact",children:[e(Je,{children:o(re,{children:[e(j,{"aria-hidden":"true"}),e(j,{children:a("name")}),e(j,{children:a("type")}),e(j,{children:a("associatedPolicy")}),e(j,{children:a("description")}),e(j,{"aria-hidden":"true"})]})}),r.map((D,N)=>o(Qe,{isExpanded:D.isExpanded,children:[o(re,{children:[e(F,{expand:{rowIndex:N,isExpanded:D.isExpanded,onToggle:(q,H)=>{const M=r.map((oe,Ie)=>Ie===H?{...oe,isExpanded:!oe.isExpanded}:oe);u(M)}}}),e(F,{"data-testid":`name-column-${D.name}`,children:e(ye,{to:It({realm:l,id:n,permissionType:D.type,permissionId:D.id}),children:D.name})}),e(F,{children:f?.find(q=>q.type===D.type)?.name}),e(F,{children:e(ts,{row:D})}),e(F,{children:D.description}),e(F,{actions:{items:[{title:a("delete"),onClick:async()=>{h(D),R()}}]}})]}),o(re,{isExpanded:D.isExpanded,children:[e(F,{}),e(F,{colSpan:5,children:e(dt,{children:D.isExpanded&&e(ut,{isHorizontal:!0,className:"keycloak_resource_details",children:e(je,{name:"associatedPolicy",array:D.associatedPolicies,convert:q=>q.name,link:q=>Jt({id:n,realm:l,policyId:q.id,policyType:q.type})})})})})]},`child-${D.id}`)]},D.id))]})}),I&&!B&&e(es,{clientId:n,isResourceEnabled:d?.resources,isScopeEnabled:d?.scopes}),I&&B&&e(_e,{isSearchVariant:!0,message:a("noSearchResults"),instructions:a("noSearchResultsInstructions")})]})},as=({row:n})=>o(U,{children:[n.dependentPolicies?.[0]?.name," ",e(tn,{array:n.dependentPolicies})]}),is=({clientId:n})=>{const{t:a}=w(),{addAlert:s,addError:t}=de(),{realm:i}=ge(),l=rt(),[r,u]=p(),[c,h]=p(),[f,g]=p(),[d,m]=p(0),y=()=>m(d+1),[T,C]=p(10),[b,V]=p(0),[G,X]=p({}),[x,O]=Ce();le(async()=>{const I=await E.clients.listPolicies({first:b,max:T+1,id:n,permission:"false",...G});return await Promise.all([E.clients.listPolicyProviders({id:n}),...(I||[]).map(async B=>{const D=await E.clients.listDependentPolicies({id:n,policyId:B.id});return{...B,dependentPolicies:D,isExpanded:!1}})])},([I,...B])=>{g(I.filter(D=>D.type!=="resource"&&D.type!=="scope")),u(B)},[d,G,b,T]);const[W,_]=Re({titleKey:"deletePolicy",children:o(U,{children:[a("deletePolicyConfirm"),c?.dependentPolicies&&c.dependentPolicies.length>0&&e(ot,{variant:"warning",isInline:!0,isPlain:!0,component:"p",title:a("deletePolicyWarning"),className:"pf-u-pt-lg",children:e("p",{className:"pf-u-pt-xs",children:c.dependentPolicies.map(I=>e("strong",{className:"pf-u-pr-md",children:I.name},I.id))})})]}),continueButtonLabel:"confirm",onConfirm:async()=>{try{await E.clients.delPolicy({id:n,policyId:c?.id}),s(a("policyDeletedSuccess"),Z.success),y()}catch(I){t("policyDeletedError",I)}}});if(!r)return e(Pe,{});const R=r.length===0,S=Object.keys(G).length!==0;return o(fe,{variant:"light",className:"pf-u-p-0",children:[e(_,{}),(!R||S)&&o(U,{children:[x&&e(hn,{policyProviders:f,onSelect:I=>l(sn({id:n,realm:i,policyType:I.type})),toggleDialog:O}),e(Pt,{count:r.length,first:b,max:T,onNextClick:V,onPreviousClick:V,onPerPageSelect:(I,B)=>{V(I),C(B)},toolbarItem:o(U,{children:[e(ve,{children:e(nn,{types:f,search:G,onSearch:X})}),e(ve,{children:e(L,{"data-testid":"createPolicy",onClick:O,children:a("createPolicy")})})]}),children:!R&&o(We,{"aria-label":a("resources"),variant:"compact",children:[e(Je,{children:o(re,{children:[e(j,{"aria-hidden":"true"}),e(j,{children:a("name")}),e(j,{children:a("type")}),e(j,{children:a("dependentPermission")}),e(j,{children:a("description")}),e(j,{"aria-hidden":"true"})]})}),r.map((I,B)=>o(Qe,{isExpanded:I.isExpanded,children:[o(re,{children:[e(F,{expand:{rowIndex:B,isExpanded:I.isExpanded,onToggle:(D,N)=>{const q=r.map((H,M)=>M===N?{...H,isExpanded:!H.isExpanded}:H);u(q)}}}),e(F,{"data-testid":`name-column-${I.name}`,children:e(ye,{to:Jt({realm:i,id:n,policyType:I.type,policyId:I.id}),children:I.name})}),e(F,{children:Ot(I.type)}),e(F,{children:e(as,{row:I})}),e(F,{children:I.description}),e(F,{actions:{items:[{title:a("delete"),onClick:async()=>{h(I),W()}}]}})]}),o(re,{isExpanded:I.isExpanded,children:[e(F,{}),e(F,{colSpan:4,children:e(dt,{children:I.isExpanded&&e(ut,{isHorizontal:!0,className:"keycloak_resource_details",children:e(je,{name:"dependentPermission",array:I.dependentPolicies,convert:D=>D.name,link:D=>It({realm:i,id:n,permissionId:D.id,permissionType:D.type})})})})})]},`child-${I.id}`)]},I.id))]})})]}),R&&S&&e(_e,{isSearchVariant:!0,message:a("noSearchResults"),instructions:a("noSearchResultsInstructions")}),R&&!S&&o(U,{children:[x&&e(hn,{policyProviders:f?.filter(I=>I.type!=="aggregate"),onSelect:I=>l(sn({id:n,realm:i,policyType:I.type})),toggleDialog:O}),e(_e,{message:a("emptyPolicies"),instructions:a("emptyPoliciesInstructions"),primaryActionText:a("createPolicy"),onPrimaryAction:O})]})]})},ss=({id:n,clientId:a,uris:s})=>{const{realm:t}=ge(),[i,l]=p(),[r,u]=p();return le(()=>Promise.all([E.clients.listScopesByResource({id:a,resourceName:n}),E.clients.listPermissionsByResource({id:a,resourceId:n})]),([c,h])=>{l(c),u(h)},[]),!r||!i?e(Pe,{}):o(ut,{isHorizontal:!0,className:"keycloak_resource_details",children:[e(Zi,{name:"uris",array:s}),e(je,{name:"scopes",array:i,convert:c=>c.name,link:c=>Vn({id:a,realm:t,scopeId:c.id})}),e(je,{name:"associatedPermissions",array:r,convert:c=>c.name,link:c=>It({id:a,realm:t,permissionId:c.id,permissionType:"resource"})})]})},ls=({row:n})=>o(U,{children:[n.uris?.[0]," ",e(tn,{array:n.uris})]}),rs=({clientId:n})=>{const{t:a}=w(),s=rt(),{addAlert:t,addError:i}=de(),{realm:l}=ge(),[r,u]=p(),[c,h]=p(),[f,g]=p(),[d,m]=p(0),y=()=>m(d+1),[T,C]=p(10),[b,V]=p(0),[G,X]=p({});le(()=>{const S={first:b,max:T+1,deep:!1,...G};return E.clients.listResources({...S,id:n})},S=>u(S.map(I=>({...I,isExpanded:!1}))),[d,G,b,T]);const x=async S=>E.clients.listPermissionsByResource({id:n,resourceId:S}),[O,W]=Re({titleKey:"deleteResource",children:o(U,{children:[a("deleteResourceConfirm"),f?.length&&e(ot,{variant:"warning",isInline:!0,isPlain:!0,title:a("deleteResourceWarning"),className:"pf-u-pt-lg",children:e("p",{className:"pf-u-pt-xs",children:f.map(S=>e("strong",{className:"pf-u-pr-md",children:S.name},S.id))})})]}),continueButtonLabel:"confirm",onConfirm:async()=>{try{await E.clients.delResource({id:n,resourceId:c?._id}),t(a("resourceDeletedSuccess"),Z.success),y()}catch(S){i("resourceDeletedError",S)}}});if(!r)return e(Pe,{});const _=r.length===0,R=Object.keys(G).length!==0;return o(fe,{variant:"light",className:"pf-u-p-0",children:[e(W,{}),(!_||R)&&e(Pt,{count:r.length,first:b,max:T,onNextClick:V,onPreviousClick:V,onPerPageSelect:(S,I)=>{V(S),C(I)},toolbarItem:o(U,{children:[e(ve,{children:e(nn,{search:G,onSearch:X,isResource:!0})}),e(ve,{children:e(L,{"data-testid":"createResource",component:S=>e(ye,{...S,to:ln({realm:l,id:n})}),children:a("createResource")})})]}),children:!_&&o(We,{"aria-label":a("resources"),variant:"compact",children:[e(Je,{children:o(re,{children:[e(j,{"aria-hidden":"true"}),e(j,{children:a("name")}),e(j,{children:a("displayName")}),e(j,{children:a("type")}),e(j,{children:a("owner")}),e(j,{children:a("uris")}),e(j,{"aria-hidden":"true"}),e(j,{"aria-hidden":"true"})]})}),r.map((S,I)=>o(Qe,{isExpanded:S.isExpanded,children:[o(re,{children:[e(F,{expand:{rowIndex:I,isExpanded:S.isExpanded,onToggle:(B,D)=>{const N=r.map((q,H)=>H===D?{...q,isExpanded:!q.isExpanded}:q);u(N)}}}),e(F,{"data-testid":`name-column-${S.name}`,children:e(ye,{to:zn({realm:l,id:n,resourceId:S._id}),children:S.name})}),e(F,{children:S.displayName}),e(F,{children:S.type}),e(F,{children:S.owner?.name}),e(F,{children:e(ls,{row:S})}),e(F,{width:10,children:e(L,{variant:"link",component:B=>e(ye,{...B,to:vt({realm:l,id:n,permissionType:"resource",selectedId:S._id})}),children:a("createPermission")})}),e(F,{actions:{items:[{title:a("delete"),onClick:async()=>{h(S),g(await x(S._id)),O()}}]}})]}),o(re,{isExpanded:S.isExpanded,children:[e(F,{}),e(F,{colSpan:4,children:e(dt,{children:S.isExpanded&&e(ss,{clientId:n,id:S._id,uris:S.uris})})})]},`child-${S._id}`)]},S._id))]})}),_&&R&&e(_e,{isSearchVariant:!0,message:a("noSearchResults"),instructions:a("noSearchResultsInstructions")}),_&&!R&&e(_e,{message:a("emptyResources"),instructions:a("emptyResourcesInstructions"),primaryActionText:a("createResource"),onPrimaryAction:()=>s(ln({realm:l,id:n}))})]})},os=({clientId:n})=>{const{t:a}=w(),s=rt(),{realm:t}=ge(),[i,l]=Ce(),[r,u]=p(),[c,h]=p(),[f,g]=p([]),[d,m]=p(0),y=()=>m(d+1),[T,C]=p(10),[b,V]=p(0),[G,X]=p("");le(()=>{const R={first:b,max:T+1,deep:!1,name:G};return E.clients.listAllScopes({...R,id:n})},R=>{u(R.map(S=>({...S,isLoaded:!1}))),g(R.map(S=>({id:S.id,isExpanded:!1})))},[d,G,b,T]);const x=R=>r?.find(S=>S.id===R),O=R=>f.find(S=>S.id===R)?.isExpanded||!1;if(le(()=>{const R=f.filter(S=>S.isExpanded).map(({id:S})=>x(S)).filter(S=>!S.isLoaded);return Promise.all(R.map(async S=>{const[I,B]=await Promise.all([E.clients.listAllResourcesByScope({id:n,scopeId:S.id}),E.clients.listAllPermissionsByScope({id:n,scopeId:S.id})]);return{...S,resources:I,permissions:B,isLoaded:!0}}))},R=>{let S=[...r||[]];R.forEach(I=>{const B=r?.findIndex(D=>I.id===D.id);S=[...S.slice(0,B),I,...S.slice(B+1)]}),u(S)},[f]),!r)return e(Pe,{});const W=r.length===0,_=G!=="";return o(fe,{variant:"light",className:"pf-u-p-0",children:[e(di,{clientId:n,open:i,toggleDialog:l,selectedScope:c,refresh:y}),(!W||_)&&e(Pt,{count:r.length,first:b,max:T,onNextClick:V,onPreviousClick:V,onPerPageSelect:(R,S)=>{V(R),C(S)},inputGroupName:"search",inputGroupPlaceholder:a("searchByName"),inputGroupOnEnter:X,toolbarItem:e(ve,{children:e(L,{"data-testid":"createAuthorizationScope",component:R=>e(ye,{...R,to:rn({realm:t,id:n})}),children:a("createAuthorizationScope")})}),children:!W&&o(We,{"aria-label":a("scopes"),variant:"compact",children:[e(Je,{children:o(re,{children:[e(j,{"aria-hidden":"true"}),e(j,{children:a("name")}),e(j,{children:a("displayName")}),e(j,{"aria-hidden":"true"}),e(j,{"aria-hidden":"true"})]})}),r.map((R,S)=>o(Qe,{isExpanded:O(R.id),children:[o(re,{children:[e(F,{expand:{rowIndex:S,isExpanded:O(R.id),onToggle:(I,B,D)=>{g([...f.slice(0,B),{id:R.id,isExpanded:D},...f.slice(B+1)])}}}),e(F,{"data-testid":`name-column-${R.name}`,children:e(ye,{to:Vn({realm:t,id:n,scopeId:R.id}),children:R.name})}),e(F,{children:R.displayName}),e(F,{width:10,children:e(L,{variant:"link",component:I=>e(ye,{...I,to:vt({realm:t,id:n,permissionType:"scope",selectedId:R.id})}),children:a("createPermission")})}),e(F,{isActionCell:!0,actions:{items:[{title:a("delete"),onClick:()=>{h(R),l()}}]}})]}),o(re,{isExpanded:O(R.id),children:[e(F,{}),e(F,{colSpan:4,children:e(dt,{children:O(R.id)&&R.isLoaded?o(ut,{isHorizontal:!0,className:"keycloak_resource_details",children:[e(je,{name:"resources",array:R.resources,convert:I=>I.name,link:I=>zn({id:n,realm:t,resourceId:I._id})}),e(je,{name:"associatedPermissions",array:R.permissions,convert:I=>I.name,link:I=>It({id:n,realm:t,permissionId:I.id,permissionType:I.type})})]}):e(Pe,{})})})]},`child-${R.id}`)]},R.id))]})}),W&&!_&&e(_e,{message:a("emptyAuthorizationScopes"),instructions:a("emptyAuthorizationInstructions"),onPrimaryAction:()=>s(rn({id:n,realm:t})),primaryActionText:a("createAuthorizationScope")}),W&&_&&e(_e,{isSearchVariant:!0,message:a("noSearchResults"),instructions:a("noSearchResultsInstructions")})]})},cs=({onConfirm:n,closeDialog:a})=>{const{t:s}=w(),[t,i]=p({});return o($e,{title:s("import"),isOpen:!0,variant:"small",onClose:a,actions:[e(L,{id:"modal-confirm",onClick:()=>{n(t),a()},"data-testid":"confirm",children:s("confirm")},"confirm"),e(L,{"data-testid":"cancel",id:"modal-cancel",variant:Se.link,onClick:()=>{a()},children:s("cancel")},"cancel")],children:[e(Te,{children:e(ui,{id:"import-resource",onChange:i})}),Object.keys(t).length!==0&&o(U,{children:[e(Ue,{}),e("p",{className:"pf-u-my-lg",children:s("importResources")}),o(Te,{isHorizontal:!0,children:[e(v,{label:s("policyEnforcementMode"),labelIcon:e(k,{helpText:s("policyEnforcementModeHelp"),fieldLabelId:"policyEnforcementMode"}),fieldId:"policyEnforcementMode",hasNoPaddingTop:!0,children:e(St,{id:"policyEnforcementMode",name:"policyEnforcementMode",label:s(`policyEnforcementModes.${t.policyEnforcementMode}`),isChecked:!0,isDisabled:!0,className:"pf-u-mb-md"})}),e(v,{label:s("decisionStrategy"),labelIcon:e(k,{helpText:s("decisionStrategyHelp"),fieldLabelId:"decisionStrategy"}),fieldId:"decisionStrategy",hasNoPaddingTop:!0,children:e(St,{id:"decisionStrategy",name:"decisionStrategy",isChecked:!0,isDisabled:!0,label:s(`decisionStrategies.${t.decisionStrategy}`),className:"pf-u-mb-md"})}),e(v,{hasNoPaddingTop:!0,label:s("allowRemoteResourceManagement"),fieldId:"allowRemoteResourceManagement",labelIcon:e(k,{helpText:s("allowRemoteResourceManagement"),fieldLabelId:"allowRemoteResourceManagement"}),children:e(ce,{id:"allowRemoteResourceManagement",label:s("on"),labelOff:s("off"),isChecked:t.allowRemoteResourceManagement,isDisabled:!0,"aria-label":s("allowRemoteResourceManagement")})})]}),e("div",{className:"pf-u-mt-md",children:Object.entries(t).filter(([,l])=>Array.isArray(l)).map(([l,r])=>o(Dn,{children:[e(Ue,{}),e("p",{className:"pf-u-my-sm",children:o("strong",{children:[r.length," ",s(l)]})})]},l))}),e(Ue,{}),e(ot,{variant:"warning",className:"pf-u-mt-lg",isInline:!0,title:s("importWarning")})]})]})},wn=["ENFORCING","PERMISSIVE","DISABLED"],ds=({clientId:n})=>{const{t:a}=w(),[s,t]=p(),[i,l]=Ce(),r=Le({}),{control:u,reset:c,handleSubmit:h}=r,{addAlert:f,addError:g}=de();le(()=>E.clients.getResourceServer({id:n}),y=>{t(y),c(y)},[]);const d=async y=>{try{await E.clients.importResource({id:n},y),f(a("importResourceSuccess"),Z.success),c({...y})}catch(T){g("importResourceError",T)}},m=async y=>{try{await E.clients.updateResourceServer({id:n},y),f(a("updateResourceSuccess"),Z.success)}catch(T){g("resourceSaveError",T)}};return s?o(fe,{variant:"light",children:[i&&e(cs,{onConfirm:d,closeDialog:l}),o(pe,{role:"view-clients",isHorizontal:!0,onSubmit:h(m),children:[e(v,{label:a("import"),fieldId:"import",labelIcon:e(k,{helpText:a("importHelp"),fieldLabelId:"import"}),children:e(L,{variant:"secondary",onClick:l,children:a("import")})}),e(Ue,{}),e(v,{label:a("policyEnforcementMode"),labelIcon:e(k,{helpText:a("policyEnforcementModeHelp"),fieldLabelId:"policyEnforcementMode"}),fieldId:"policyEnforcementMode",hasNoPaddingTop:!0,children:e(K,{name:"policyEnforcementMode","data-testid":"policyEnforcementMode",defaultValue:wn[0],control:u,render:({field:y})=>e(U,{children:wn.map(T=>e(St,{id:T,"data-testid":T,isChecked:y.value===T,name:"policyEnforcementMode",onChange:()=>y.onChange(T),label:a(`policyEnforcementModes.${T}`),className:"pf-u-mb-md"},T))})})}),e(He,{...r,children:e(ti,{isLimited:!0})}),e(v,{hasNoPaddingTop:!0,label:a("allowRemoteResourceManagement"),fieldId:"allowRemoteResourceManagement",labelIcon:e(k,{helpText:a("allowRemoteResourceManagementHelp"),fieldLabelId:"allowRemoteResourceManagement"}),children:e(K,{name:"allowRemoteResourceManagement","data-testid":"allowRemoteResourceManagement",defaultValue:!1,control:u,render:({field:y})=>e(ce,{id:"allowRemoteResourceManagement",label:a("on"),labelOff:a("off"),isChecked:y.value,onChange:y.onChange,"aria-label":a("allowRemoteResourceManagement")})})}),e(Lt,{name:"authenticationSettings",reset:()=>c(s),isActive:!0,isSubmit:!0})]})]}):e(Pe,{})};function us(n){const[a,s]=p(null),[t,i]=p(null);function l(r){i({name:r.name,state:r.state})}return Ke(()=>{s(null),i(null),navigator.permissions.query({name:n}).then(r=>{s(r),l(r)})},[n]),Ke(()=>{if(!a)return;function r(){a&&l(a)}return a.addEventListener("change",r),()=>a.removeEventListener("change",r)},[a]),t}const oa=({id:n,label:a,text:s,variant:t="plain"})=>{const{t:i}=w(),l=Ea(),u=us("clipboard-write")?.state==="denied",[c,h]=p(0),f=Tt(()=>{if(u)return"clipboardCopyDenied";switch(c){case 0:return"copyToClipboard";case 1:return"copySuccess";case 2:return"clipboardCopyError"}},[u,c]);Ke(()=>{if(c!==0)return l(()=>h(0),1e3)},[c,l]);const g=async d=>{try{await navigator.clipboard.writeText(d),h(1)}catch{h(2)}};return e(Ba,{id:`copy-button-${n}`,textId:a,"aria-label":i("copyToClipboard"),onClick:()=>g(s),exitDelay:600,variant:t,children:i(f)})},On=({id:n,buttonLabel:a,client:s,secret:t,toggle:i})=>{const{t:l}=w(),r=ee(),{hasAccess:u}=De(),c=u("manage-clients")||s.access?.configure;return o(lt,{hasGutter:!0,children:[e(Ae,{isFilled:!0,children:o($t,{children:[e(Bt,{id:n,value:t,isReadOnly:!0}),e(oa,{id:n,text:t,label:"clientSecret",variant:"control"})]})}),e(Ae,{children:e(L,{variant:"secondary",isDisabled:r.formState.isDirty||!c,onClick:i,children:l(a)})})]})},Pn=({time:n})=>{const{t:a}=w(),s=en();return e("div",{className:"pf-u-my-md",children:(i=>i?a("secretExpiresOn",{time:s(new Date(i*1e3),{dateStyle:"full",timeStyle:"long"})}):void 0)(n)})},ps=({client:n,secret:a,toggle:s})=>{const{t}=w(),{addAlert:i,addError:l}=de(),[r,u]=p(n.attributes?.["client.secret.rotated"]),c=n.attributes?.["client.secret.expiration.time"],h=n.attributes?.["client.secret.rotated.expiration.time"],f=m=>new Date().getTime()>=m*1e3,[g,d]=Re({titleKey:"invalidateRotatedSecret",messageKey:"invalidateRotatedSecretExplain",continueButtonLabel:"confirm",onConfirm:async()=>{try{await E.clients.invalidateSecret({id:n.id}),u(void 0),i(t("invalidateRotatedSuccess"))}catch(m){l("invalidateRotatedError",m)}}});return o(U,{children:[e(d,{}),o(v,{label:t("clientSecret"),fieldId:"kc-client-secret",className:"pf-u-my-md",children:[e(On,{id:"kc-client-secret",client:n,secret:a,toggle:s,buttonLabel:"regenerate"}),e(Pn,{time:c}),f(c)&&e(ot,{variant:"warning",isInline:!0,title:t("secretHasExpired")})]}),r&&o(v,{label:t("secretRotated"),fieldId:"secretRotated",children:[e(On,{id:"secretRotated",client:n,secret:r,toggle:g,buttonLabel:"invalidateSecret"}),e(Pn,{time:h})]})]})},hs=({clientAuthenticatorType:n})=>{const{control:a}=ee(),{cryptoInfo:s}=Ge(),t=n==="client-jwt"?s?.clientSignatureAsymmetricAlgorithms??[]:s?.clientSignatureSymmetricAlgorithms??[],{t:i}=w(),[l,r]=p(!1);return e(v,{label:i("signatureAlgorithm"),fieldId:"kc-signature-algorithm",labelIcon:e(k,{helpText:i("signatureAlgorithmHelp"),fieldLabelId:"signatureAlgorithm"}),children:e(K,{name:P("attributes.token.endpoint.auth.signing.alg"),defaultValue:"",control:a,render:({field:u})=>o(Y,{maxHeight:200,toggleId:"kc-signature-algorithm",onToggle:r,onSelect:(c,h)=>{u.onChange(h.toString()),r(!1)},selections:u.value||i("anyAlgorithm"),variant:$.single,"aria-label":i("signatureAlgorithm"),isOpen:l,children:[e(z,{selected:u.value==="",value:"",children:i("anyAlgorithm")},"any"),e(U,{children:t.map(c=>e(z,{selected:c===u.value,value:c},c))})]})})})},ms=()=>{const{t:n}=w(),{register:a,control:s,formState:{errors:t}}=ee();return o(U,{children:[e(v,{label:n("allowRegexComparison"),labelIcon:e(k,{helpText:n("allowRegexComparisonHelp"),fieldLabelId:"allowRegexComparison"}),fieldId:"allowRegexComparison",hasNoPaddingTop:!0,children:e(K,{name:P("attributes.x509.allow.regex.pattern.comparison"),defaultValue:"false",control:s,render:({field:i})=>e(ce,{id:"allowRegexComparison",label:n("on"),labelOff:n("off"),isChecked:i.value==="true",onChange:l=>i.onChange(l.toString()),"aria-label":n("allowRegexComparison")})})}),e(v,{label:n("subject"),fieldId:"kc-subject",labelIcon:e(k,{helpText:n("subjectHelp"),fieldLabelId:"subject"}),helperTextInvalid:n("required"),validated:t.attributes?.[Ve("x509.subjectdn")]?ke.error:ke.default,isRequired:!0,children:e(me,{type:"text",id:"kc-subject",validated:t.attributes?.[Ve("x509.subjectdn")]?ke.error:ke.default,...a(P("attributes.x509.subjectdn"),{required:!0})})})]})},gs=({client:n,save:a,refresh:s})=>{const{t}=w(),{addAlert:i,addError:l}=de(),r=n.id,[u,c]=p([]),{control:h,formState:{isDirty:f},handleSubmit:g}=ee(),d=it({control:h,name:"clientAuthenticatorType",defaultValue:""}),[m,y]=p(""),[T,C]=p(""),[b,V]=p(!1);le(()=>Promise.all([E.authenticationManagement.getClientAuthenticatorProviders(),E.clients.getClientSecret({id:r})]),([S,I])=>{c(S),y(I.value)},[]);async function G(S,I){try{const B=await S(r);return i(t(`${I}Success`),Z.success),B}catch(B){l(`${I}Error`,B)}}const X=async()=>{const S=await G(I=>E.clients.generateNewClientSecret({id:I}),"clientSecret");y(S?.value||""),s()},[x,O]=Re({titleKey:"confirmClientSecretTitle",messageKey:"confirmClientSecretBody",continueButtonLabel:"yes",cancelButtonLabel:"no",onConfirm:X}),W=async()=>{const S=await G(I=>E.clients.generateRegistrationAccessToken({id:I}),"accessToken");C(S?.registrationAccessToken||"")},[_,R]=Re({titleKey:"confirmAccessTokenTitle",messageKey:"confirmAccessTokenBody",continueButtonLabel:"yes",cancelButtonLabel:"no",onConfirm:W});return e(fe,{children:o(pe,{onSubmit:g(a),isHorizontal:!0,className:"pf-u-mt-md",role:"manage-clients",fineGrainedAccess:n.access?.configure,children:[e(O,{}),e(R,{}),o(wt,{isFlat:!0,children:[o(nt,{children:[e(v,{label:t("clientAuthenticator"),fieldId:"kc-client-authenticator-type",labelIcon:e(k,{helpText:t("clientAuthenticatorTypeHelp"),fieldLabelId:"clientAuthenticator"}),children:e(K,{name:"clientAuthenticatorType",control:h,defaultValue:"",render:({field:S})=>e(Y,{toggleId:"kc-client-authenticator-type",required:!0,onToggle:V,onSelect:(I,B)=>{S.onChange(B),V(!1)},selections:S.value,variant:$.single,"aria-label":t("clientAuthenticator"),isOpen:b,children:u.map(I=>e(z,{selected:I.id===S.value,value:I.id,children:I.displayName},I.id))})})}),(d==="client-jwt"||d==="client-secret-jwt")&&e(hs,{clientAuthenticatorType:d}),d==="client-jwt"&&e(v,{children:e(ot,{variant:"info",isInline:!0,title:t("signedJWTConfirm")})}),d==="client-x509"&&e(ms,{}),e(xe,{children:e(L,{variant:"primary",type:"submit",isDisabled:!f,children:t("save")})})]}),(d==="client-secret"||d==="client-secret-jwt")&&e(Ue,{}),(d==="client-secret"||d==="client-secret-jwt")&&e(nt,{children:e(ps,{client:n,secret:m,toggle:x})})]}),e(wt,{isFlat:!0,children:e(nt,{children:e(v,{label:t("registrationAccessToken"),fieldId:"kc-access-token",labelIcon:e(k,{helpText:t("registrationAccessTokenHelp"),fieldLabelId:"registrationAccessToken"}),children:o(lt,{hasGutter:!0,children:[e(Ae,{isFilled:!0,children:e(Bn,{id:"kc-access-token",isReadOnly:!0,children:T})}),e(Ae,{children:e(L,{variant:"secondary",onClick:_,children:t("regenerate")})})]})})})})]})})},_n=({id:n,keyInfo:a})=>{const{t:s}=w();return e(ct,{readOnly:!0,rows:5,id:n,"data-testid":"certificate",value:a?.certificate,"aria-label":s("certificate")})},an=({keyInfo:n,plain:a=!1})=>{const{t:s}=w(),t=ha();return a?e(_n,{id:t,keyInfo:n}):e(v,{label:s("certificate"),fieldId:t,labelIcon:e(k,{helpText:s("certificateHelp"),fieldLabelId:t}),children:e(_n,{id:t,keyInfo:n})})},ca=({hidePassword:n=!1,isSaml:a=!1})=>{const{t:s}=w(),{register:t,formState:{errors:i}}=ee();return o(U,{children:[e(v,{label:s("keyAlias"),fieldId:"keyAlias",isRequired:!0,labelIcon:e(k,{helpText:s("keyAliasHelp"),fieldLabelId:"keyAlias"}),helperTextInvalid:s("required"),validated:i.keyAlias?"error":"default",children:e(me,{"data-testid":"keyAlias",id:"keyAlias",validated:i.keyAlias?"error":"default",...t("keyAlias",{required:!0})})}),!n&&e(v,{label:s("keyPassword"),fieldId:"keyPassword",isRequired:!0,labelIcon:e(k,{helpText:s("keyPasswordHelp"),fieldLabelId:"keyPassword"}),helperTextInvalid:s("required"),validated:i.keyPassword?"error":"default",children:e(Bt,{"data-testid":"keyPassword",id:"keyPassword",validated:i.keyPassword?"error":"default",...t("keyPassword",{required:!0})})}),a&&e(v,{label:s("realmCertificateAlias"),fieldId:"realmCertificateAlias",labelIcon:e(k,{helpText:s("realmCertificateAliasHelp"),fieldLabelId:"realmCertificateAlias"}),children:e(me,{"data-testid":"realmCertificateAlias",id:"realmCertificateAlias",...t("realmAlias")})}),e(v,{label:s("storePassword"),fieldId:"storePassword",isRequired:!0,labelIcon:e(k,{helpText:s("storePasswordHelp"),fieldLabelId:"storePassword"}),helperTextInvalid:s("required"),validated:i.storePassword?"error":"default",children:e(Bt,{"data-testid":"storePassword",id:"storePassword",validated:i.storePassword?"error":"default",...t("storePassword",{required:!0})})})]})},Ln="Certificate PEM",fs=new Map([["PKCS12","p12"],["JKS","jks"],["BCFKS","bcfks"]]),da=n=>fs.get(n),Dt=({isSaml:n=!1,hasPem:a=!1,useFile:s=!1})=>{const{t}=w(),[i,l]=p(),[r,u]=p(!1),{control:c,watch:h}=ee(),f=h("format"),{cryptoInfo:g}=Ge(),d=[...g?.supportedKeystoreTypes??[],...a?[Ln]:[]];return o(Te,{className:"pf-u-pt-lg",children:[e(v,{label:t("archiveFormat"),labelIcon:e(k,{helpText:t("archiveFormatHelp"),fieldLabelId:"archiveFormat"}),fieldId:"archiveFormat",children:e(K,{name:"format",defaultValue:d[0],control:c,render:({field:m})=>e(Y,{toggleId:"archiveFormat",onToggle:u,onSelect:(y,T)=>{m.onChange(T.toString()),u(!1)},selections:m.value,variant:$.single,"aria-label":t("archiveFormat"),isOpen:r,menuAppendTo:"parent",children:d.map(y=>e(z,{selected:y===m.value,value:y},y))})})}),s&&e(v,{label:t("importFile"),labelIcon:e(k,{helpText:t("importFileHelp"),fieldLabelId:"importFile"}),fieldId:"importFile",children:e(K,{name:"file",defaultValue:"",control:c,render:({field:m})=>e(ta,{id:"importFile",value:m.value,filename:i,browseButtonText:t("browse"),onChange:(y,T)=>{l(T),m.onChange(y)}})})}),f!==Ln&&e(ca,{hidePassword:s,isSaml:n})]})},bs=({clientId:n,save:a,toggleDialog:s})=>{const{t}=w(),i=Le({defaultValues:{keyAlias:n},mode:"onChange"}),{handleSubmit:l,formState:{isValid:r}}=i;return o($e,{variant:kt.medium,title:t("generateKeys"),isOpen:!0,onClose:s,actions:[e(L,{id:"modal-confirm","data-testid":"confirm",isDisabled:!r,onClick:()=>{l(u=>{a(u),s()})()},children:t("generate")},"confirm"),e(L,{id:"modal-cancel","data-testid":"cancel",variant:Se.link,onClick:()=>{s()},children:t("cancel")},"cancel")],children:[e(Be,{children:e(be,{children:t("generateKeysDescription")})}),e(He,{...i,children:e(Dt,{})})]})},ys=({save:n,toggleDialog:a})=>{const{t:s}=w(),t=Le(),{control:i,handleSubmit:l}=t,[r,u]=p(!1),c=Ge().cryptoInfo?.supportedKeystoreTypes??[],h=c.concat(["Certificate PEM","Public Key PEM","JSON Web Key Set"]),f=it({control:i,name:"keystoreFormat",defaultValue:h[0]});return o($e,{variant:kt.medium,title:s("generateKeys"),isOpen:!0,onClose:a,actions:[e(L,{id:"modal-confirm","data-testid":"confirm",onClick:()=>{l(g=>{n(g),a()})()},children:s("import")},"confirm"),e(L,{id:"modal-cancel","data-testid":"cancel",variant:Se.link,onClick:()=>{a()},children:s("cancel")},"cancel")],children:[e(Be,{children:e(be,{children:s("generateKeysDescription")})}),o(Te,{className:"pf-u-pt-lg",children:[e(v,{label:s("archiveFormat"),labelIcon:e(k,{helpText:s("archiveFormatHelp"),fieldLabelId:"archiveFormat"}),fieldId:"archiveFormat",children:e(K,{name:"keystoreFormat",control:i,defaultValue:h[0],render:({field:g})=>e(Y,{toggleId:"archiveFormat",onToggle:u,onSelect:(d,m)=>{g.onChange(m),u(!1)},selections:g.value,variant:$.single,"aria-label":s("archiveFormat"),isOpen:r,children:h.map(d=>e(z,{selected:d===g.value,value:d},d))})})}),c.includes(f)&&e(He,{...t,children:e(ca,{hidePassword:!0})}),e(v,{label:s("importFile"),fieldId:"importFile",children:e(K,{name:"file",control:i,defaultValue:{filename:""},render:({field:g})=>e(ta,{id:"importFile",value:g.value.value,filename:g.value.filename,onChange:(d,m)=>g.onChange({value:d,filename:m})})})})]})]})},Mt="jwt.credential",vs=({clientId:n,save:a,hasConfigureAccess:s})=>{const{t}=w(),{control:i,register:l,getValues:r,formState:{isDirty:u}}=ee(),{addAlert:c,addError:h}=de(),[f,g]=p(),[d,m,y]=Ce(),[T,C,b]=Ce(),[V,G]=p(0),X=()=>G(V+1),x=it({control:i,name:P("attributes.use.jwks.url"),defaultValue:"false"});le(()=>E.clients.getKeyInfo({id:n,attr:Mt}),_=>g(_),[V]);const O=async _=>{try{const R=await E.clients.generateAndDownloadKey({id:n,attr:Mt},_);st.saveAs(new Blob([R],{type:"application/octet-stream"}),`keystore.${da(_.format??"")}`),c(t("generateSuccess"),Z.success),X()}catch(R){h("generateError",R)}},W=async _=>{try{const R=new FormData,{file:S,...I}=_;for(const[B,D]of Object.entries(I))R.append(B,D);R.append("file",S.value),await E.clients.uploadCertificate({id:n,attr:Mt},R),c(t("importSuccess"),Z.success),X()}catch(R){h("importError",R)}};return o(fe,{variant:"light",className:"keycloak__form",children:[d&&e(bs,{clientId:r("clientId"),toggleDialog:m,save:O}),T&&e(ys,{toggleDialog:C,save:W}),o(wt,{isFlat:!0,children:[e(wa,{children:e(Oa,{children:t("jwksUrlConfig")})}),e(nt,{children:e(Be,{children:e(be,{children:t("keysIntro")})})}),e(nt,{children:o(pe,{role:"manage-clients",fineGrainedAccess:s,isHorizontal:!0,children:[e(v,{hasNoPaddingTop:!0,label:t("useJwksUrl"),fieldId:"useJwksUrl",labelIcon:e(k,{helpText:t("useJwksUrlHelp"),fieldLabelId:"useJwksUrl"}),children:e(K,{name:P("attributes.use.jwks.url"),control:i,render:({field:_})=>e(ce,{"data-testid":"useJwksUrl",id:"useJwksUrl-switch",label:t("on"),labelOff:t("off"),isChecked:_.value==="true",onChange:R=>_.onChange(`${R}`),"aria-label":t("useJwksUrl")})})}),x!=="true"&&(f?e(an,{plain:!0,keyInfo:f}):"No client certificate configured"),x==="true"&&e(v,{label:t("jwksUrl"),fieldId:"jwksUrl",labelIcon:e(k,{helpText:t("jwksUrlHelp"),fieldLabelId:"jwksUrl"}),children:e(me,{id:"jwksUrl",type:"url",...l(P("attributes.jwks.url"))})}),o(xe,{children:[e(L,{"data-testid":"saveKeys",onClick:a,isDisabled:!u,children:t("save")}),e(L,{"data-testid":"generate",variant:"secondary",onClick:()=>y(!0),children:t("generateNewKeys")}),e(L,{"data-testid":"import",variant:"secondary",onClick:()=>b(!0),isDisabled:x==="true",children:t("import")})]})]})})]})]})},Ss=({clientId:n,close:a,keyType:s})=>{const{t}=w(),{realm:i}=ge(),{addAlert:l,addError:r}=de(),u=Le({defaultValues:{realmAlias:i}}),c=async h=>{try{const f=await E.clients.downloadKey({id:n,attr:s},h);st.saveAs(new Blob([f],{type:"application/octet-stream"}),`keystore.${da(h.format??"")}`),l(t("samlKeysExportSuccess")),a()}catch(f){r("samlKeysExportError",f)}};return e($e,{variant:"medium",title:t("exportSamlKeyTitle"),isOpen:!0,onClose:a,actions:[e(L,{id:"modal-confirm","data-testid":"confirm",type:"submit",form:"export-saml-key-form",children:t("export")},"confirm"),e(L,{id:"modal-cancel","data-testid":"cancel",variant:"link",onClick:()=>{a()},children:t("cancel")},"cancel")],children:e(Te,{id:"export-saml-key-form",className:"pf-u-pt-lg",onSubmit:u.handleSubmit(c),children:e(He,{...u,children:e(Dt,{isSaml:!0})})})})},ua=async(n,a,s,t)=>{try{const i=new FormData,{file:l,...r}=n;Object.entries(r).map(([u,c])=>i.append(u==="format"?"keystoreFormat":u,c.toString())),i.append("file",l),await E.clients.uploadKey({id:a,attr:s},i),t()}catch(i){t(i)}},Ts=({id:n,attr:a,onClose:s,onCancel:t})=>{const{t:i}=w(),[l,r]=p(!1),[u,c]=p(),h=Le({mode:"onChange"}),{handleSubmit:f,formState:{isValid:g}}=h,{addAlert:d,addError:m}=de(),y=C=>{ua(C,n,a,b=>{b?m("importError",b):d(i("importSuccess"),Z.success)})},T=async()=>{try{const C=await E.clients.generateKey({id:n,attr:a});c(C),st.saveAs(new Blob([C.privateKey],{type:"application/octet-stream"}),"private.key"),d(i("generateSuccess"),Z.success)}catch(C){m("generateError",C)}};return e($e,{variant:kt.medium,"aria-labelledby":i("enableClientSignatureRequired"),header:o(Be,{children:[e(yt,{headingLevel:"h1",children:i("enableClientSignatureRequired")}),e(be,{children:i("enableClientSignatureRequiredExplain")})]}),isOpen:!0,onClose:s,actions:[e(L,{id:"modal-confirm","data-testid":"confirm",variant:"primary",isDisabled:!g&&!u,onClick:()=>{l&&f(y)(),s()},children:i("confirm")},"confirm"),e(L,{id:"modal-cancel","data-testid":"cancel",variant:Se.link,onClick:t,children:i("cancel")},"cancel")],children:o(He,{...h,children:[o(Te,{isHorizontal:!0,children:[e(v,{label:i("selectMethod"),fieldId:"selectMethod",hasNoPaddingTop:!0,children:o(pi,{children:[e(bn,{children:e(St,{isChecked:!l,name:"selectMethodType",onChange:()=>r(!1),label:i("selectMethodType.generate"),id:"selectMethodType-generate"})}),e(bn,{children:e(St,{isChecked:l,name:"selectMethodType",onChange:()=>r(!0),label:i("selectMethodType.import"),id:"selectMethodType-import"})})]})}),!l&&e(v,{label:i("certificate"),fieldId:"certificate",labelIcon:e(k,{helpText:i("certificateHelp"),fieldLabelId:"certificate"}),children:o(lt,{hasGutter:!0,children:[e(Ae,{isFilled:!0,children:e(an,{plain:!0,keyInfo:u})}),e(Ae,{children:e(L,{variant:"secondary","data-testid":"generate",onClick:T,children:i("generate")})})]})})]}),l&&e(Dt,{useFile:!0})]})})},Cs=({id:n,attr:a,onClose:s})=>{const{t}=w(),i=ee(),{handleSubmit:l}=i,{addAlert:r,addError:u}=de(),c=h=>{ua(h,n,a,f=>{f?u("importError",f):r(t("importSuccess"),Z.success)})};return e(Yt,{open:!0,toggleDialog:s,continueButtonLabel:"import",titleKey:"importKey",onConfirm:()=>{l(c)(),s()},children:e(He,{...i,children:e(Dt,{useFile:!0,hasPem:!0})})})},Vt=["saml.signing","saml.encryption"],at={"saml.signing":{name:P("attributes.saml.client.signature"),title:"signingKeysConfig",key:"clientSignature"},"saml.encryption":{name:P("attributes.saml.encrypt"),title:"encryptionKeysConfig",key:"encryptAssertions"}},Is=({clientId:n,keyInfo:a,attr:s,onChanged:t,onGenerate:i,onImport:l})=>{const{t:r}=w(),{control:u,watch:c}=ee(),h=at[s].title,f=at[s].key,g=at[s].name,[d,m]=Ce(),y=c(g);return o(U,{children:[d&&e(Ss,{keyType:s,clientId:n,close:m}),o(Pa,{title:r(h),className:"kc-form-panel__panel",children:[e(Be,{className:"pf-u-pb-lg",children:e(be,{children:r(`${h}Explain`)})}),e(pe,{role:"manage-clients",isHorizontal:!0,children:e(v,{labelIcon:e(k,{helpText:r(`${f}Help`),fieldLabelId:f}),label:r(f),fieldId:f,hasNoPaddingTop:!0,children:e(K,{name:g,control:u,defaultValue:"false",render:({field:T})=>e(ce,{"data-testid":f,id:f,label:r("on"),labelOff:r("off"),isChecked:T.value==="true",onChange:C=>{const b=C.toString();b==="true"?(t(s),T.onChange(b)):i(s,!1)},"aria-label":r(f)})})})})]}),a?.certificate&&y==="true"&&e(wt,{isFlat:!0,children:e(nt,{className:"kc-form-panel__body",children:o(Te,{isHorizontal:!0,children:[e(an,{keyInfo:a}),o(xe,{children:[e(L,{variant:"secondary",onClick:()=>i(s,!0),children:r("regenerate")}),e(L,{variant:"secondary",onClick:()=>l(s),children:r("importKey")}),e(L,{variant:"tertiary",onClick:m,children:r("export")})]})]})})})]})},ks=({clientId:n,save:a})=>{const{t:s}=w(),[t,i]=p(),[l,r]=p(),[u,c]=p(),[h,f]=p(),[g,d]=p(0),{setValue:m}=ee(),{addAlert:y,addError:T}=de();le(()=>Promise.all(Vt.map(O=>E.clients.getKeyInfo({id:n,attr:O}))),O=>r(O),[g]);const C=async O=>{const W=Vt.indexOf(O);try{const _=[...l||[]];_[W]=await E.clients.generateKey({id:n,attr:O}),r(_),st.saveAs(new Blob([_[W].privateKey],{type:"application/octet-stream"}),"private.key"),y(s("generateSuccess"),Z.success)}catch(_){T("generateError",_)}},b=u?at[u].key:"",[V,G]=Re({titleKey:s("disableSigning",{key:s(b)}),messageKey:s("disableSigningExplain",{key:s(b)}),continueButtonLabel:"yes",cancelButtonLabel:"no",onConfirm:()=>{m(at[u].name,"false"),a()}}),[X,x]=Re({titleKey:"reGenerateSigning",messageKey:"reGenerateSigningExplain",continueButtonLabel:"yes",cancelButtonLabel:"no",onConfirm:()=>{C(u)}});return o(fe,{variant:"light",className:"keycloak__form",children:[t&&e(Ts,{id:n,attr:t,onClose:()=>{i(void 0),a(),d(g+1)},onCancel:()=>{m(at[u].name,"false"),i(void 0)}}),e(G,{}),e(x,{}),Vt.map((O,W)=>o(Dn,{children:[h===O&&e(Cs,{id:n,attr:O,onClose:()=>f(void 0)}),e(Is,{clientId:n,keyInfo:l?.[W],attr:O,onChanged:i,onGenerate:(_,R)=>{c(_),R?X():V()},onImport:()=>f(O)})]},O))]})},Et="dedicated",As=({clientId:n,refresh:a,fineGrainedAccess:s,...t})=>{const{t:i}=w(),{addAlert:l,addError:r}=de(),{hasAccess:u}=De(),c=f=>f.id===Et,h=u("manage-clients")||s;return e(vi,{isDisabled:c(t)||!h,clientScope:t,type:t.type,onSelect:async f=>{try{await Si(n,t,t.type,f),l(i("clientScopeSuccess"),Z.success),a()}catch(g){r("clientScopeError",g)}}})},Rs=({clientId:n,protocol:a,clientName:s,fineGrainedAccess:t})=>{const{t:i}=w(),{addAlert:l,addError:r}=de(),{realm:u}=ge(),c=Ti(),[h,f]=p("name"),[g,d]=p(yn.none),[m,y]=p(!1),[T,C]=p(),[b,V]=p([]),G=H=>V(H.filter(({id:M})=>M!==Et)),[X,x]=p(!1),[O,W]=p(0),_=()=>W(O+1),R=H=>H.id===Et,{hasAccess:S}=De(),I=S("manage-clients")||t,B=S("view-clients")||t,D=async(H,M,oe)=>{const Ie=await E.clients.listDefaultClientScopes({id:n}),ne=await E.clients.listOptionalClientScopes({id:n}),J=await E.clientScopes.find(),ae=he=>J.find(A=>he===A.id),Ee=ne.map(he=>{const A=ae(he.id);return{...he,type:Sn.optional,description:A?.description}}),pt=Ie.map(he=>{const A=ae(he.id);return{...he,type:Sn.default,description:A?.description}}),Fe=[...Ee,...pt],ht=Fe.map(he=>he.name);C(J.filter(he=>!ht.includes(he.name)).filter(he=>he.protocol===a));const mt=h==="name"?fi(oe):bi(g),Ye=Number(H),Xe=c(Fe.filter(mt),Ci("name"));return B&&Xe.unshift({id:Et,name:i("dedicatedScopeName",{clientName:s}),type:yn.none,description:i("dedicatedScopeDescription")}),Xe.slice(Ye,Ye+Number(M))},[N,q]=Re({titleKey:i("deleteClientScope",{count:b.length,name:b[0]?.name}),messageKey:"deleteConfirmClientScopes",continueButtonLabel:"delete",continueButtonVariant:Se.danger,onConfirm:async()=>{try{await vn(n,b[0],b[0].type),l(i("clientScopeRemoveSuccess"),Z.success),_()}catch(H){r("clientScopeRemoveError",H)}}});return o(U,{children:[T&&e(ni,{clientScopes:T,clientName:s,open:m,toggleDialog:()=>y(!m),onAdd:async H=>{try{await Promise.all(H.map(async M=>await yi(n,M.scope,M.type))),l(i("clientScopeSuccess"),Z.success),_()}catch(M){r("clientScopeError",M)}}}),e(_t,{loader:D,ariaLabelKey:`clientScopeList-${O}`,searchPlaceholderKey:h==="name"?"searchByName":void 0,canSelectAll:!0,isPaginated:!0,isSearching:h==="type",onSelect:H=>G([...H]),searchTypeComponent:e(hi,{searchType:h,onSelect:H=>f(H)}),toolbarItem:o(U,{children:[e(mi,{searchType:h,type:g,onSelect:H=>f(H),onType:H=>{d(H),_()}}),I&&o(U,{children:[e(q,{}),e(ve,{children:e(L,{onClick:()=>y(!0),children:i("addClientScope")})}),e(ve,{children:e(gi,{clientId:n,selectedRows:b,refresh:_})}),e(ve,{children:e(Qt,{toggle:e(_a,{onToggle:()=>x(!X)}),isOpen:X,isPlain:!0,dropdownItems:[e(tt,{isDisabled:b.length===0,onClick:async()=>{try{await Promise.all(b.map(H=>vn(n,{...H},H.type))),x(!1),G([]),l(i("clientScopeRemoveSuccess")),_()}catch(H){r("clientScopeRemoveError",H)}},children:i("remove")},"deleteAll")]})})]})]}),columns:[{name:"name",displayKey:"assignedClientScope",cellRenderer:H=>R(H)?e(ye,{to:La({realm:u,clientId:n}),children:H.name}):H.name},{name:"type",displayKey:"assignedType",cellRenderer:H=>e(As,{clientId:n,refresh:_,...H})},{name:"description"}],actions:I?[{title:i("remove"),onRowClick:async H=>(G([H]),N(),!0)}]:[],emptyState:e(_e,{message:i("emptyClientScopes"),instructions:i("emptyClientScopesInstructions"),primaryActionText:i("emptyClientScopesPrimaryAction"),onPrimaryAction:()=>y(!0)})},O)]})},zt=({text:n,user:a,label:s})=>{const{t}=w();return a?e(na,{id:s,actions:e(aa,{children:e(oa,{id:"code",text:n,label:s})}),children:e(ct,{id:`text-area-${s}`,rows:20,value:n})}):o(Zn,{variant:"large",id:s,children:[e(yt,{headingLevel:"h2",size:"lg",children:t(`${s}No`)}),e(ea,{children:t(`${s}IsDisabled`)})]})},xs=({protocolMappers:n})=>{const[a,s]=p(0);return Ke(()=>{s(a+1)},[n]),e(_t,{loader:()=>Promise.resolve(n),ariaLabelKey:"effectiveProtocolMappers",searchPlaceholderKey:"searchForProtocol",columns:[{name:"mapperName",displayKey:"name"},{name:"containerName",displayKey:"parentClientScope"},{name:"type.category",displayKey:"category"},{name:"type.priority",displayKey:"priority"}]},a)},Es=({effectiveRoles:n})=>{const[a,s]=p(0);return Ke(()=>{s(a+1)},[n]),e(_t,{loader:()=>Promise.resolve(n),ariaLabelKey:"effectiveRoleScopeMappings",searchPlaceholderKey:"searchForRole",columns:[{name:"name",displayKey:"role"},{name:"containerId",displayKey:"origin"}]},a)},ws=({clientId:n,protocol:a})=>{const s="openid",{t}=w(),{enabled:i}=Nn(),{realm:l}=ge(),r=Ge().protocolMapperTypes[a],[u,c]=p([]),[h,f]=p(!1),[g,d]=p([s]),[m,y]=p(0),[T,C]=p(""),b=()=>C(`${new Date().getTime()}`),[V,G]=p([]),[X,x]=p([]),[O,W]=p(""),[_,R]=p(""),[S,I]=p(""),B=Ze(null),D=Ze(null),N=Ze(null),q=Ze(null),H=Ze(null),M=Le(),{hasAccess:oe}=De(),Ie=oe("view-users");return le(()=>E.clients.listOptionalClientScopes({id:n}),ne=>c(ne),[]),le(async()=>{const ne=g.join(" "),J=await E.clients.evaluatePermission({id:n,roleContainer:l,scope:ne,type:"granted"});return{mapperList:await E.clients.evaluateListProtocolMapper({id:n,scope:ne}),effectiveRoles:J}},({mapperList:ne,effectiveRoles:J})=>{G(J),ne.map(ae=>{ae.type=r.filter(Ee=>Ee.id===ae.protocolMapper)[0]}),x(ne),b()},[g]),le(async()=>{const ne=g.join(" "),J=M.getValues("user");return J?await Promise.all([E.clients.evaluateGenerateAccessToken({id:n,userId:J[0],scope:ne}),E.clients.evaluateGenerateUserInfo({id:n,userId:J[0],scope:ne}),E.clients.evaluateGenerateIdToken({id:n,userId:J[0],scope:ne})]):[]},([ne,J,ae])=>{W(et(ne)),R(et(J)),I(et(ae))},[M.getValues("user"),g]),o(U,{children:[o(fe,{variant:"light",children:[i&&e(Be,{className:"keycloak__section_intro__help",children:o(be,{children:[e(ki,{})," ",t("evaluateExplain")]})}),o(Te,{isHorizontal:!0,children:[e(v,{label:t("scopeParameter"),fieldId:"scopeParameter",labelIcon:e(k,{helpText:t("scopeParameterHelp"),fieldLabelId:"scopeParameter"}),children:o(lt,{hasGutter:!0,children:[e(Ae,{isFilled:!0,children:e(Y,{toggleId:"scopeParameter",variant:$.typeaheadMulti,typeAheadAriaLabel:t("scopeParameter"),onToggle:()=>f(!h),isOpen:h,selections:g,onSelect:(ne,J)=>{const ae=J;g.includes(ae)?ae!==s&&d(g.filter(Ee=>Ee!==ae)):d([...g,ae])},"aria-labelledby":t("scopeParameter"),placeholderText:t("scopeParameterPlaceholder"),children:u.map((ne,J)=>e(z,{value:ne.name},J))})}),e(Ae,{children:e(Bn,{className:"keycloak__scopes_evaluate__clipboard-copy",children:g.join(" ")})})]})}),Ie&&e(He,{...M,children:e(Yn,{name:"user",label:"users",helpText:t("userHelp"),defaultValue:"",variant:$.typeahead,isRequired:!0})})]})]}),o(Da,{hasGutter:!0,className:"keycloak__scopes_evaluate__tabs",children:[o(on,{span:8,children:[e(ft,{"aria-labelledby":"pf-tab-0-effectiveProtocolMappers",eventKey:0,id:"effectiveProtocolMappers",ref:B,children:e(xs,{protocolMappers:X})}),e(ft,{"aria-labelledby":"pf-tab-0-effectiveRoleScopeMappings",eventKey:1,id:"effectiveRoleScopeMappings",ref:D,hidden:!0,children:e(Es,{effectiveRoles:V})}),e(ft,{"aria-labelledby":t("generatedAccessToken"),eventKey:2,id:"tab-generated-access-token",ref:N,hidden:!0,children:e(zt,{text:O,user:M.getValues("user"),label:"generatedAccessToken"})}),e(ft,{"aria-labelledby":t("generatedIdToken"),eventKey:3,id:"tab-generated-id-token",ref:q,hidden:!0,children:e(zt,{text:S,user:M.getValues("user"),label:"generatedIdToken"})}),e(ft,{"aria-labelledby":t("generatedUserInfo"),eventKey:4,id:"tab-generated-user-info",ref:H,hidden:!0,children:e(zt,{text:_,user:M.getValues("user"),label:"generatedUserInfo"})})]}),e(on,{span:4,children:o(Ii,{id:"tabs",isVertical:!0,activeKey:m,onSelect:(ne,J)=>y(J),children:[e(ie,{id:"effectiveProtocolMappers","aria-controls":"effectiveProtocolMappers",eventKey:0,title:o(se,{children:[t("effectiveProtocolMappers")," ",e(k,{fieldLabelId:"effectiveProtocolMappers",helpText:t("effectiveProtocolMappersHelp"),noVerticalAlign:!1,unWrap:!0})]}),tabContentRef:B}),e(ie,{id:"effectiveRoleScopeMappings","aria-controls":"effectiveRoleScopeMappings",eventKey:1,title:o(se,{children:[t("effectiveRoleScopeMappings")," ",e(k,{fieldLabelId:"effectiveRoleScopeMappings",helpText:t("effectiveRoleScopeMappingsHelp"),noVerticalAlign:!1,unWrap:!0})]}),tabContentRef:D}),e(ie,{id:"generatedAccessToken","aria-controls":"generatedAccessToken",eventKey:2,title:o(se,{children:[t("generatedAccessToken")," ",e(k,{fieldLabelId:"generatedAccessToken",helpText:t("generatedAccessTokenHelp"),noVerticalAlign:!1,unWrap:!0})]}),tabContentRef:N}),e(ie,{id:"generatedIdToken","aria-controls":"generatedIdToken",eventKey:3,title:o(se,{children:[t("generatedIdToken")," ",e(k,{fieldLabelId:"generatedIdToken",helpText:t("generatedIdTokenHelp"),noVerticalAlign:!1,unWrap:!0})]}),tabContentRef:q}),e(ie,{id:"generatedUserInfo","aria-controls":"generatedUserInfo",eventKey:4,title:o(se,{children:[t("generatedUserInfo")," ",e(k,{fieldLabelId:"generatedUserInfo",helpText:t("generatedUserInfoHelp"),noVerticalAlign:!1,unWrap:!0})]}),tabContentRef:H})]},T)})]})]})},Os=({client:n})=>{const{t:a}=w(),{addAlert:s,addError:t}=de(),{realm:i}=ge(),[l,r]=p(),{hasAccess:u}=De(),c=u("manage-clients");le(()=>E.clients.getServiceAccountUser({id:n.id}),f=>r(f),[]);const h=async f=>{try{const g=f.filter(d=>d.client===void 0).map(d=>d.role).flat();await E.users.addRealmRoleMappings({id:l?.id,roles:g}),await Promise.all(f.filter(d=>d.client!==void 0).map(d=>E.users.addClientRoleMappings({id:l?.id,clientUniqueId:d.client.id,roles:[d.role]}))),s(a("roleMappingUpdatedSuccess"),Z.success)}catch(g){t("roleMappingUpdatedError",g)}};return l?o(U,{children:[o(fe,{className:"pf-u-pb-0",children:[e(qn,{className:"pf-c-alert__icon keycloak--service-account--info-text"}),e("span",{className:"pf-u-pl-sm",children:o(Qn,{i18nKey:"manageServiceAccountUser",children:["",e(ye,{to:Na({realm:i,id:l.id,tab:"settings"}),children:{link:l.username}})]})})]}),e(Ai,{name:n.clientId,id:l.id,type:"users",isManager:c||n.access?.configure,save:h})]}):e(Pe,{})},Ps=({onChange:n,value:a,save:s,client:t,toggleDownloadDialog:i,toggleDeleteDialog:l})=>{const{t:r}=w(),[u,c]=Re({titleKey:"disableConfirmTitle",messageKey:"disableConfirm",continueButtonLabel:"disable",onConfirm:()=>{n(!a),s()}}),h=Tt(()=>{const m=ai(r,t.protocol??"openid-connect");return[{text:t.bearerOnly?e(Wt,{"data-testid":"bearer-only-explainer-tooltip",content:r("explainBearerOnly"),children:e(qt,{"data-testid":"bearer-only-explainer-label",icon:e(qn,{}),children:m})}):e(qt,{children:m})}]},[t,r]),{hasAccess:f}=De(),g=f("manage-clients")||t.access?.configure,d=[e(tt,{onClick:i,children:r("downloadAdapterConfig")},"download"),e(tt,{onClick:()=>Ma(t),children:r("export")},"export"),...!xt(t)&&g?[e(Ue,{},"divider"),e(tt,{"data-testid":"delete-client",onClick:l,children:r("delete")},"delete")]:[]];return o(U,{children:[e(c,{}),e(Ga,{titleKey:t.clientId,subKey:"clientsExplain",badges:h,divider:!1,isReadOnly:!g,helpTextKey:"enableDisable",dropdownItems:d,isEnabled:a,onToggle:m=>{m?(n(m),s()):u()}})]})};function Yl(){const{t:n}=w(),{addAlert:a,addError:s}=de(),{realm:t}=ge(),{hasAccess:i}=De(),l=Un(),r=i("manage-authorization"),u=i("manage-clients"),c=i("view-clients"),h=i("view-users"),f=l(jn.AdminFineGrainedAuthz)&&r,g=rt(),[d,m]=Ce(),[y,T]=Ce(),C=Le(),{clientId:b}=Xt(),[V,G]=p(0),X=it({control:C.control,name:"clientAuthenticatorType",defaultValue:"client-secret"}),[x,O]=p(),W=async()=>{const te=await E.clients.listRoles({id:b});return $n(te,gt=>gt.name?.toUpperCase())},_=te=>Ht(Kn({realm:t,clientId:b,tab:te})),R=_("settings"),S=_("keys"),I=_("credentials"),B=_("roles"),D=_("clientScopes"),N=_("authorization"),q=_("serviceAccount"),H=_("sessions"),M=_("permissions"),oe=_("advanced"),Ie=te=>Ht(cn({realm:t,clientId:b,tab:te})),ne=Ie("setup"),J=Ie("evaluate"),ae=te=>Ht(dn({realm:t,clientId:b,tab:te})),Ee=ae("settings"),pt=ae("resources"),Fe=ae("scopes"),ht=ae("policies"),mt=ae("permissions"),Ye=ae("evaluate"),Xe=ae("export"),[he,A]=Re({titleKey:"clientDeleteConfirmTitle",messageKey:"clientDeleteConfirm",continueButtonLabel:"delete",continueButtonVariant:Se.danger,onConfirm:async()=>{try{await E.clients.del({id:b}),a(n("clientDeletedSuccess"),Z.success),g(Ka({realm:t}))}catch(te){s("clientDeleteError",te)}}}),ue=te=>{C.reset({...te}),Va(te,C.setValue),te.attributes?.["acr.loa.map"]&&C.setValue(P("attributes.acr.loa.map"),Object.entries(JSON.parse(te.attributes["acr.loa.map"])).flatMap(([gt,Nt])=>({key:gt,value:Nt})))};le(()=>E.clients.findOne({id:b}),te=>{if(!te)throw new Error(n("notFound"));O(za(te)),ue(te)},[b,V]);const Q=async({confirmed:te=!1,messageKey:gt="clientSaveSuccess"}={confirmed:!1,messageKey:"clientSaveSuccess"})=>{if(!await C.trigger())return;if(!x?.publicClient&&x?.clientAuthenticatorType!==X&&!te){T();return}const Nt=un(C.getValues()),At=un(Nt);At.attributes?.["acr.loa.map"]&&(At.attributes["acr.loa.map"]=JSON.stringify(Object.fromEntries(At.attributes["acr.loa.map"].filter(({key:we})=>we!=="").map(({key:we,value:pa})=>[we,pa]))));try{const we={...x,...At};we.clientId=we.clientId?.trim(),await E.clients.update({id:b},we),ue(we),O(we),a(n(gt),Z.success)}catch(we){s("clientSaveError",we)}};return x?o(U,{children:[e(Yt,{continueButtonLabel:"yes",cancelButtonLabel:"no",titleKey:n("changeAuthenticatorConfirmTitle",{clientAuthenticatorType:X}),open:y,toggleDialog:T,onConfirm:()=>Q({confirmed:!0}),children:e(U,{children:n("changeAuthenticatorConfirm",{clientAuthenticatorType:X})})}),e(A,{}),d&&e(Ri,{id:x.id,protocol:x.protocol,open:!0,toggleDialog:m}),e(K,{name:"enabled",control:C.control,defaultValue:!0,render:({field:te})=>e(Ps,{value:te.value,onChange:te.onChange,client:x,save:Q,toggleDeleteDialog:he,toggleDownloadDialog:m})}),e(fe,{variant:"light",className:"pf-u-p-0",children:e(He,{...C,children:o(Kt,{"data-testid":"client-tabs","aria-label":"client-tabs",isBox:!0,mountOnEnter:!0,children:[e(ie,{id:"settings","data-testid":"clientSettingsTab",title:e(se,{children:n("settings")}),...R,children:e(Bi,{client:x,save:()=>Q(),reset:()=>ue(x)})}),(!x.publicClient&&!xt(x)||x.protocol==="saml")&&o(ie,{id:"keys","data-testid":"keysTab",title:e(se,{children:n("keys")}),...S,children:[x.protocol==="openid-connect"&&e(vs,{clientId:b,save:Q,hasConfigureAccess:x.access?.configure}),x.protocol==="saml"&&e(ks,{clientId:b,save:Q})]}),!x.publicClient&&!xt(x)&&(c||x.access?.configure||x.access?.view)&&e(ie,{id:"credentials",title:e(se,{children:n("credentials")}),...I,children:e(gs,{client:x,save:Q,refresh:()=>G(V+1)},V)}),e(ie,{id:"roles","data-testid":"rolesTab",title:e(se,{children:n("roles")}),...B,children:e(ja,{loader:W,paginated:!1,messageBundle:"client",toCreate:Ha({realm:t,clientId:x.id}),toDetail:te=>Fa({realm:t,clientId:x.id,id:te,tab:"details"}),isReadOnly:!(u||x.access?.configure)})}),!xt(x)&&!x.bearerOnly&&e(ie,{id:"clientScopes","data-testid":"clientScopesTab",title:e(se,{children:n("clientScopes")}),...D,children:o(Kt,{defaultLocation:cn({realm:t,clientId:b,tab:"setup"}),children:[e(ie,{id:"setup",title:e(se,{children:n("setup")}),...ne,children:e(Rs,{clientName:x.clientId,clientId:b,protocol:x.protocol,fineGrainedAccess:x.access?.manage})}),e(ie,{id:"evaluate",title:e(se,{children:n("evaluate")}),...J,children:e(ws,{clientId:b,protocol:x.protocol})})]})}),x.authorizationServicesEnabled&&r&&e(ie,{id:"authorization","data-testid":"authorizationTab",title:e(se,{children:n("authorization")}),...N,children:o(Kt,{mountOnEnter:!0,unmountOnExit:!0,defaultLocation:dn({realm:t,clientId:b,tab:"settings"}),children:[e(ie,{id:"settings","data-testid":"authorizationSettings",title:e(se,{children:n("settings")}),...Ee,children:e(ds,{clientId:b})}),e(ie,{id:"resources","data-testid":"authorizationResources",title:e(se,{children:n("resources")}),...pt,children:e(rs,{clientId:b})}),e(ie,{id:"scopes","data-testid":"authorizationScopes",title:e(se,{children:n("scopes")}),...Fe,children:e(os,{clientId:b})}),e(ie,{id:"policies","data-testid":"authorizationPolicies",title:e(se,{children:n("policies")}),...ht,children:e(is,{clientId:b})}),e(ie,{id:"permissions","data-testid":"authorizationPermissions",title:e(se,{children:n("permissions")}),...mt,children:e(ns,{clientId:b})}),h&&e(ie,{id:"evaluate","data-testid":"authorizationEvaluate",title:e(se,{children:n("evaluate")}),...Ye,children:e(Qi,{client:x,save:Q})}),e(ie,{id:"export","data-testid":"authorizationExport",title:e(se,{children:n("export")}),...Xe,children:e(Xi,{})})]})}),x.serviceAccountsEnabled&&h&&e(ie,{id:"serviceAccount","data-testid":"serviceAccountTab",title:e(se,{children:n("serviceAccount")}),...q,children:e(Os,{client:x})}),e(ie,{id:"sessions","data-testid":"sessionsTab",title:e(se,{children:n("sessions")}),...H,children:e(Hi,{client:x})}),f&&(u||x.access?.manage)&&e(ie,{id:"permissions","data-testid":"permissionsTab",title:e(se,{children:n("permissions")}),...M,children:e(Ua,{id:x.id,type:"clients"})}),e(ie,{id:"advanced","data-testid":"advancedTab",title:e(se,{children:n("advanced")}),...oe,children:e(Ki,{save:Q,client:x})})]})})})]}):e(Pe,{})}export{Yl as default};
//# sourceMappingURL=ClientDetails-WHh2ucx3.js.map
