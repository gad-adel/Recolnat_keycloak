import{jsxs as L,jsx as t,Fragment as j}from"react/jsx-runtime";import{useState as s,useMemo as b,useEffect as E}from"react";import{u as B,a4 as F,X as $,z as A,D as z,B as k,m as J,I as N,J as W,as as X,K as P,L as q}from"./index-sihFV1NS.js";import{L as v}from"./PaginatingTableToolbar--Dt3wwL6.js";import{K as O}from"./KeycloakDataTable-Q3kZYP9q.js";import{u as G,m as w}from"./useLocaleSort-K-jL4v2R.js";import{M as H,a as Q}from"./Modal-uOAPm2rX.js";import{e as U,D as x,a as K,c as R,d as T}from"./DataListItemRow-te2VcAoi.js";const Y=a=>{const{t:o}=B(),c=F(),y=a.protocol,n=c.protocolMapperTypes[y],m=c.builtinProtocolMappers[y],[g,d]=s([]),[h,u]=s([]),M=G(),p=b(()=>M(m,w("name")).map(e=>{const i=n.filter(l=>l.id===e.protocolMapper)[0];return{item:e,id:e.name,description:i.helpText}}),[m,n]),[f,I]=s(p);if(a.filter&&a.filter.length!==g.length){d(a.filter);const e=a.filter.map(i=>i.name);I([...p.filter(i=>!e.includes(i.item.name))])}const D=b(()=>M(n,w("name")),[n]),r=!!a.filter,S=[o("name"),o("description")];return L(H,{"aria-label":o(r?"addPredefinedMappers":"emptySecondaryAction"),variant:Q.medium,header:L($,{role:"dialog","aria-label":o(r?"addPredefinedMappers":"emptySecondaryAction"),children:[t(A,{component:z.h1,children:o(r?"addPredefinedMappers":"emptySecondaryAction")}),t(A,{children:o(r?"predefinedMappingDescription":"configureMappingDescription")})]}),isOpen:a.open,onClose:a.toggleDialog,actions:r?[t(k,{id:"modal-confirm","data-testid":"confirm",isDisabled:f.length===0||h.length===0,onClick:()=>{a.onConfirm(h.map(({item:e})=>e)),a.toggleDialog()},children:o("add")},"confirm"),t(k,{id:"modal-cancel","data-testid":"cancel",variant:J.link,onClick:()=>{a.toggleDialog()},children:o("cancel")},"cancel")]:[],children:[!r&&L(U,{onSelectDataListItem:e=>{const i=n.find(l=>l.id===e);a.onConfirm(i),a.toggleDialog()},"aria-label":o("addPredefinedMappers"),isCompact:!0,children:[t(x,{"aria-label":o("headerName"),id:"header",children:t(K,{children:t(R,{dataListCells:S.map(e=>t(T,{style:{fontWeight:700},children:e},e))})})}),D.map(e=>t(x,{"aria-label":e.name,id:e.id,children:t(K,{children:t(R,{dataListCells:[t(T,{children:e.name},`name-${e.id}`),t(T,{children:e.helpText},`helpText-${e.id}`)]})})},e.id))]}),r&&t(O,{loader:f,onSelect:u,canSelectAll:!0,ariaLabelKey:"addPredefinedMappers",searchPlaceholderKey:"searchForMapper",columns:[{name:"id",displayKey:"name"},{name:"description",displayKey:"description"}],emptyState:t(v,{message:o("emptyMappers"),instructions:o("emptyBuiltInMappersInstructions")})})]})},Z=({id:a,name:o,detailLink:c})=>t(q,{to:c(a),children:o}),le=({model:a,onAdd:o,onDelete:c,detailLink:y})=>{const{t:n}=B(),[m,g]=s(!1),d=a.protocolMappers,h=F().protocolMapperTypes[a.protocol],[u,M]=s(0);E(()=>M(u+1),[d]);const[p,f]=s(!1),[I,D]=s(a.protocolMappers),r=e=>{D(e?d||[]:void 0),f(!p)},S=async()=>d?d.reduce((i,l)=>{const C=h.find(({id:V})=>V===l.protocolMapper);return C?i.concat({...l,category:C.category,type:C.name,priority:C.priority}):i},[]).sort((i,l)=>i.priority-l.priority):[];return L(j,{children:[t(Y,{protocol:a.protocol,filter:I,onConfirm:o,open:p,toggleDialog:()=>f(!p)}),t(O,{loader:S,ariaLabelKey:"clientScopeList",searchPlaceholderKey:"searchForMapper",toolbarItem:t(N,{onSelect:()=>g(!1),toggle:t(W,{isPrimary:!0,id:"mapperAction",onToggle:()=>g(!m),toggleIndicator:X,children:n("addMapper")}),isOpen:m,dropdownItems:[t(P,{onClick:()=>r(!0),children:n("fromPredefinedMapper")},"predefined"),t(P,{onClick:()=>r(!1),children:n("byConfiguration")},"byConfiguration")]}),actions:[{title:n("delete"),onRowClick:c}],columns:[{name:"name",cellRenderer:e=>t(Z,{...e,detailLink:y})},{name:"category"},{name:"type"},{name:"priority"}],emptyState:t(v,{message:n("emptyMappers"),instructions:n("emptyMappersInstructions"),secondaryActions:[{text:n("emptyPrimaryAction"),onClick:()=>r(!0)},{text:n("emptySecondaryAction"),onClick:()=>r(!1)}]})},u)]})};export{le as M};
//# sourceMappingURL=MapperList-TbLqIHFZ.js.map
