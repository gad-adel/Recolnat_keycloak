import{jsxs as v,Fragment as R,jsx as e}from"react/jsx-runtime";import{useState as p}from"react";import{d as w,u as A,f as K,M as k,r as E,m as I,j as u,A as x,B as U,L as B,g as V,e as j,O as N,h as O,P as F,dL as T,dM as P}from"./index-sihFV1NS.js";import{R as z,u as H}from"./RoutableTabs-a7VqIL_I.js";import{U as q,s as G}from"./UserFederationLdapForm-0DfckwdJ.js";import{u as J}from"./ConfirmDialog-WMVurgkl.js";import{L as Q}from"./PaginatingTableToolbar--Dt3wwL6.js";import{K as W}from"./KeycloakDataTable-Q3kZYP9q.js";import{u as X,m as Y}from"./useLocaleSort-K-jL4v2R.js";import{b as Z}from"./ToolbarContent-46I9Yg7h.js";import{E as _}from"./ExtendedHeader-PMTyt6So.js";import{a as D,b as C}from"./Tabs-wiayO8Tk.js";import"react-dom";import"./FixedButtonGroup-6gQXZmA0.js";import"./Form-bfj-xQZn.js";import"./useIsFeatureEnabled-qmmJPqO8.js";import"./FormAccess-EK-4wbwg.js";import"./copy-icon-WaWzxYgU.js";import"./SettingsCache-yRExyUF5.js";import"./ViewHeader-xo54NRb6.js";import"./useToggle-mZS4AEtR.js";import"./isEqual-guRJoAyD.js";import"./NumberInput-QtFengwl.js";import"./minus-icon-3MARcJXf.js";import"./plus-icon-zbmNbCLY.js";import"./KeycloakTextInput--S1SG2UN.js";import"./PasswordInput-P6txGPqu.js";import"./Modal-uOAPm2rX.js";import"./EmptyStateBody-jnnI7hpP.js";import"./EmptyStateSecondaryActions-G5doWCZ5.js";import"./TableToolbar-vuixsfwd.js";import"./Td-uwYquKT4.js";import"./grip-vertical-icon-accuSWkz.js";import"./_baseRest-lI6NnEVt.js";import"./MenuList-82IaVNxu.js";const $=({toDetail:s,...o})=>e(B,{to:s(o.id),children:o.name}),ee=({toCreate:s,toDetail:o})=>{const i=w(),{t:r}=A(),{addAlert:f,addError:g}=K(),[n,y]=p(0),h=()=>y(n+1),[b,S]=p([]),m=X(),{id:L}=k(),[d,c]=p();E(()=>u.components.find({parent:L,type:"org.keycloak.storage.ldap.mappers.LDAPStorageMapper"}),a=>{S(m(a.map(M=>({...M,name:M.name,type:M.providerId})),Y("name")))},[n]);const[l,t]=J({titleKey:r("deleteMappingTitle",{mapperId:d?.id}),messageKey:"deleteMappingConfirm",continueButtonLabel:"delete",continueButtonVariant:I.danger,onConfirm:async()=>{try{await u.components.del({id:d.id}),h(),f(r("mappingDeletedSuccess"),x.success),c(void 0)}catch(a){g("mappingDeletedError",a)}}});return v(R,{children:[e(t,{}),e(W,{loader:b,ariaLabelKey:"ldapMappersList",searchPlaceholderKey:"searchForMapper",toolbarItem:e(Z,{children:e(U,{"data-testid":"add-mapper-btn",variant:"primary",component:a=>e(B,{...a,to:s}),children:r("addMapper")})}),actions:[{title:r("delete"),onRowClick:a=>{c(a),l()}}],columns:[{name:"name",cellRenderer:a=>e($,{...a,toDetail:o})},{name:"type"}],emptyState:e(Q,{message:r("emptyMappers"),instructions:r("emptyMappersInstructions"),primaryActionText:r("emptyPrimaryAction"),onPrimaryAction:()=>i(s)})},n)]})};function Ie(){const{t:s}=A(),o=V({mode:"onChange"}),{realm:i}=j(),{id:r}=k(),{addAlert:f,addError:g}=K(),[n,y]=p(),[h,b]=p(0),S=()=>b(t=>t+1);E(()=>u.components.findOne({id:r}),t=>{if(!t)throw new Error(s("notFound"));y(t),c(t)},[r,h]);const m=t=>H(T({realm:i,id:r,tab:t})),L=m("settings"),d=m("mappers"),c=t=>{o.reset(t),o.setValue("config.periodicChangedUsersSync",t.config?.changedSyncPeriod?.[0]!=="-1"),o.setValue("config.periodicFullSync",t.config?.fullSyncPeriod?.[0]!=="-1")},l=async t=>{try{await u.components.update({id:r},G(t)),f(s("userProviderSaveSuccess"),x.success),S()}catch(a){g("userProviderSaveError",a)}};return n?v(O,{...o,children:[e(_,{provider:"LDAP",noDivider:!0,editMode:n.config?.editMode,save:()=>o.handleSubmit(l)()}),e(F,{variant:"light",className:"pf-u-p-0",children:v(z,{defaultLocation:T({realm:i,id:r,tab:"settings"}),isBox:!0,children:[e(D,{id:"settings",title:e(C,{children:s("settings")}),...L,children:e(F,{variant:"light",children:e(q,{id:r,onSubmit:l})})}),e(D,{id:"mappers",title:e(C,{children:s("mappers")}),"data-testid":"ldap-mappers-tab",...d,children:e(ee,{toCreate:P({realm:i,id:r,mapperId:"new"}),toDetail:t=>P({realm:i,id:r,mapperId:t})})})]})})]}):e(N,{})}export{Ie as default};
//# sourceMappingURL=UserFederationLdapSettings-cvBmQ-b1.js.map
