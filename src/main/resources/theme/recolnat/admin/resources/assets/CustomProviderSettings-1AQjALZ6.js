import{jsxs as d,Fragment as E,jsx as e}from"react/jsx-runtime";import{useState as L}from"react";import{u as N,a as O,F as c,i as l,C as I,Q as C,d as j,g as _,f as q,e as G,a4 as R,r as F,h as T,P as z,B as x,L as B,dr as U,H as K,j as p,A as Q,G as W}from"./index-sihFV1NS.js";import{D as $}from"./DynamicComponents-f6aNOnzT.js";import{F as J}from"./FormAccess-EK-4wbwg.js";import{K as g}from"./KeycloakTextInput--S1SG2UN.js";import{u as M}from"./useParams-OD1jI_R2.js";import{E as X}from"./ExtendedHeader-PMTyt6So.js";import{S as Y}from"./SettingsCache-yRExyUF5.js";import{A as Z}from"./Form-bfj-xQZn.js";import"react-dom";import"./ClientSelect-sh5SEoBO.js";import"./FileUpload-LIezXv7x.js";import"./CodeEditor-7uqvO0EK.js";import"./copy-icon-WaWzxYgU.js";import"./EmptyStateBody-jnnI7hpP.js";import"./EmptyStateSecondaryActions-G5doWCZ5.js";import"./GroupPickerDialog-gC2-xBPw.js";import"./PaginatingTableToolbar--Dt3wwL6.js";import"./TableToolbar-vuixsfwd.js";import"./ToolbarContent-46I9Yg7h.js";import"./useToggle-mZS4AEtR.js";import"./Modal-uOAPm2rX.js";import"./ConfirmDialog-WMVurgkl.js";import"./DataListItemRow-te2VcAoi.js";import"./data-list-CDN1kyj9.js";import"./grip-vertical-icon-accuSWkz.js";import"./_baseRest-lI6NnEVt.js";import"./ActionListItem-1jrwMZdM.js";import"./Flex-W2FoLD7u.js";import"./FlexItem-Mxf6oLng.js";import"./MultiLineInput-MBnUzZD_.js";import"./PasswordInput-P6txGPqu.js";import"./AddRoleMappingModal-uxjjMt5W.js";import"./useLocaleSort-K-jL4v2R.js";import"./KeycloakDataTable-Q3kZYP9q.js";import"./Td-uwYquKT4.js";import"./resource-BRtaBrSc.js";import"./filter-icon-0B3gA_nj.js";import"./KeycloakTextArea-NBwG1p2x.js";import"./ViewHeader-xo54NRb6.js";import"./isEqual-guRJoAyD.js";import"./NumberInput-QtFengwl.js";import"./minus-icon-3MARcJXf.js";import"./plus-icon-zbmNbCLY.js";const ee=()=>{const{t:r}=N(),{control:a,register:t,watch:m}=O(),n=m("config.fullSyncPeriod","-1"),u=m("config.changedSyncPeriod","-1");return d(E,{children:[e(c,{label:r("periodicFullSync"),labelIcon:e(l,{helpText:r("periodicFullSyncHelp"),fieldLabelId:"periodicFullSync"}),fieldId:"kc-periodic-full-sync",hasNoPaddingTop:!0,children:e(I,{name:"config.fullSyncPeriod",defaultValue:"-1",control:a,render:({field:o})=>e(C,{id:"kc-periodic-full-sync","data-testid":"periodic-full-sync",onChange:s=>{o.onChange(s?"604800":"-1")},isChecked:o.value!=="-1",label:r("on"),labelOff:r("off"),"aria-label":r("periodicFullSync")})})}),n!=="-1"&&e(c,{hasNoPaddingTop:!0,label:r("fullSyncPeriod"),labelIcon:e(l,{helpText:r("fullSyncPeriodHelp"),fieldLabelId:"fullSyncPeriod"}),fieldId:"kc-full-sync-period",children:e(g,{type:"number",min:-1,defaultValue:"604800",id:"kc-full-sync-period","data-testid":"full-sync-period",...t("config.fullSyncPeriod")})}),e(c,{label:r("periodicChangedUsersSync"),labelIcon:e(l,{helpText:r("periodicChangedUsersSyncHelp"),fieldLabelId:"periodicChangedUsersSync"}),fieldId:"kc-periodic-changed-users-sync",hasNoPaddingTop:!0,children:e(I,{name:"config.changedSyncPeriod",defaultValue:"-1",control:a,render:({field:o})=>e(C,{id:"kc-periodic-changed-users-sync","data-testid":"periodic-changed-users-sync",onChange:s=>{o.onChange(s?"86400":"-1")},isChecked:o.value!=="-1",label:r("on"),labelOff:r("off"),"aria-label":r("periodicChangedUsersSync")})})}),u!=="-1"&&e(c,{label:r("changedUsersSyncPeriod"),labelIcon:e(l,{helpText:r("changedUsersSyncHelp"),fieldLabelId:"changedUsersSyncPeriod"}),fieldId:"kc-changed-users-sync-period",hasNoPaddingTop:!0,children:e(g,{type:"number",min:-1,defaultValue:"86400",id:"kc-changed-users-sync-period","data-testid":"changed-users-sync-period",...t("config.changedSyncPeriod")})})]})};function Qe(){const{t:r}=N(),{id:a,providerId:t}=M(),m=j(),n=_({mode:"onChange"}),{register:u,reset:o,setValue:s,handleSubmit:S,formState:{errors:v,isDirty:w}}=n,{addAlert:A,addError:H}=q(),{realm:f}=G(),[V,D]=L(""),b=(R().componentTypes?.["org.keycloak.storage.UserStorageProvider"]||[]).find(i=>i.id===t);F(async()=>{if(a)return await p.components.findOne({id:a})},i=>{if(i)W(i,s);else if(a)throw new Error(r("notFound"))},[]),F(()=>p.realms.findOne({realm:f}),i=>D(i?.id),[]);const P=async i=>{const k=K({...i,config:Object.fromEntries(Object.entries(i.config||{}).map(([h,y])=>[h,Array.isArray(y)?y:[y]])),providerId:t,providerType:"org.keycloak.storage.UserStorageProvider",parentId:V});try{a?await p.components.update({id:a},k):(await p.components.create(k),m(U({realm:f}))),o({...i}),A(r(a?"userProviderSaveSuccess":"createUserProviderSuccess"),Q.success)}catch(h){H(`${a?"userProviderSaveError":"createUserProviderError"}`,h)}};return d(T,{...n,children:[e(X,{provider:t,save:()=>S(P)()}),e(z,{variant:"light",children:d(J,{role:"manage-realm",isHorizontal:!0,className:"keycloak__user-federation__custom-form",onSubmit:S(P),children:[e(c,{label:r("uiDisplayName"),labelIcon:e(l,{helpText:r("uiDisplayNameHelp"),fieldLabelId:"uiDisplayName"}),helperTextInvalid:r("validateName"),validated:v.name?"error":"default",fieldId:"kc-ui-display-name",isRequired:!0,children:e(g,{isRequired:!0,id:"kc-ui-display-name","data-testid":"ui-name",validated:v.name?"error":"default",...u("name",{required:!0})})}),d(T,{...n,children:[e($,{properties:b?.properties||[]}),b?.metadata.synchronizable&&e(ee,{})]}),e(Y,{form:n,unWrap:!0}),d(Z,{children:[e(x,{isDisabled:!w,variant:"primary",type:"submit","data-testid":"custom-save",children:r("save")}),e(x,{variant:"link",component:i=>e(B,{...i,to:U({realm:f})}),"data-testid":"custom-cancel",children:r("cancel")})]})]})})]})}export{Qe as default};
//# sourceMappingURL=CustomProviderSettings-1AQjALZ6.js.map
