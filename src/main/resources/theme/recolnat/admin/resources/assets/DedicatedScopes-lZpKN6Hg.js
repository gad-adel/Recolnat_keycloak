import{jsxs as h,jsx as e,Fragment as T}from"react/jsx-runtime";import{useState as C}from"react";import{u as v,f as D,aG as I,P as E,F as R,i as x,Q as P,a5 as F,j as p,A,d as O,r as L,O as j,a$ as g,bn as w}from"./index-sihFV1NS.js";import{M as k}from"./MapperList-TbLqIHFZ.js";import{R as G,u as H}from"./RoutableTabs-a7VqIL_I.js";import{V as K}from"./ViewHeader-xo54NRb6.js";import{u as N}from"./useParams-OD1jI_R2.js";import{F as V}from"./FormAccess-EK-4wbwg.js";import{R as z}from"./AddRoleMappingModal-uxjjMt5W.js";import{a as y,b as M}from"./Tabs-wiayO8Tk.js";import"react-dom";import"./PaginatingTableToolbar--Dt3wwL6.js";import"./EmptyStateBody-jnnI7hpP.js";import"./EmptyStateSecondaryActions-G5doWCZ5.js";import"./TableToolbar-vuixsfwd.js";import"./ToolbarContent-46I9Yg7h.js";import"./Form-bfj-xQZn.js";import"./KeycloakDataTable-Q3kZYP9q.js";import"./Td-uwYquKT4.js";import"./grip-vertical-icon-accuSWkz.js";import"./_baseRest-lI6NnEVt.js";import"./useLocaleSort-K-jL4v2R.js";import"./Modal-uOAPm2rX.js";import"./DataListItemRow-te2VcAoi.js";import"./data-list-CDN1kyj9.js";import"./copy-icon-WaWzxYgU.js";import"./ConfirmDialog-WMVurgkl.js";import"./resource-BRtaBrSc.js";import"./filter-icon-0B3gA_nj.js";import"./plus-icon-zbmNbCLY.js";import"./MenuList-82IaVNxu.js";const B=({client:d})=>{const{t:r}=v(),{addAlert:s,addError:m}=D(),[t,f]=C(d),{hasAccess:i}=I(),u=i("manage-clients")||t.access?.manage,S=async l=>{try{const c=l.filter(a=>a.client===void 0).map(a=>a.role).flat();await Promise.all([p.clients.addRealmScopeMappings({id:t.id},c),...l.filter(a=>a.client!==void 0).map(a=>p.clients.addClientScopeMappings({id:t.id,client:a.client.id},[a.role]))]),s(r("clientScopeSuccess"),A.success)}catch(c){m("clientScopeError",c)}},b=async()=>{const l={...t,fullScopeAllowed:!t.fullScopeAllowed};try{await p.clients.update({id:t.id},l),s(r("clientScopeSuccess"),A.success),f(l)}catch(c){m("clientScopeError",c)}};return h(E,{children:[e(V,{role:"manage-clients",fineGrainedAccess:t.access?.manage,isHorizontal:!0,children:e(R,{hasNoPaddingTop:!0,label:r("fullScopeAllowed"),labelIcon:e(x,{helpText:r("fullScopeAllowedHelp"),fieldLabelId:"fullScopeAllowed"}),fieldId:"fullScopeAllowed",children:e(P,{id:"fullScopeAllowed",label:r("on"),labelOff:r("off"),isChecked:t.fullScopeAllowed,onChange:b,"aria-label":r("fullScopeAllowed")})})}),!t.fullScopeAllowed&&h(T,{children:[e(F,{}),e(z,{name:t.clientId,id:t.id,type:"clients",save:S,isManager:u})]})]})};function ye(){const{t:d}=v(),r=O(),{realm:s,clientId:m}=N(),{addAlert:t,addError:f}=D(),[i,u]=C();L(()=>p.clients.findOne({id:m}),u,[]);const S=o=>H(g({realm:s,clientId:m,tab:o})),b=S("mappers"),l=S("scope");if(!i)return e(j,{});const c=async o=>{if(Array.isArray(o))try{await p.clients.addMultipleProtocolMappers({id:i.id},o),u(await p.clients.findOne({id:i.id})),t(d("mappingCreatedSuccess"),A.success)}catch(n){f("mappingCreatedError",n)}else{const n=o;r(w({realm:s,id:i.id,mapperId:n.id}))}},a=async o=>{try{await p.clients.delProtocolMapper({id:i.id,mapperId:o.id}),u({...i,protocolMappers:i.protocolMappers?.filter(n=>n.id!==o.id)}),t(d("mappingDeletedSuccess"),A.success)}catch(n){f("mappingDeletedError",n)}return!0};return h(T,{children:[e(K,{titleKey:i.clientId,subKey:"dedicatedScopeExplain",divider:!1}),e(E,{variant:"light",className:"pf-u-p-0",children:h(G,{isBox:!0,mountOnEnter:!0,defaultLocation:g({realm:s,clientId:m,tab:"mappers"}),children:[e(y,{title:e(M,{children:d("mappers")}),"data-testid":"mappersTab",...b,children:e(k,{model:i,onAdd:c,onDelete:a,detailLink:o=>w({realm:s,id:i.id,mapperId:o})})}),e(y,{title:e(M,{children:d("scope")}),"data-testid":"scopeTab",...l,children:e(B,{client:i})})]})})]})}export{ye as default};
//# sourceMappingURL=DedicatedScopes-lZpKN6Hg.js.map
