import{jsx as e,jsxs as c,Fragment as B}from"react/jsx-runtime";import{useState as b}from"react";import{u as j,d as E,g as L,e as q,f as H,r as N,Z as G,m as U,j as s,ax as C,O as $,K as z,P as W,F as I,V as l,i as Z,h as J,B as D,L as M,ay as Q}from"./index-sihFV1NS.js";import{u as X}from"./ConfirmDialog-WMVurgkl.js";import{D as Y}from"./DynamicComponents-f6aNOnzT.js";import{F as _}from"./FormAccess-EK-4wbwg.js";import{K as k}from"./KeycloakTextInput--S1SG2UN.js";import{V as ee}from"./ViewHeader-xo54NRb6.js";import{u as re}from"./useParams-OD1jI_R2.js";import{A as te}from"./Form-bfj-xQZn.js";import"react-dom";import"./Modal-uOAPm2rX.js";import"./ClientSelect-sh5SEoBO.js";import"./FileUpload-LIezXv7x.js";import"./CodeEditor-7uqvO0EK.js";import"./copy-icon-WaWzxYgU.js";import"./EmptyStateBody-jnnI7hpP.js";import"./EmptyStateSecondaryActions-G5doWCZ5.js";import"./GroupPickerDialog-gC2-xBPw.js";import"./PaginatingTableToolbar--Dt3wwL6.js";import"./TableToolbar-vuixsfwd.js";import"./ToolbarContent-46I9Yg7h.js";import"./useToggle-mZS4AEtR.js";import"./DataListItemRow-te2VcAoi.js";import"./data-list-CDN1kyj9.js";import"./grip-vertical-icon-accuSWkz.js";import"./_baseRest-lI6NnEVt.js";import"./ActionListItem-1jrwMZdM.js";import"./Flex-W2FoLD7u.js";import"./FlexItem-Mxf6oLng.js";import"./MultiLineInput-MBnUzZD_.js";import"./PasswordInput-P6txGPqu.js";import"./AddRoleMappingModal-uxjjMt5W.js";import"./useLocaleSort-K-jL4v2R.js";import"./KeycloakDataTable-Q3kZYP9q.js";import"./Td-uwYquKT4.js";import"./resource-BRtaBrSc.js";import"./filter-icon-0B3gA_nj.js";import"./KeycloakTextArea-NBwG1p2x.js";function Ge(){const{t:r}=j(),{id:t,providerId:d,subTab:m}=re(),p=E(),u=L({defaultValues:{providerId:d}}),{register:f,control:R,handleSubmit:S,reset:F,formState:{errors:y}}=u,{realm:n}=q(),{addAlert:g,addError:v}=H(),[h,K]=b(),[T,V]=b("");N(async()=>await Promise.all([s.realms.getClientRegistrationPolicyProviders({realm:n}),s.realms.findOne({realm:n}),t?s.components.findOne({id:t}):Promise.resolve()]),([i,o,a])=>{K(i.find(O=>O.id===d)),V(o?.id||""),F(a||{providerId:d})},[]);const P=G({control:R,defaultValue:"",name:"name"}),w=async i=>{i.config&&Object.entries(i.config).forEach(([o,a])=>i.config[o]=Array.isArray(a)?a:[a]);try{const o={...i,subType:m,parentId:T,providerType:"org.keycloak.services.clientregistration.policy.ClientRegistrationPolicy",providerId:d};if(t)await s.components.update({id:t},o);else{const{id:a}=await s.components.create(o);p(Q({id:a,realm:n,subTab:m,providerId:d}))}g(r(`provider${t?"Updated":"Create"}Success`))}catch(o){v(`provider${t?"Updated":"Create"}Error`,o)}},[x,A]=X({titleKey:"clientRegisterPolicyDeleteConfirmTitle",messageKey:r("clientRegisterPolicyDeleteConfirm",{name:P}),continueButtonLabel:"delete",continueButtonVariant:U.danger,onConfirm:async()=>{try{await s.components.del({realm:n,id:t}),g(r("clientRegisterPolicyDeleteSuccess")),p(C({realm:n,subTab:m}))}catch(i){v("clientRegisterPolicyDeleteError",i)}}});return h?c(B,{children:[e(ee,{titleKey:t?P:"createPolicy",subKey:t,dropdownItems:t?[e(z,{"data-testid":"delete",onClick:x,children:r("delete")},"delete")]:void 0}),e(A,{}),e(W,{variant:"light",children:c(_,{role:"manage-clients",isHorizontal:!0,onSubmit:S(w),children:[e(I,{label:r("provider"),fieldId:"provider",children:e(k,{id:"providerId","data-testid":"providerId",...f("providerId"),readOnly:!0})}),e(I,{label:r("name"),fieldId:"kc-name",helperTextInvalid:r("required"),validated:y.name?l.error:l.default,labelIcon:e(Z,{helpText:r("clientPolicyNameHelp"),fieldLabelId:"kc-name"}),isRequired:!0,children:e(k,{id:"kc-name","data-testid":"name",validated:y.name?l.error:l.default,...f("name",{required:!0})})}),e(J,{...u,children:e(Y,{properties:h.properties})}),c(te,{children:[e(D,{"data-testid":"save",type:"submit",children:r("save")}),e(D,{variant:"link",component:i=>e(M,{...i,to:C({realm:n,subTab:m})}),children:r("cancel")})]})]})})]}):e($,{})}export{Ge as default};
//# sourceMappingURL=DetailProvider-d_ENq0mb.js.map
