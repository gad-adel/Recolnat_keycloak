import{jsxs as s,Fragment as w,jsx as e}from"react/jsx-runtime";import{u as P,e as T,Z as R,r as y,F as d,i as n,C as m,Q as v,S as F,b as q,c as k,j as f,g as x,d as A,f as C,h as L,P as S,B as I,dr as H,A as D}from"./index-sihFV1NS.js";import{u as N}from"./useParams-OD1jI_R2.js";import{useState as O}from"react";import{F as E}from"./FormAccess-EK-4wbwg.js";import{K as c}from"./KeycloakTextInput--S1SG2UN.js";import{W as V,H as K,S as M}from"./SettingsCache-yRExyUF5.js";import{i as U}from"./isEqual-guRJoAyD.js";import{F as $,A as j}from"./Form-bfj-xQZn.js";import"react-dom";import"./copy-icon-WaWzxYgU.js";import"./ConfirmDialog-WMVurgkl.js";import"./Modal-uOAPm2rX.js";import"./ViewHeader-xo54NRb6.js";import"./ToolbarContent-46I9Yg7h.js";import"./useToggle-mZS4AEtR.js";import"./NumberInput-QtFengwl.js";import"./minus-icon-3MARcJXf.js";import"./plus-icon-zbmNbCLY.js";const W=({form:a,showSectionHeading:o=!1,showSectionDescription:u=!1})=>{const{t:r}=P(),{realm:l}=T(),[p,g]=O(!1),b=R({control:a.control,name:"config.allowPasswordAuthentication"});return y(()=>f.realms.findOne({realm:l}),t=>a.setValue("parentId",t.id),[]),s(w,{children:[o&&e(V,{title:r("requiredSettings"),description:r("kerberosRequiredSettingsDescription"),showDescription:u}),s(E,{role:"manage-realm",isHorizontal:!0,children:[s(d,{label:r("uiDisplayName"),labelIcon:e(n,{helpText:r("uiDisplayNameHelp"),fieldLabelId:"uiDisplayName"}),fieldId:"kc-ui-display-name",isRequired:!0,validated:a.formState.errors.name?"error":"default",helperTextInvalid:a.formState.errors.name?.message,children:[e(c,{hidden:!0,id:"kc-ui-providerId",defaultValue:"kerberos",...a.register("providerId")}),e(c,{hidden:!0,id:"kc-ui-providerType",defaultValue:"org.keycloak.storage.UserStorageProvider",...a.register("providerType")}),e(c,{hidden:!0,id:"kc-ui-parentId",defaultValue:l,...a.register("parentId")}),e(c,{isRequired:!0,id:"kc-ui-name","data-testid":"kerberos-name",validated:a.formState.errors.name?"error":"default","aria-label":r("uiDisplayName"),...a.register("name",{required:{value:!0,message:r("validateName")}})})]}),e(d,{label:r("kerberosRealm"),labelIcon:e(n,{helpText:r("kerberosRealmHelp"),fieldLabelId:"kc-kerberos-realm"}),fieldId:"kc-kerberos-realm",isRequired:!0,validated:a.formState.errors.config?.kerberosRealm?.[0]?"error":"default",helperTextInvalid:a.formState.errors.config?.kerberosRealm?.[0].message,children:e(c,{isRequired:!0,id:"kc-kerberos-realm","data-testid":"kerberos-realm",validated:a.formState.errors.config?.kerberosRealm?.[0]?"error":"default",...a.register("config.kerberosRealm.0",{required:{value:!0,message:r("validateRealm")}})})}),e(d,{label:r("serverPrincipal"),labelIcon:e(n,{helpText:r("serverPrincipalHelp"),fieldLabelId:"serverPrincipal"}),fieldId:"kc-server-principal",isRequired:!0,validated:a.formState.errors.config?.serverPrincipal?.[0]?"error":"default",helperTextInvalid:a.formState.errors.config?.serverPrincipal?.[0].message,children:e(c,{isRequired:!0,id:"kc-server-principal","data-testid":"kerberos-principal",validated:a.formState.errors.config?.serverPrincipal?.[0]?"error":"default",...a.register("config.serverPrincipal.0",{required:{value:!0,message:r("validateServerPrincipal")}})})}),e(d,{label:r("keyTab"),labelIcon:e(n,{helpText:r("keyTabHelp"),fieldLabelId:"keyTab"}),fieldId:"kc-key-tab",isRequired:!0,validated:a.formState.errors.config?.keyTab?.[0]?"error":"default",helperTextInvalid:a.formState.errors.config?.keyTab?.[0].message,children:e(c,{isRequired:!0,id:"kc-key-tab","data-testid":"kerberos-keytab",validated:a.formState.errors.config?.keyTab?.[0]?"error":"default",...a.register("config.keyTab.0",{required:{value:!0,message:r("validateKeyTab")}})})}),s(d,{label:r("debug"),labelIcon:e(n,{helpText:r("debugHelp"),fieldLabelId:"debug"}),fieldId:"kc-debug",hasNoPaddingTop:!0,children:[" ",e(m,{name:"config.debug",defaultValue:["false"],control:a.control,render:({field:t})=>e(v,{id:"kc-debug","data-testid":"debug",onChange:i=>t.onChange([`${i}`]),isChecked:t.value?.[0]==="true",label:r("on"),labelOff:r("off"),"aria-label":r("debug")})})]}),e(d,{label:r("allowPasswordAuthentication"),labelIcon:e(n,{helpText:r("allowPasswordAuthenticationHelp"),fieldLabelId:"allowPasswordAuthentication"}),fieldId:"kc-allow-password-authentication",hasNoPaddingTop:!0,children:e(m,{name:"config.allowPasswordAuthentication",defaultValue:["false"],control:a.control,render:({field:t})=>e(v,{id:"kc-allow-password-authentication","data-testid":"allow-password-authentication",onChange:i=>t.onChange([`${i}`]),isChecked:t.value?.[0]==="true",label:r("on"),labelOff:r("off"),"aria-label":r("allowPasswordAuthentication")})})}),U(b,["true"])?s(d,{label:r("editMode"),labelIcon:e(n,{helpText:r("editModeKerberosHelp"),fieldLabelId:"editMode"}),isRequired:!0,fieldId:"kc-edit-mode",children:[" ",e(m,{name:"config.editMode[0]",defaultValue:"READ_ONLY",control:a.control,rules:{required:!0},render:({field:t})=>s(F,{toggleId:"kc-edit-mode",required:!0,onToggle:()=>g(!p),isOpen:p,onSelect:(i,h)=>{t.onChange(h),g(!1)},selections:t.value,variant:q.single,children:[e(k,{value:"READ_ONLY",isPlaceholder:!0},0),e(k,{value:"UNSYNCED"},1)]})})]}):null,e(d,{label:r("updateFirstLogin"),labelIcon:e(n,{helpText:r("updateFirstLoginHelp"),fieldLabelId:"updateFirstLogin"}),fieldId:"kc-update-first-login",hasNoPaddingTop:!0,children:e(m,{name:"config.updateProfileFirstLogin",defaultValue:["false"],control:a.control,render:({field:t})=>e(v,{id:"kc-update-first-login","data-testid":"update-first-login",onChange:i=>t.onChange([`${i}`]),isChecked:t.value?.[0]==="true",label:r("on"),labelOff:r("off"),"aria-label":r("updateFirstLogin")})})})]})]})};function ce(){const{t:a}=P(),o=x({mode:"onChange"}),u=A(),{realm:r}=T(),{id:l}=N(),{addAlert:p,addError:g}=C();y(async()=>{if(l)return f.components.findOne({id:l})},i=>{if(i)b(i);else if(l)throw new Error(a("notFound"))},[]);const b=i=>{o.reset({...i})},t=async i=>{try{l?await f.components.update({id:l},i):(await f.components.create(i),u(`/${r}/user-federation`)),b(i),p(a(l?"userProviderSaveSuccess":"createUserProviderSuccess"),D.success)}catch(h){g(`${l?"userProviderSaveError":"createUserProviderError"}`,h)}};return s(w,{children:[e(L,{...o,children:e(K,{provider:"Kerberos",save:()=>o.handleSubmit(t)()})}),e(S,{variant:"light",children:e(W,{form:o,showSectionHeading:!0})}),s(S,{variant:"light",isFilled:!0,children:[e(M,{form:o,showSectionHeading:!0}),e($,{onSubmit:o.handleSubmit(t),children:s(j,{children:[e(I,{isDisabled:!o.formState.isDirty,variant:"primary",type:"submit","data-testid":"kerberos-save",children:a("save")}),e(I,{variant:"link",onClick:()=>u(H({realm:r})),"data-testid":"kerberos-cancel",children:a("cancel")})]})})]})]})}export{ce as default};
//# sourceMappingURL=UserFederationKerberosSettings-kgbk_tfs.js.map
