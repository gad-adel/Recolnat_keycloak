import{jsxs as h,jsx as e,Fragment as F}from"react/jsx-runtime";import*as d from"react";import{useState as $,useMemo as O,Fragment as P}from"react";import{_ as S,l as v,cJ as j,q as D,cI as H,u as C,aC as A,b0 as w,b1 as f,S as q,c as k,db as R,a as L,aI as M,Z as B,B as I,a3 as G,a6 as b}from"./index-sihFV1NS.js";import{K as _}from"./KeycloakTextInput--S1SG2UN.js";import{u as K}from"./useToggle-mZS4AEtR.js";import{M as V}from"./minus-icon-3MARcJXf.js";import{A as J,a as U}from"./ActionListItem-1jrwMZdM.js";import{E as W,a as Z}from"./EmptyStateBody-jnnI7hpP.js";const m={helperText:"pf-c-helper-text",helperTextItem:"pf-c-helper-text__item",helperTextItemIcon:"pf-c-helper-text__item-icon",helperTextItemText:"pf-c-helper-text__item-text",modifiers:{indeterminate:"pf-m-indeterminate",warning:"pf-m-warning",success:"pf-m-success",error:"pf-m-error",dynamic:"pf-m-dynamic"},themeDark:"pf-theme-dark"},x=t=>{var{children:i,className:r,component:c="div",id:a,isLiveRegion:l=!1}=t,n=S(t,["children","className","component","id","isLiveRegion"]);const o=c;return d.createElement(o,Object.assign({id:a,className:v(m.helperText,r)},l&&{"aria-live":"polite"},n),i)};x.displayName="HelperText";const z={default:"",indeterminate:m.modifiers.indeterminate,warning:m.modifiers.warning,success:m.modifiers.success,error:m.modifiers.error},T=t=>{var{children:i,className:r,component:c="div",variant:a="default",icon:l,isDynamic:n=!1,hasIcon:o=n,id:s,screenReaderText:u=`${a} status`}=t,g=S(t,["children","className","component","variant","icon","isDynamic","hasIcon","id","screenReaderText"]);const y=c;return d.createElement(y,Object.assign({className:v(m.helperTextItem,z[a],n&&m.modifiers.dynamic,r),id:s},g),l&&d.createElement("span",{className:v(m.helperTextItemIcon),"aria-hidden":!0},l),o&&!l&&d.createElement("span",{className:v(m.helperTextItemIcon),"aria-hidden":!0},(a==="default"||a==="indeterminate")&&d.createElement(V,null),a==="warning"&&d.createElement(j,null),a==="success"&&d.createElement(D,null),a==="error"&&d.createElement(H,null)),d.createElement("span",{className:v(m.helperTextItemText)},i,n&&d.createElement("span",{className:"pf-u-screen-reader"},": ",u,";")))};T.displayName="HelperTextItem";const Q=({selectItems:t,...i})=>{const{t:r}=C(),[c,a]=K(),{field:l}=A(i),[n,o]=$(!t.map(({key:s})=>s).includes(l.value));return h(w,{children:[e(f,{lg:n?2:12,children:e(q,{onToggle:()=>a(),isOpen:c,onSelect:(s,u)=>{u&&o(!1),l.onChange(u),a()},selections:n?"":[l.value],children:[e(k,{onClick:()=>o(!0),children:r("customAttribute")},"custom"),...t.map(s=>e(k,{value:s.key,children:s.label},s.key))]})}),n&&e(f,{lg:10,children:e(R,{id:"customValue","data-testid":i.name,placeholder:r("keyPlaceholder"),value:l.value,onChange:l.onChange,autoFocus:!0})})]})},X=({selectItems:t,keyValue:i,...r})=>{const{t:c}=C(),{field:a}=A(r),[l,n]=$(!1),o=O(()=>t.find(s=>s.key===i),[t,i]);return o?.values?e(q,{onToggle:s=>n(s),isOpen:l,onSelect:(s,u)=>{a.onChange(u),n(!1)},selections:a.value?[a.value]:c("choose"),placeholder:c("valuePlaceholder"),children:o.values.map(s=>e(k,{value:s},s))}):e(R,{id:"customValue","data-testid":r.name,...a})},ie=({name:t,defaultKeyValue:i})=>{const{t:r}=C(),{control:c,register:a,formState:{errors:l}}=L(),{fields:n,append:o,remove:s}=M({shouldUnregister:!0,control:c,name:t}),u=()=>o({key:"",value:""}),g=B({name:t,control:c,defaultValue:[]});return n.length>0?h(F,{children:[h(w,{hasGutter:!0,children:[e(f,{className:"pf-c-form__label",span:5,children:e("span",{className:"pf-c-form__label-text",children:r("key")})}),e(f,{className:"pf-c-form__label",span:7,children:e("span",{className:"pf-c-form__label-text",children:r("value")})}),n.map((y,p)=>{const E=!!l[t]?.[p]?.key,N=!!l[t]?.[p]?.value;return h(P,{children:[h(f,{span:5,children:[i?e(Q,{name:`${t}.${p}.key`,selectItems:i,rules:{required:!0}}):e(_,{placeholder:r("keyPlaceholder"),"aria-label":r("key"),"data-testid":`${t}-key`,...a(`${t}.${p}.key`,{required:!0}),validated:E?"error":"default",isRequired:!0}),E&&e(x,{children:e(T,{variant:"error",children:r("keyError")})})]}),h(f,{span:5,children:[i?e(X,{name:`${t}.${p}.value`,keyValue:g[p]?.key,selectItems:i,rules:{required:!0}}):e(_,{placeholder:r("valuePlaceholder"),"aria-label":r("value"),"data-testid":`${t}-value`,...a(`${t}.${p}.value`,{required:!0}),validated:N?"error":"default",isRequired:!0}),N&&e(x,{children:e(T,{variant:"error",children:r("valueError")})})]}),e(f,{span:2,children:e(I,{variant:"link",title:r("removeAttribute"),onClick:()=>s(p),"data-testid":`${t}-remove`,children:e(G,{})})})]},y.id)})]}),e(J,{children:e(U,{children:e(I,{"data-testid":`${t}-add-row`,className:"pf-u-px-0 pf-u-mt-sm",variant:"link",icon:e(b,{}),onClick:u,children:r("addAttribute")})})})]}):h(W,{"data-testid":`${t}-empty-state`,className:"pf-u-p-0",variant:"xs",children:[e(Z,{children:r("missingAttributes")}),e(I,{"data-testid":`${t}-add-row`,variant:"link",icon:e(b,{}),isSmall:!0,onClick:u,children:r("addAttribute")})]})};export{ie as K};
//# sourceMappingURL=KeyValueInput-CbiNnu-2.js.map
