import{jsx as e,jsxs as w,Fragment as F}from"react/jsx-runtime";import{useState as p}from"react";import{u as M,a as U,r as k,F as l,i,C as D,S as j,b as z,j as u,c as E,f as G,g as q,d as Q,af as W,A as N,b7 as H,O as J,K as X,P as Y,h as Z,V as A,Q as $,B as V,m as ee,L as re,H as ae,aV as te,G as se}from"./index-sihFV1NS.js";import{u as oe}from"./ConfirmDialog-WMVurgkl.js";import{F as ne}from"./FormAccess-EK-4wbwg.js";import{K as le}from"./KeyValueInput-CbiNnu-2.js";import{K as v}from"./KeycloakTextInput--S1SG2UN.js";import{M as ie}from"./MultiLineInput-MBnUzZD_.js";import{V as ce}from"./ViewHeader-xo54NRb6.js";import{u as de}from"./useParams-OD1jI_R2.js";import{A as ue}from"./Form-bfj-xQZn.js";import"react-dom";import"./Modal-uOAPm2rX.js";import"./copy-icon-WaWzxYgU.js";import"./useToggle-mZS4AEtR.js";import"./minus-icon-3MARcJXf.js";import"./ActionListItem-1jrwMZdM.js";import"./EmptyStateBody-jnnI7hpP.js";import"./ToolbarContent-46I9Yg7h.js";const pe=({clientId:r})=>{const{t:c}=M(),{control:S}=U(),[T,x]=p(!1),[m,C]=p(),[h,f]=p("");k(()=>{const t={id:r,first:0,max:20,deep:!1,name:h};return u.clients.listAllScopes(t)},C,[h]);const b=t=>t?.map(o=>e(E,{value:o,children:o.name},o.id));return e(l,{label:c("authorizationScopes"),labelIcon:e(i,{helpText:c("clientScopesHelp"),fieldLabelId:"scopes"}),fieldId:"scopes",children:e(D,{name:"scopes",defaultValue:[],control:S,render:({field:t})=>e(j,{toggleId:"scopes",variant:z.typeaheadMulti,chipGroupProps:{numChips:3,expandedText:c("hide"),collapsedText:c("showRemaining")},onToggle:x,isOpen:T,selections:t.value.map(o=>o.name),onFilter:(o,d)=>(f(d),b(m)),onSelect:(o,d)=>{const y=typeof d=="string"?d:d.name,R=t.value.find(s=>s.name===y)?t.value.filter(s=>s.name!==y):[...t.value,d];t.onChange(R)},onClear:o=>{o.stopPropagation(),f(""),t.onChange([])},typeAheadAriaLabel:c("authorizationScopes"),children:b(m)})})})};function He(){const{t:r}=M(),[c,S]=p(),[T,x]=p(),[m,C]=p(),{addAlert:h,addError:f}=G(),b=q({mode:"onChange"}),{register:t,formState:{errors:o},control:d,setValue:y,handleSubmit:R}=b,{id:s,resourceId:n,realm:L}=de(),P=Q(),O=(a={})=>{se(a,y)};k(()=>Promise.all([u.clients.findOne({id:s}),n?u.clients.getResource({id:s,resourceId:n}):Promise.resolve(void 0),n?u.clients.listPermissionsByResource({id:s,resourceId:n}):Promise.resolve(void 0)]),([a,I,g])=>{if(!a)throw new Error(r("notFound"));S(a),C(g),x(I),O(I)},[]);const K=async a=>{const I=ae(a);try{if(n)await u.clients.updateResource({id:s,resourceId:n},I);else{const g=await u.clients.createResource({id:s},I);P(te({realm:L,id:s,resourceId:g._id}))}h(r((n?"update":"create")+"ResourceSuccess"),N.success)}catch(g){f("resourceSaveError",g)}},[_,B]=oe({titleKey:"deleteResource",children:w(F,{children:[r("deleteResourceConfirm"),m?.length!==0&&e(W,{variant:"warning",isInline:!0,isPlain:!0,title:r("deleteResourceWarning"),className:"pf-u-pt-lg",children:e("p",{className:"pf-u-pt-xs",children:m?.map(a=>e("strong",{className:"pf-u-pr-md",children:a.name},a.id))})})]}),continueButtonLabel:"confirm",onConfirm:async()=>{try{await u.clients.delResource({id:s,resourceId:n}),h(r("resourceDeletedSuccess"),N.success),P(H({realm:L,clientId:s,tab:"resources"}))}catch(a){f("resourceDeletedError",a)}}});return c?w(F,{children:[e(B,{}),e(ce,{titleKey:n?T?.name:"createResource",dropdownItems:n?[e(X,{"data-testid":"delete-resource",onClick:()=>_(),children:r("delete")},"delete")]:void 0}),e(Y,{variant:"light",children:e(Z,{...b,children:w(ne,{isHorizontal:!0,role:"view-clients",className:"keycloak__resource-details__form",onSubmit:R(K),children:[e(l,{label:r("owner"),fieldId:"owner",labelIcon:e(i,{helpText:r("ownerHelp"),fieldLabelId:"owner"}),children:e(v,{id:"owner",value:c.clientId,isReadOnly:!0})}),e(l,{label:r("name"),fieldId:"name",labelIcon:e(i,{helpText:r("resourceNameHelp"),fieldLabelId:"name"}),helperTextInvalid:r("required"),validated:o.name?A.error:A.default,isRequired:!0,children:e(v,{id:"name",validated:o.name?A.error:A.default,...t("name",{required:!0})})}),e(l,{label:r("displayName"),fieldId:"displayName",labelIcon:e(i,{helpText:r("displayNameHelp"),fieldLabelId:"name"}),children:e(v,{id:"displayName",...t("displayName")})}),e(l,{label:r("type"),fieldId:"type",labelIcon:e(i,{helpText:r("clientTypeHelp"),fieldLabelId:"type"}),children:e(v,{id:"type",...t("type")})}),e(l,{label:r("uris"),fieldId:"uris",labelIcon:e(i,{helpText:r("urisHelp"),fieldLabelId:"uris"}),children:e(ie,{name:"uris",type:"url","aria-label":r("uris"),addButtonLabel:"addUri"})}),e(pe,{clientId:s}),e(l,{label:r("iconUri"),fieldId:"iconUri",labelIcon:e(i,{helpText:r("iconUriHelp"),fieldLabelId:"iconUri"}),children:e(v,{id:"iconUri",type:"url",...t("icon_uri")})}),e(l,{hasNoPaddingTop:!0,label:r("ownerManagedAccess"),labelIcon:e(i,{helpText:r("ownerManagedAccessHelp"),fieldLabelId:"ownerManagedAccess"}),fieldId:"ownerManagedAccess",children:e(D,{name:"ownerManagedAccess",control:d,defaultValue:!1,render:({field:a})=>e($,{id:"ownerManagedAccess",label:r("on"),labelOff:r("off"),isChecked:a.value,onChange:a.onChange,"aria-label":r("ownerManagedAccess")})})}),e(l,{hasNoPaddingTop:!0,label:r("resourceAttribute"),labelIcon:e(i,{helpText:r("resourceAttributeHelp"),fieldLabelId:"resourceAttribute"}),fieldId:"resourceAttribute",children:e(le,{name:"attributes"})}),e(ue,{children:w("div",{className:"pf-u-mt-md",children:[e(V,{variant:ee.primary,type:"submit","data-testid":"save",children:r("save")}),e(V,{variant:"link","data-testid":"cancel",component:a=>e(re,{...a,to:H({realm:L,clientId:s,tab:"resources"})}),children:r("cancel")})]})})]})})})]}):e(J,{})}export{He as default};
//# sourceMappingURL=ResourceDetails-k0MKlrXl.js.map
