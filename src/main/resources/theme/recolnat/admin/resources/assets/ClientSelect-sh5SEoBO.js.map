{"version":3,"file":"ClientSelect-sh5SEoBO.js","sources":["../../src/components/client/ClientSelect.tsx"],"sourcesContent":["import type ClientRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/clientRepresentation\";\nimport type { ClientQuery } from \"@keycloak/keycloak-admin-client/lib/resources/clients\";\nimport {\n  FormGroup,\n  Select,\n  SelectOption,\n  SelectVariant,\n} from \"@patternfly/react-core\";\nimport { useState } from \"react\";\nimport { Controller, useFormContext } from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\nimport { HelpItem } from \"ui-shared\";\n\nimport { adminClient } from \"../../admin-client\";\nimport { useFetch } from \"../../utils/useFetch\";\nimport type { ComponentProps } from \"../dynamic/components\";\n\ntype ClientSelectProps = ComponentProps & {};\n\nexport const ClientSelect = ({\n  name,\n  label,\n  helpText,\n  defaultValue,\n  isDisabled = false,\n  required = false,\n}: ClientSelectProps) => {\n  const { t } = useTranslation();\n  const {\n    control,\n    formState: { errors },\n  } = useFormContext();\n\n  const [open, setOpen] = useState(false);\n  const [clients, setClients] = useState<ClientRepresentation[]>([]);\n  const [search, setSearch] = useState(\"\");\n\n  useFetch(\n    () => {\n      const params: ClientQuery = {\n        max: 20,\n      };\n      if (search) {\n        params.clientId = search;\n        params.search = true;\n      }\n      return adminClient.clients.find(params);\n    },\n    (clients) => setClients(clients),\n    [search],\n  );\n\n  const convert = (clients: ClientRepresentation[]) => [\n    <SelectOption key=\"empty\" value=\"\">\n      {t(\"none\")}\n    </SelectOption>,\n    ...clients.map((option) => (\n      <SelectOption key={option.id} value={option.clientId} />\n    )),\n  ];\n\n  return (\n    <FormGroup\n      label={t(label!)}\n      isRequired={required}\n      labelIcon={<HelpItem helpText={t(helpText!)} fieldLabelId={label!} />}\n      fieldId={name!}\n      validated={errors[name!] ? \"error\" : \"default\"}\n      helperTextInvalid={t(\"required\")}\n    >\n      <Controller\n        name={name!}\n        defaultValue={defaultValue || \"\"}\n        control={control}\n        rules={required ? { required: true } : {}}\n        render={({ field }) => (\n          <Select\n            toggleId={name}\n            variant={SelectVariant.typeahead}\n            onToggle={(open) => setOpen(open)}\n            isOpen={open}\n            isDisabled={isDisabled}\n            selections={field.value}\n            onFilter={(_, value) => {\n              setSearch(value);\n              return convert(clients);\n            }}\n            onSelect={(_, value) => {\n              field.onChange(value.toString());\n              setOpen(false);\n            }}\n            typeAheadAriaLabel={t(label!)}\n          >\n            {convert(clients)}\n          </Select>\n        )}\n      />\n    </FormGroup>\n  );\n};\n"],"names":["ClientSelect","name","label","helpText","defaultValue","isDisabled","required","t","useTranslation","control","errors","useFormContext","open","setOpen","useState","clients","setClients","search","setSearch","useFetch","params","adminClient","convert","SelectOption","option","jsx","FormGroup","HelpItem","Controller","field","Select","SelectVariant","_","value"],"mappings":"gLAmBO,MAAMA,EAAe,CAAC,CAC3B,KAAAC,EACA,MAAAC,EACA,SAAAC,EACA,aAAAC,EACA,WAAAC,EAAa,GACb,SAAAC,EAAW,EACb,IAAyB,CACjB,KAAA,CAAE,EAAAC,GAAMC,IACR,CACJ,QAAAC,EACA,UAAW,CAAE,OAAAC,CAAO,GAClBC,EAAe,EAEb,CAACC,EAAMC,CAAO,EAAIC,EAAS,EAAK,EAChC,CAACC,EAASC,CAAU,EAAIF,EAAiC,CAAE,CAAA,EAC3D,CAACG,EAAQC,CAAS,EAAIJ,EAAS,EAAE,EAEvCK,EACE,IAAM,CACJ,MAAMC,EAAsB,CAC1B,IAAK,EAAA,EAEP,OAAIH,IACFG,EAAO,SAAWH,EAClBG,EAAO,OAAS,IAEXC,EAAY,QAAQ,KAAKD,CAAM,CACxC,EACCL,GAAYC,EAAWD,CAAO,EAC/B,CAACE,CAAM,CAAA,EAGH,MAAAK,EAAWP,GAAoC,GAClDQ,EAAyB,CAAA,MAAM,GAC7B,SAAEhB,EAAA,MAAM,GADO,OAElB,EACA,GAAGQ,EAAQ,IAAKS,GACdC,EAACF,EAA6B,CAAA,MAAOC,EAAO,QAAA,EAAzBA,EAAO,EAA4B,CACvD,CAAA,EAID,OAAAC,EAACC,EAAA,CACC,MAAOnB,EAAEL,CAAM,EACf,WAAYI,EACZ,YAAYqB,EAAS,CAAA,SAAUpB,EAAEJ,CAAS,EAAG,aAAcD,EAAQ,EACnE,QAASD,EACT,UAAWS,EAAOT,CAAK,EAAI,QAAU,UACrC,kBAAmBM,EAAE,UAAU,EAE/B,SAAAkB,EAACG,EAAA,CACC,KAAA3B,EACA,aAAcG,GAAgB,GAC9B,QAAAK,EACA,MAAOH,EAAW,CAAE,SAAU,IAAS,CAAC,EACxC,OAAQ,CAAC,CAAE,MAAAuB,CAAA,IACTJ,EAACK,EAAA,CACC,SAAU7B,EACV,QAAS8B,EAAc,UACvB,SAAWnB,GAASC,EAAQD,CAAI,EAChC,OAAQA,EACR,WAAAP,EACA,WAAYwB,EAAM,MAClB,SAAU,CAACG,EAAGC,KACZf,EAAUe,CAAK,EACRX,EAAQP,CAAO,GAExB,SAAU,CAACiB,EAAGC,IAAU,CAChBJ,EAAA,SAASI,EAAM,SAAU,CAAA,EAC/BpB,EAAQ,EAAK,CACf,EACA,mBAAoBN,EAAEL,CAAM,EAE3B,WAAQa,CAAO,CAAA,CAClB,CAAA,CAEJ,CAAA,CAAA,CAGN"}