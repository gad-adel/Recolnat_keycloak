import{jsxs as A,Fragment as F,jsx as t}from"react/jsx-runtime";import{useState as l}from"react";import{e as N,u as R,f as E,m as G,j as m,A as I,a8 as J,P as Q,B as X,L as O,ah as Y,I as Z,ai as _,K as $,aj as k,ag as ee}from"./index-sihFV1NS.js";import{g as te}from"./utils-9X4NJJvK.js";import{A as d,r as oe,a as re,c as ne,C as L}from"./ClientScopeTypes-Hwl8E8GJ.js";import{u as ae}from"./ConfirmDialog-WMVurgkl.js";import{K as le}from"./KeycloakDataTable-Q3kZYP9q.js";import{V as ce}from"./ViewHeader-xo54NRb6.js";import{u as se,m as ie}from"./useLocaleSort-K-jL4v2R.js";import{S as pe,a as me,C as de,n as Se,t as ue,p as ye}from"./SearchFilter-geHnFeJ7.js";import{b}from"./ToolbarContent-46I9Yg7h.js";import{N as B}from"./Td-uwYquKT4.js";import"react-dom";import"./Modal-uOAPm2rX.js";import"./PaginatingTableToolbar--Dt3wwL6.js";import"./EmptyStateBody-jnnI7hpP.js";import"./EmptyStateSecondaryActions-G5doWCZ5.js";import"./TableToolbar-vuixsfwd.js";import"./Form-bfj-xQZn.js";import"./_baseRest-lI6NnEVt.js";import"./filter-icon-0B3gA_nj.js";import"./grip-vertical-icon-accuSWkz.js";const fe=r=>{const{t:o}=R(),{addAlert:c,addError:S}=E();return t(re,{clientScope:r,type:r.type,all:!0,onSelect:async u=>{try{await ne(r,u),c(o("clientScopeSuccess"),I.success),r.refresh()}catch(i){S("clientScopeError",i)}}})},he=({id:r,name:o})=>{const{realm:c}=N();return t(O,{to:ee({realm:c,id:r,tab:"settings"}),children:o},r)};function He(){const{realm:r}=N(),{t:o}=R(),{addAlert:c,addError:S}=E(),[u,i]=l(!1),[s,y]=l([]),[n,w]=l("name"),[T,f]=l(d.none),[K,h]=l("all"),V=se(),[D,j]=l(0),a=()=>{y([]),j(D+1)},v=async(e,p,U)=>{const H=await m.clientScopes.listDefaultClientScopes(),M=await m.clientScopes.listDefaultOptionalClientScopes(),W=await m.clientScopes.find(),q=n==="name"?Se(U):n==="type"?ue(T):ye(K),z=W.map(g=>({...g,type:H.find(C=>C.name===g.name)?L.default:M.find(C=>C.name===g.name)?L.optional:d.none})).filter(q);return V(z,ie("name")).slice(e,Number(e)+Number(p))},[P,x]=ae({titleKey:o("deleteClientScope",{count:s.length,name:s[0]?.name}),messageKey:"deleteConfirmClientScopes",continueButtonLabel:"delete",continueButtonVariant:G.danger,onConfirm:async()=>{try{for(const e of s){try{await oe(e)}catch(p){console.warn("could not remove scope",p.response?.data?.errorMessage||p)}await m.clientScopes.del({id:e.id})}c(o("deletedSuccessClientScope"),I.success),a()}catch(e){S("deleteErrorClientScope",e)}}});return A(F,{children:[t(x,{}),t(ce,{titleKey:"clientScopes",subKey:"clientScopeExplain",helpUrl:J.clientScopesUrl}),t(Q,{variant:"light",className:"pf-u-p-0",children:t(le,{loader:v,ariaLabelKey:"clientScopeList",searchPlaceholderKey:n==="name"?"searchForClientScope":void 0,isSearching:n!=="name",searchTypeComponent:t(pe,{searchType:n,onSelect:e=>w(e),withProtocol:!0}),isPaginated:!0,onSelect:e=>y([...e]),canSelectAll:!0,toolbarItem:A(F,{children:[t(me,{searchType:n,type:T,onSelect:e=>{w(e),h("all"),f(d.none),a()},onType:e=>{f(e),h("all"),a()},protocol:K,onProtocol:e=>{h(e),f(d.none),a()}}),t(b,{children:t(X,{component:e=>t(O,{...e,to:Y({realm:r})}),children:o("createClientScope")})}),t(b,{children:t(de,{selectedRows:s,refresh:a})}),t(b,{children:t(Z,{toggle:t(_,{onToggle:i}),isOpen:u,isPlain:!0,dropdownItems:[t($,{component:"button",isDisabled:s.length===0,onClick:()=>{P(),i(!1)},children:o("delete")},"action")]})})]}),actions:[{title:o("delete"),onRowClick:e=>{y([e]),P()}}],columns:[{name:"name",cellRenderer:he},{name:"type",displayKey:"assignedType",cellRenderer:e=>t(fe,{...e,refresh:a})},{name:"protocol",displayKey:"protocol",cellRenderer:e=>te(o,e.protocol??"openid-connect"),transforms:[B(15)]},{name:"attributes['gui.order']",displayKey:"displayOrder",cellFormatters:[k()],transforms:[B(15)]},{name:"description",cellFormatters:[k()]}]},D)})]})}export{He as default};
//# sourceMappingURL=ClientScopesSection-BxmHerOm.js.map
