import{jsxs as j,jsx as f,Fragment as U}from"react/jsx-runtime";import*as n from"react";import{useState as q}from"react";import{l as c,B as I,m as P,aq as ze,ar as xe,n as Q,as as ye,at as X,_ as Y,au as Ee,T as Te,av as Ie,u as Z,a as ke,an as Be,F as _e,i as Le,C as Ae,S as Fe,b as De,c as We,e as Oe,d as Pe,f as je,g as Ve,P as Me,h as He,aw as Ge,H as Je,j as Ke,A as $e,am as Re}from"./index-sihFV1NS.js";import{F as ee}from"./FormAccess-EK-4wbwg.js";import{V as Ue}from"./ViewHeader-xo54NRb6.js";import{C as qe,a as Qe}from"./ClientDescription-nfMy2LGM.js";import{g as Xe}from"./utils-9X4NJJvK.js";import{L as Ye}from"./LoginSettings-OF4uI7Gm.js";import{M as Ze,a as et}from"./Modal-uOAPm2rX.js";import"react-dom";import"./copy-icon-WaWzxYgU.js";import"./Form-bfj-xQZn.js";import"./ToolbarContent-46I9Yg7h.js";import"./useIsFeatureEnabled-qmmJPqO8.js";import"./SwitchControl-KreblmOr.js";import"./KeycloakTextInput--S1SG2UN.js";import"./MultiLineInput-MBnUzZD_.js";const l={button:"pf-c-button",card:"pf-c-card",drawer:"pf-c-drawer",modalBox:"pf-c-modal-box",modifiers:{finished:"pf-m-finished",expanded:"pf-m-expanded",current:"pf-m-current",expandable:"pf-m-expandable",disabled:"pf-m-disabled",noPadding:"pf-m-no-padding"},pageMainWizard:"pf-c-page__main-wizard",themeDark:"pf-theme-dark",wizard:"pf-c-wizard",wizardClose:"pf-c-wizard__close",wizardDescription:"pf-c-wizard__description",wizardFooter:"pf-c-wizard__footer",wizardFooterCancel:"pf-c-wizard__footer-cancel",wizardHeader:"pf-c-wizard__header",wizardInnerWrap:"pf-c-wizard__inner-wrap",wizardMain:"pf-c-wizard__main",wizardMainBody:"pf-c-wizard__main-body",wizardNav:"pf-c-wizard__nav",wizardNavItem:"pf-c-wizard__nav-item",wizardNavLink:"pf-c-wizard__nav-link",wizardNavLinkText:"pf-c-wizard__nav-link-text",wizardNavLinkToggle:"pf-c-wizard__nav-link-toggle",wizardNavLinkToggleIcon:"pf-c-wizard__nav-link-toggle-icon",wizardNavList:"pf-c-wizard__nav-list",wizardOuterWrap:"pf-c-wizard__outer-wrap",wizardTitle:"pf-c-wizard__title",wizardToggle:"pf-c-wizard__toggle",wizardToggleIcon:"pf-c-wizard__toggle-icon",wizardToggleList:"pf-c-wizard__toggle-list",wizardToggleListItem:"pf-c-wizard__toggle-list-item",wizardToggleNum:"pf-c-wizard__toggle-num",wizardToggleSeparator:"pf-c-wizard__toggle-separator"},te=({onNext:o,onBack:r,onClose:d,isValid:e,firstStep:t,activeStep:a,nextButtonText:i,backButtonText:s,cancelButtonText:p})=>n.createElement("footer",{className:c(l.wizardFooter)},n.createElement(I,{variant:P.primary,type:"submit",onClick:o,isDisabled:!e},i),!a.hideBackButton&&n.createElement(I,{variant:P.secondary,onClick:r,isDisabled:t},s),!a.hideCancelButton&&n.createElement("div",{className:l.wizardFooterCancel},n.createElement(I,{variant:P.link,onClick:d},p)));te.displayName="WizardFooterInternal";const ae=({hasDrawer:o,wrapper:r,children:d})=>o?r(d):d;ae.displayName="WizardDrawerWrapper";const ne=({children:o,hasNoBodyPadding:r=!1,"aria-label":d,"aria-labelledby":e,mainComponent:t="div",hasDrawer:a,isDrawerExpanded:i,onExpandDrawer:s,activeStep:p})=>{const m=t;return n.createElement(m,{"aria-label":d,"aria-labelledby":e,className:c(l.wizardMain)},n.createElement(ae,{hasDrawer:a&&p.drawerPanelContent,wrapper:w=>n.createElement(ze,{isInline:!0,isExpanded:i,onExpand:s},n.createElement(xe,{panelContent:p.drawerPanelContent},w))},n.createElement("div",{className:c(l.wizardMainBody,r&&l.modifiers.noPadding)},o)))};ne.displayName="WizardBody";const ie=({isNavOpen:o,onNavToggle:r,nav:d,steps:e,activeStep:t,children:a,hasNoBodyPadding:i=!1,"aria-label":s="Wizard Toggle",mainAriaLabelledBy:p=null,mainAriaLabel:m=null,isInPage:w=!0,hasDrawer:u,isDrawerExpanded:C,onExpandDrawer:z})=>{let b,y,N;for(let g=0;g<e.length;g++)if(t.id&&e[g].id===t.id||e[g].name===t.name){b=g+1,y=e[g].name;break}else if(e[g].steps){for(const h of e[g].steps)if(t.id&&h.id===t.id||h.name===t.name){b=g+1,y=e[g].name,N=h.name;break}}return n.createElement(n.Fragment,null,n.createElement("button",{onClick:()=>r(!o),className:c(l.wizardToggle,o&&"pf-m-expanded"),"aria-label":s,"aria-expanded":o},n.createElement("span",{className:c(l.wizardToggleList)},n.createElement("span",{className:c(l.wizardToggleListItem)},n.createElement("span",{className:c(l.wizardToggleNum)},b)," ",y,N&&n.createElement(Q,{className:c(l.wizardToggleSeparator),"aria-hidden":"true"})),N&&n.createElement("span",{className:c(l.wizardToggleListItem)},N)),n.createElement("span",{className:c(l.wizardToggleIcon)},n.createElement(ye,{"aria-hidden":"true"}))),n.createElement("div",{className:c(l.wizardOuterWrap)},n.createElement("div",{className:c(l.wizardInnerWrap)},d(o),n.createElement(ne,{mainComponent:w?"div":"main","aria-label":m,"aria-labelledby":p,hasNoBodyPadding:i,activeStep:t,isDrawerExpanded:C,onExpandDrawer:z,hasDrawer:u},u&&!C&&t.drawerToggleButton,t.component)),a))};ie.displayName="WizardToggle";const F=({children:o,"aria-label":r,"aria-labelledby":d,isOpen:e=!1,returnList:t=!1,ouiaId:a,ouiaSafe:i=!0})=>{const s=X(F.displayName,a,i),p=n.createElement("ol",{className:c(l.wizardNavList)},o);return t?p:n.createElement("nav",Object.assign({className:c(l.wizardNav,e&&l.modifiers.expanded),"aria-label":r,"aria-labelledby":d},s),n.createElement("ol",{className:c(l.wizardNavList)},o))};F.displayName="WizardNav";const _=o=>{var{children:r=null,content:d="",isCurrent:e=!1,isDisabled:t=!1,step:a,onNavItemClick:i=()=>{},navItemComponent:s="button",href:p=null,isExpandable:m=!1,id:w,ouiaId:u,ouiaSafe:C=!0}=o,z=Y(o,["children","content","isCurrent","isDisabled","step","onNavItemClick","navItemComponent","href","isExpandable","id","ouiaId","ouiaSafe"]);const b=X(_.displayName,u,C),y=s,[N,g]=n.useState(!1);n.useEffect(()=>{g(e)},[e]);const h={disabled:t},E={tabIndex:t?-1:void 0,href:p};return n.createElement("li",{className:c(l.wizardNavItem,m&&l.modifiers.expandable,m&&N&&l.modifiers.expanded)},n.createElement(y,Object.assign({},z,s==="a"?Object.assign({},E):Object.assign({},h),w&&{id:w.toString()},{onClick:()=>m?g(!N||e):i(a),className:c(l.wizardNavLink,e&&l.modifiers.current,t&&l.modifiers.disabled),"aria-disabled":t?!0:null,"aria-current":e&&!r?"step":!1},m&&{"aria-expanded":N},b),m?n.createElement(n.Fragment,null,n.createElement("span",{className:c(l.wizardNavLinkText)},d),n.createElement("span",{className:c(l.wizardNavLinkToggle)},n.createElement("span",{className:c(l.wizardNavLinkToggleIcon)},n.createElement(Q,null)))):d),r)};_.displayName="WizardNavItem";const re=n.createContext({goToStepById:()=>null,goToStepByName:()=>null,onNext:()=>null,onBack:()=>null,onClose:()=>null,activeStep:{name:null}}),tt=re.Provider,at=re.Consumer,se=({onClose:o=()=>{},title:r,description:d,hideClose:e,closeButtonAriaLabel:t,titleId:a,descriptionComponent:i="p",descriptionId:s})=>n.createElement("div",{className:c(l.wizardHeader)},!e&&n.createElement(I,{variant:"plain",className:c(l.wizardClose),"aria-label":t,onClick:o},n.createElement(Ee,{"aria-hidden":"true"})),n.createElement(Te,{headingLevel:"h2",size:"3xl",className:c(l.wizardTitle),"aria-label":r,id:a},r||n.createElement(n.Fragment,null,"Â ")),d&&n.createElement(i,{className:c(l.wizardDescription),id:s},d));se.displayName="WizardHeader";class B extends n.Component{constructor(r){super(r),this.handleKeyClicks=e=>{e.key===Ie.Escape&&(this.state.isNavOpen?this.setState({isNavOpen:!this.state.isNavOpen}):this.props.isOpen&&this.props.onClose())},this.onNext=()=>{const{onNext:e,onClose:t,onSave:a}=this.props,{currentStep:i}=this.state,s=this.getFlattenedSteps(),p=s.length;if(i>=p)return a?a():t();{let m=i;for(let b=i;b<=p;b++){if(!s[b])return;if(!s[b].isDisabled){m=b+1;break}}this.setCurrentStep(m,s[m-1]);const{id:w,name:u}=s[i-1],{id:C,name:z}=s[m-1];return e&&e({id:C,name:z},{prevId:w,prevName:u})}},this.onBack=()=>{const{onBack:e}=this.props,{currentStep:t}=this.state,a=this.getFlattenedSteps();if(a.length<t){const i=a.length;this.setCurrentStep(i,a[i-1])}else{let i=t;for(let u=t;u>=0;u--){if(!a[u-2])return;if(!a[u-2].isDisabled){i=u-1<=1?1:u-1;break}}this.setCurrentStep(i,a[i-1]);const{id:s,name:p}=a[i],{id:m,name:w}=a[i-1];return e&&e({id:m,name:w},{prevId:s,prevName:p})}},this.goToStep=e=>{const t=this.getFlattenedSteps();if(t[e-1].isDisabled)return;const{onGoToStep:a}=this.props,{currentStep:i}=this.state,s=t.length;e<1?e=1:e>s&&(e=s),this.setCurrentStep(e,t[e-1]),this.setState({isNavOpen:!1});const{id:p,name:m}=t[i-1],{id:w,name:u}=t[e-1];return a&&a({id:w,name:u},{prevId:p,prevName:m})},this.goToStepById=e=>{const t=this.getFlattenedSteps();let a;for(let i=0;i<t.length;i++)if(t[i].id===e){a=i+1;break}a&&this.setCurrentStep(a,t[a-1])},this.goToStepByName=e=>{const t=this.getFlattenedSteps();let a;for(let i=0;i<t.length;i++)if(t[i].name===e){a=i+1;break}a&&this.setCurrentStep(a,t[a-1])},this.getFlattenedSteps=()=>{const{steps:e}=this.props,t=[];for(const a of e)if(a.steps)for(const i of a.steps)t.push(i);else t.push(a);return t},this.getFlattenedStepsIndex=(e,t)=>{for(let a=0;a<e.length;a++)if(e[a].name===t)return a+1;return 0},this.initSteps=e=>{for(let t=0;t<e.length;t++){if(e[t].steps)for(let a=0;a<e[t].steps.length;a++)e[t].steps[a]=Object.assign({canJumpTo:!0},e[t].steps[a]);e[t]=Object.assign({canJumpTo:!0},e[t])}return e},this.getElement=e=>typeof e=="function"?e():e||document.body;const d=B.currentId++;if(this.titleId=r.titleId||`pf-wizard-title-${d}`,this.descriptionId=r.descriptionId||`pf-wizard-description-${d}`,this.state={currentStep:this.props.startAtStep&&Number.isInteger(this.props.startAtStep)?this.props.startAtStep:1,isNavOpen:!1},r.onCurrentStepChanged){const e=this.getFlattenedSteps();if(e.length>=this.state.currentStep){const t=e[this.state.currentStep-1];r.onCurrentStepChanged(t)}}this.drawerRef=n.createRef()}setCurrentStep(r,d){this.setState({currentStep:r}),this.props.onCurrentStepChanged&&this.props.onCurrentStepChanged(d)}componentDidMount(){const r=typeof document<"u"?document.body:null;r&&r.addEventListener("keydown",this.handleKeyClicks,!1)}componentWillUnmount(){const r=typeof document<"u"&&document.body||null;r&&r.removeEventListener("keydown",this.handleKeyClicks,!1)}componentDidUpdate(r){r.startAtStep!==this.props.startAtStep&&this.setState({currentStep:this.props.startAtStep})}render(){const r=this.props,{width:d,height:e,title:t,description:a,descriptionComponent:i,onClose:s,onSave:p,onBack:m,onNext:w,onGoToStep:u,className:C,steps:z,startAtStep:b,nextButtonText:y="Next",backButtonText:N="Back",cancelButtonText:g="Cancel",hideClose:h,closeButtonAriaLabel:E="Close",navAriaLabel:D,navAriaLabelledBy:L,mainAriaLabel:le,mainAriaLabelledBy:V,hasNoBodyPadding:de,footer:ce,appendTo:it,isOpen:W,titleId:rt,descriptionId:st,isNavExpandable:pe,onCurrentStepChanged:ot,hasDrawer:me,isDrawerExpanded:ue,onExpandDrawer:fe}=r,ge=Y(r,["width","height","title","description","descriptionComponent","onClose","onSave","onBack","onNext","onGoToStep","className","steps","startAtStep","nextButtonText","backButtonText","cancelButtonText","hideClose","closeButtonAriaLabel","navAriaLabel","navAriaLabelledBy","mainAriaLabel","mainAriaLabelledBy","hasNoBodyPadding","footer","appendTo","isOpen","titleId","descriptionId","isNavExpandable","onCurrentStepChanged","hasDrawer","isDrawerExpanded","onExpandDrawer"]),{currentStep:M}=this.state,T=this.getFlattenedSteps(),he=T.length<M?T.length:M,S=T[he-1],be=this.initSteps(z),we=S===T[0],Se=S&&S.enableNext!==void 0?S.enableNext:!0,ve=O=>{const J={isOpen:O,"aria-label":D,"aria-labelledby":(t||L)&&(L||this.titleId)};return n.createElement(F,Object.assign({},J),be.map((v,K)=>{if(v.isFinishedStep)return;let A,k;if(v.steps){let $=!1,R=!1;for(const x of v.steps)S.name===x.name&&($=!0),x.canJumpTo&&(R=!0);return k=this.getFlattenedStepsIndex(T,v.steps[0].name),n.createElement(_,{key:K,id:v.id,content:v.name,isExpandable:pe,isCurrent:$,isDisabled:!R,step:k,onNavItemClick:this.goToStep},n.createElement(F,Object.assign({},J,{returnList:!0}),v.steps.map((x,Ce)=>{if(!x.isFinishedStep)return k=this.getFlattenedStepsIndex(T,x.name),A=x.canJumpTo&&!x.isDisabled,n.createElement(_,{key:`child_${Ce}`,id:x.id,content:x.name,isCurrent:S.name===x.name,isDisabled:!A,step:k,onNavItemClick:this.goToStep})})))}return k=this.getFlattenedStepsIndex(T,v.name),A=v.canJumpTo&&!v.isDisabled,n.createElement(_,Object.assign({},v.stepNavItemProps,{key:K,id:v.id,content:v.name,isCurrent:S.name===v.name,isDisabled:!A,step:k,onNavItemClick:this.goToStep}))}))},Ne={goToStepById:this.goToStepById,goToStepByName:this.goToStepByName,onNext:this.onNext,onBack:this.onBack,onClose:s,activeStep:S},H=Object.assign(Object.assign({},e?{height:e}:{}),d?{width:d}:{}),G=n.createElement(tt,{value:Ne},n.createElement("div",Object.assign({},ge,{className:c(l.wizard,S&&S.isFinishedStep&&"pf-m-finished",C),style:Object.keys(H).length?H:void 0}),t&&n.createElement(se,{titleId:this.titleId,descriptionId:this.descriptionId,onClose:s,title:t,description:a,descriptionComponent:i,closeButtonAriaLabel:E,hideClose:h}),n.createElement(ie,{hasDrawer:me,isDrawerExpanded:ue,onExpandDrawer:fe,mainAriaLabel:le,isInPage:W===void 0,mainAriaLabelledBy:(t||V)&&(V||this.titleId),isNavOpen:this.state.isNavOpen,onNavToggle:O=>this.setState({isNavOpen:O}),nav:ve,steps:z,activeStep:S,hasNoBodyPadding:de},ce||n.createElement(te,{onNext:this.onNext,onBack:this.onBack,onClose:s,isValid:Se,firstStep:we,activeStep:S,nextButtonText:S&&S.nextButtonText||y,backButtonText:N,cancelButtonText:g}))));return W!==void 0?n.createElement(Ze,{width:d!==null?d:void 0,isOpen:W,variant:et.large,"aria-labelledby":this.titleId,"aria-describedby":this.descriptionId,showClose:!1,hasNoBodyWrapper:!0},G):G}}B.displayName="Wizard";B.currentId=0;B.defaultProps={title:null,description:"",descriptionComponent:"p",className:"",startAtStep:1,nextButtonText:"Next",backButtonText:"Back",cancelButtonText:"Cancel",hideClose:!1,closeButtonAriaLabel:"Close",navAriaLabel:null,navAriaLabelledBy:null,mainAriaLabel:null,mainAriaLabelledBy:null,hasNoBodyPadding:!1,onBack:null,onNext:null,onGoToStep:null,width:null,height:null,footer:null,onClose:()=>{},appendTo:null,isOpen:void 0,isNavExpandable:!1,hasDrawer:!1,isDrawerExpanded:!1,onExpandDrawer:()=>{}};const oe=({children:o})=>n.createElement("footer",{className:c(l.wizardFooter)},o);oe.displayName="WizardFooter";const nt=()=>{const{t:o}=Z(),{control:r,formState:{errors:d}}=ke(),e=Be(),[t,a]=q(!1);return j(ee,{isHorizontal:!0,role:"manage-clients",children:[f(_e,{label:o("clientType"),fieldId:"kc-type",validated:d.protocol?"error":"default",labelIcon:f(Le,{helpText:o("clientTypeHelp"),fieldLabelId:"clientType"}),children:f(Ae,{name:"protocol",defaultValue:"",control:r,render:({field:i})=>f(Fe,{id:"kc-type",onToggle:a,onSelect:(s,p)=>{i.onChange(p.toString()),a(!1)},selections:i.value,variant:De.single,"aria-label":o("selectEncryptionType"),isOpen:t,children:e.map(s=>f(We,{selected:s===i.value,value:s,"data-testid":`option-${s}`,children:Xe(o,s)},s))})})}),f(qe,{hasConfigureAccess:!0})]})};function yt(){const{t:o}=Z(),{realm:r}=Oe(),d=Pe(),[e,t]=q(0),{addAlert:a,addError:i}=je(),s=Ve({defaultValues:{protocol:"openid-connect",clientId:"",name:"",description:"",publicClient:!0,authorizationServicesEnabled:!1,serviceAccountsEnabled:!1,implicitFlowEnabled:!1,directAccessGrantsEnabled:!0,standardFlowEnabled:!0,frontchannelLogout:!0,attributes:{saml_idp_initiated_sso_url_name:""}}}),{getValues:p,watch:m,trigger:w}=s,u=m("protocol"),C=async()=>{const h=Je(p());try{const E=await Ke.clients.create({...h,clientId:h.clientId?.trim()});a(o("createClientSuccess"),$e.success),d(Re({realm:r,clientId:E.id,tab:"settings"}))}catch(E){i("createClientError",E)}},z=async h=>{await w()&&(b()||t(e+1),h?.())},b=()=>u==="openid-connect"?e===2:e===1,y=()=>{t(e-1)},N=h=>{h.id==="generalSettings"?t(0):h.id==="capabilityConfig"?t(1):t(2)},g=o("createClient");return j(U,{children:[f(Ue,{titleKey:"createClient",subKey:"clientsExplain"}),f(Me,{variant:"light",children:f(He,{...s,children:f(B,{onClose:()=>d(Ge({realm:r})),navAriaLabel:`${g} steps`,mainAriaLabel:`${g} content`,steps:[{id:"generalSettings",name:o("generalSettings"),component:f(nt,{})},...u!=="saml"?[{id:"capabilityConfig",name:o("capabilityConfig"),component:f(Qe,{protocol:u}),canJumpTo:e>=1}]:[],{id:"loginSettings",name:o("loginSettings"),component:f(ee,{isHorizontal:!0,role:"manage-clients",children:f(Ye,{protocol:u})}),canJumpTo:e>=1}],footer:f(oe,{children:f(at,{children:({activeStep:h,onNext:E,onBack:D,onClose:L})=>j(U,{children:[f(I,{variant:"primary","data-testid":b()?"save":"next",type:"submit",onClick:()=>{z(E)},children:b()?o("save"):o("next")}),f(I,{variant:"secondary","data-testid":"back",onClick:()=>{y(),D()},isDisabled:h.name===o("generalSettings"),children:o("back")}),f(I,{"data-testid":"cancel",variant:"link",onClick:L,children:o("cancel")})]})})}),onSave:C,onGoToStep:N})})})]})}export{yt as default};
//# sourceMappingURL=NewClientForm-jIVw2QHx.js.map
