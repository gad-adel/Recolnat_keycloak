import{jsxs as p,jsx as a,Fragment as N}from"react/jsx-runtime";import*as P from"react";import{useState as u,Fragment as _}from"react";import{_ as H,bY as Z,l as x,bZ as J,bC as X,b_ as Y,u as K,f as V,B as S,j as T,m as M,X as k,z as A,a4 as q,e as G,d as z,r as Q,A as W,b$ as ee,a8 as ae,P as te,D as E,aZ as re,a1 as se,a2 as F,c0 as ie,I as ne,J as oe,bg as le,L as R,bT as de,bd as ce,c1 as B,K as me}from"./index-sihFV1NS.js";import{u as pe}from"./ConfirmDialog-WMVurgkl.js";import{G as ge,C as ue}from"./ClickableCard-ny_fcQOz.js";import{K as he}from"./KeycloakDataTable-Q3kZYP9q.js";import{V as fe}from"./ViewHeader-xo54NRb6.js";import{b as De,s as I}from"./sortBy-zPScg0cx.js";import{M as be,a as ye}from"./Modal-uOAPm2rX.js";import{e as ve,D as Ce,a as Pe,b as Ie,c as Oe,d as we}from"./DataListItemRow-te2VcAoi.js";import{D as Le}from"./DataListControl-eJK-PZDC.js";import{b as j}from"./ToolbarContent-46I9Yg7h.js";import"react-dom";import"./PaginatingTableToolbar--Dt3wwL6.js";import"./EmptyStateBody-jnnI7hpP.js";import"./EmptyStateSecondaryActions-G5doWCZ5.js";import"./TableToolbar-vuixsfwd.js";import"./Form-bfj-xQZn.js";import"./Td-uwYquKT4.js";import"./grip-vertical-icon-accuSWkz.js";import"./_baseRest-lI6NnEVt.js";import"./data-list-CDN1kyj9.js";const $=e=>{var{children:r=null,className:t="",label:n=""}=e,o=H(e,["children","className","label"]);return P.createElement(Z.Consumer,null,({sectionClass:c,sectionTitleClass:l,sectionComponent:h})=>{const g=h;return P.createElement(g,Object.assign({className:x(c,t)},o),n&&P.createElement("h1",{className:x(l),"aria-hidden":!0},n),P.createElement("ul",{role:"none"},r))})};$.displayName="DropdownGroup";function Ne(e,r,t,n){for(var o=-1,c=e==null?0:e.length;++o<c;){var l=e[o];r(n,l,t(l),e)}return n}function Se(e,r,t,n){return De(e,function(o,c,l){r(n,o,t(o),l)}),n}function Te(e,r){return function(t,n){var o=J(t)?Ne:Se,c=r?r():{};return o(t,e,X(n),c)}}var ke=Object.prototype,Ae=ke.hasOwnProperty,Ke=Te(function(e,r,t){Ae.call(e,t)?e[t].push(r):Y(e,t,[r])});const xe=Ke,Ee=({providers:e,onClose:r})=>{const{t}=K(),{addAlert:n,addError:o}=V(),[c,l]=u(""),[h,g]=u(""),[b,y]=u(e.map(i=>i.alias)),m=i=>{l(i),g(t("onDragStart",{item:i}))},v=()=>{g(t("onDragMove",{item:c}))},D=()=>{g(t("onDragCancel"))},O=i=>{g(t("onDragFinish",{list:i})),y(i)};return p(be,{variant:ye.small,title:t("manageDisplayOrder"),isOpen:!0,onClose:r,actions:[a(S,{id:"modal-confirm","data-testid":"confirm",onClick:async()=>{const i=b.map((f,w)=>{const C=e.find(L=>L.alias===f);return C.config.guiOrder=w,T.identityProviders.update({alias:f},C)});try{await Promise.all(i),n(t("orderChangeSuccess"))}catch(f){o("orderChangeError",f)}r()},children:t("save")},"confirm"),a(S,{id:"modal-cancel","data-testid":"cancel",variant:M.link,onClick:r,children:t("cancel")},"cancel")],children:[a(k,{className:"pf-u-pb-lg",children:a(A,{children:t("orderDialogIntro")})}),a(ve,{"aria-label":t("manageOrderTableAria"),"data-testid":"manageOrderDataList",isCompact:!0,onDragFinish:O,onDragStart:m,onDragMove:v,onDragCancel:D,itemOrder:b,children:I(e,"config.guiOrder","alias").map(i=>a(Ce,{"aria-label":i.alias,id:i.alias,children:p(Pe,{children:[a(Le,{children:a(Ie,{"aria-label":t("dragHelp")})}),a(Oe,{dataListCells:[a(we,{"data-testid":i.alias,children:i.alias},i.alias)]})]})},i.alias))}),a("div",{className:"pf-screen-reader","aria-live":"assertive",children:h})]})},Fe=e=>{const{t:r}=K(),{realm:t}=G();return p(R,{to:de({realm:t,providerId:e.providerId,alias:e.alias,tab:"settings"}),children:[e.displayName||e.alias,!e.enabled&&a(ce,{isRead:!0,className:"pf-u-ml-sm",children:r("disabled")},`${e.providerId}-disabled`)]},e.providerId)};function sa(){const{t:e}=K(),r=xe(q().identityProviders,"groupName"),{realm:t}=G(),n=z(),[o,c]=u(0),l=()=>c(o+1),[h,g]=u(!1),[b,y]=u(!1),[m,v]=u(),[D,O]=u(),{addAlert:i,addError:f}=V();Q(async()=>{const s=await T.realms.findOne({realm:t});if(!s)throw new Error(e("notFound"));return s.identityProviders},s=>{v(I(s,["config.guiOrder","alias"]))},[o]);const w=s=>n(B({realm:t,providerId:s})),C=()=>Object.keys(r).map(s=>a($,{label:s,children:I(r[s],"name").map(d=>a(me,{value:d.id,component:a(R,{to:B({realm:t,providerId:d.id}),"data-testid":d.id,children:d.name})},d.id))},s)),[L,U]=pe({titleKey:"deleteProvider",messageKey:e("deleteConfirm",{provider:D?.alias}),continueButtonLabel:"delete",continueButtonVariant:M.danger,onConfirm:async()=>{try{await T.identityProviders.del({alias:D.alias}),v([...m.filter(s=>s.alias!==D?.alias)]),l(),i(e("deletedSuccessIdentityProvider"),W.success)}catch(s){f("deleteErrorIdentityProvider",s)}}});return m?p(N,{children:[a(U,{}),b&&a(Ee,{onClose:()=>{y(!1),l()},providers:m.filter(s=>s.enabled)}),a(fe,{titleKey:"identityProviders",subKey:"listExplain",helpUrl:ae.identityProvidersUrl}),p(te,{variant:m.length===0?"default":"light",className:m.length===0?"":"pf-u-p-0",children:[m.length===0&&p(N,{children:[a(k,{children:a(A,{component:E.p,children:e("getStarted")})}),Object.keys(r).map(s=>p(_,{children:[a(k,{children:p(A,{className:"pf-u-mt-lg",component:E.h2,children:[s,":"]})}),a("hr",{className:"pf-u-mb-lg"}),a(ge,{hasGutter:!0,children:I(r[s],"name").map(d=>a(ue,{"data-testid":`${d.id}-card`,onClick:()=>w(d.id),children:a(re,{children:p(se,{hasGutter:!0,children:[a(F,{children:a(ie,{icon:d.id})}),a(F,{isFilled:!0,children:d.name})]})})},d.id))})]},s))]}),m.length!==0&&a(he,{loader:m,ariaLabelKey:"identityProviders",searchPlaceholderKey:"searchForProvider",toolbarItem:p(N,{children:[a(j,{children:a(ne,{"data-testid":"addProviderDropdown",toggle:a(oe,{onToggle:()=>g(!h),isPrimary:!0,children:e("addProvider")}),isOpen:h,dropdownItems:C()})}),a(j,{children:a(S,{"data-testid":"manageDisplayOrder",variant:"link",onClick:()=>y(!0),children:e("manageDisplayOrder")})})]}),actions:[{title:e("delete"),onRowClick:s=>{O(s),L()}}],columns:[{name:"alias",displayKey:"name",cellRenderer:Fe},{name:"providerId",displayKey:"providerDetails",cellFormatters:[le()]}]})]})]}):a(ee,{})}export{sa as default};
//# sourceMappingURL=IdentityProvidersSection-admQo6hT.js.map
