import{jsxs as p,jsx as e,Fragment as U}from"react/jsx-runtime";import*as P from"react";import{useState as m,useMemo as W}from"react";import{_ as T,l as G,dH as N,o as ee,x as ae,aY as re,I as te,ai as se,aZ as $,L as oe,y as ne,p as ie,u as j,f as z,B as M,j as v,m as H,X as L,z as O,e as le,d as de,a4 as ce,r as me,K as x,dI as A,aF as S,A as pe,a8 as ge,P as ue,D as B,a1 as he,a2 as K,dJ as fe,dK as Ce,dL as De}from"./index-sihFV1NS.js";import{u as ye}from"./ConfirmDialog-WMVurgkl.js";import{G as V,C as ve}from"./ClickableCard-ny_fcQOz.js";import{F as be}from"./Flex-W2FoLD7u.js";import{F as E}from"./FlexItem-Mxf6oLng.js";import{V as ke}from"./ViewHeader-xo54NRb6.js";import{s as we}from"./sortBy-zPScg0cx.js";import{M as Fe,a as Ie}from"./Modal-uOAPm2rX.js";import{e as Se,D as Ne,a as Le,b as Oe,c as Pe,d as Te}from"./DataListItemRow-te2VcAoi.js";import{D as Ue}from"./DataListControl-eJK-PZDC.js";import"react-dom";import"./ToolbarContent-46I9Yg7h.js";import"./_baseRest-lI6NnEVt.js";import"./data-list-CDN1kyj9.js";import"./grip-vertical-icon-accuSWkz.js";const _=r=>{var{children:n=null,className:t="",hasNoOffset:l=!1}=r,s=T(r,["children","className","hasNoOffset"]);return P.createElement("div",Object.assign({className:G(N.cardActions,l&&N.modifiers.noOffset,t)},s),n)};_.displayName="CardActions";const R=r=>{var{children:n=null,className:t="",component:l="div"}=r,s=T(r,["children","className","component"]);const i=l;return P.createElement(i,Object.assign({className:G(N.cardFooter,t)},s),n)};R.displayName="CardFooter";const J=r=>{var{children:n=null,component:t="div"}=r,l=T(r,["children","component"]);const s=t;return P.createElement(s,Object.assign({},l),n)};J.displayName="GalleryItem";const Me={name:"DatabaseIcon",height:512,width:448,svgPath:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z",yOffset:0,xOffset:0},xe=ee(Me),Ae=({title:r,dropdownItems:n,labelText:t,labelColor:l,footerText:s,to:i})=>{const[g,u]=m(!1),c=()=>{u(!g)};return p(ae,{isSelectable:!0,children:[p(re,{children:[e(_,{children:n&&e(te,{"data-testid":`${r}-dropdown`,isPlain:!0,position:"right",toggle:e(se,{onToggle:c}),isOpen:g,dropdownItems:n})}),e($,{"data-testid":"keycloak-card-title",children:e(oe,{to:i,children:r})})]}),e(ne,{}),e(R,{children:p(be,{children:[e(E,{className:"keycloak--keycloak-card__footer",children:s&&s}),e(E,{children:t&&e(ie,{color:l||"gray",children:t})})]})})]})},Be=({components:r,onClose:n})=>{const{t}=j(),{addAlert:l,addError:s}=z(),[i,g]=m(""),[u,c]=m(""),[h,b]=m(r.map(o=>o.name)),D=o=>{g(o),c(t("onDragStart",{item:o}))},y=()=>{c(t("onDragMove",{item:i}))},k=()=>{c(t("onDragCancel"))},w=o=>{c(t("onDragFinish",{list:o})),b(o)};return p(Fe,{variant:Ie.small,title:t("managePriorityOrder"),isOpen:!0,onClose:n,actions:[e(M,{id:"modal-confirm",onClick:async()=>{const o=h.map((f,F)=>{const C=r.find(I=>I.name===f);return C.config.priority=[F.toString()],v.components.update({id:C.id},C)});try{await Promise.all(o),l(t("orderChangeSuccessUserFed"))}catch(f){s("orderChangeErrorUserFed",f)}n()},children:t("save")},"confirm"),e(M,{id:"modal-cancel",variant:H.link,onClick:n,children:t("cancel")},"cancel")],children:[e(L,{className:"pf-u-pb-lg",children:e(O,{children:t("managePriorityInfo")})}),e(Se,{"aria-label":t("manageOrderTableAria"),"data-testid":"manageOrderDataList",isCompact:!0,onDragFinish:w,onDragStart:D,onDragMove:y,onDragCancel:k,itemOrder:h,children:we(r,"config.priority","name").map(o=>e(Ne,{"aria-label":o.name,id:o.name,children:p(Le,{children:[e(Ue,{children:e(Oe,{"aria-label":t("dragHelp")})}),e(Pe,{dataListCells:[e(Te,{"data-testid":o.name,children:o.name},o.name)]})]})},o.name))}),e("div",{className:"pf-screen-reader","aria-live":"assertive",children:u})]})};function ea(){const[r,n]=m(),{addAlert:t,addError:l}=z(),{t:s}=j(),{realm:i}=le(),[g,u]=m(0),c=()=>u(new Date().getTime()),h=de(),[b,D]=m(!1),y=ce().componentTypes?.["org.keycloak.storage.UserStorageProvider"]||[];me(async()=>{const d={parentId:(await v.realms.findOne({realm:i})).id,type:"org.keycloak.storage.UserStorageProvider"};return v.components.find(d)},a=>{n(a)},[g]);const k=W(()=>y.map(a=>e(x,{onClick:()=>h(A({realm:i,providerId:a.id})),children:a.id.toUpperCase()=="LDAP"?a.id.toUpperCase():S(a.id)},a.id)),[]),w={variant:"link",onClick:()=>D(!0),lowerButtonTitle:s("managePriorities")};let o;const[f,F]=m(""),[C,I]=ye({titleKey:s("userFedDeleteConfirmTitle"),messageKey:s("userFedDeleteConfirm"),continueButtonLabel:"delete",continueButtonVariant:H.danger,onConfirm:async()=>{try{await v.components.del({id:f}),c(),t(s("userFedDeletedSuccess"),pe.success)}catch(a){l("userFedDeleteError",a)}}}),X=a=>{F(a),C()},Y=(a,d)=>{const q=`${a.name}`,Q=`${d.name}`;return q<Q?-1:1},Z=(a,d)=>{switch(a){case"ldap":return De({realm:i,id:d});case"kerberos":return Ce({realm:i,id:d});default:return fe({realm:i,providerId:a,id:d})}};return r&&(o=r.sort(Y).map((a,d)=>e(J,{className:"keycloak-admin--user-federation__gallery-item",children:e(Ae,{to:Z(a.providerId,a.id),dropdownItems:[e(x,{onClick:()=>{X(a.id)},"data-testid":"card-delete",children:s("delete")},`${d}-cardDelete`)],title:a.name,footerText:S(a.providerId),labelText:a.config?.enabled?.[0]!=="false"?`${s("enabled")}`:`${s("disabled")}`,labelColor:a.config?.enabled?.[0]!=="false"?"blue":"gray"})},d))),p(U,{children:[e(I,{}),b&&r&&e(Be,{onClose:()=>D(!1),components:r.filter(a=>a.config?.enabled)}),e(ke,{titleKey:"userFederation",subKey:"userFederationExplain",helpUrl:ge.userFederationUrl,...r&&r.length>0?{lowerDropdownItems:k,lowerDropdownMenuTitle:"addNewProvider",lowerButton:w}:{}}),e(ue,{children:r&&r.length>0?e(V,{hasGutter:!0,children:o}):p(U,{children:[e(L,{children:e(O,{component:B.p,children:s("getStarted")})}),e(L,{children:e(O,{className:"pf-u-mt-lg",component:B.h2,children:s("providers")})}),e("hr",{className:"pf-u-mb-lg"}),e(V,{hasGutter:!0,children:y.map(a=>e(ve,{onClick:()=>h(A({realm:i,providerId:a.id})),"data-testid":`${a.id}-card`,children:e($,{children:p(he,{hasGutter:!0,children:[e(K,{children:e(xe,{size:"lg"})}),e(K,{isFilled:!0,children:s("addProvider",{provider:S(a.id),count:4})})]})})},a.id))})]})})]})}export{ea as default};
//# sourceMappingURL=UserFederationSection-_dLiItmp.js.map
